"use strict";var r0=Object.defineProperty;var i0=(c,i,r)=>i in c?r0(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r;var y=(c,i,r)=>(i0(c,typeof i!="symbol"?i+"":i,r),r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var Ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function su(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Dr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Dr.exports;(function(c,i){(function(){var r,o="4.17.21",f=200,p="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",g="Expected a function",_="Invalid `variable` option passed into `_.template`",M="__lodash_hash_undefined__",C=500,b="__lodash_placeholder__",m=1,F=2,O=4,R=1,T=2,N=1,K=2,X=4,Q=8,et=16,St=32,At=64,It=128,Gt=256,jt=512,Ht=30,me="...",ze=800,Br=16,we=1,Ge=2,Ur=3,bn=1/0,vn=9007199254740991,He=17976931348623157e292,Sn=NaN,k=4294967295,z=k-1,G=k>>>1,ct=[["ary",It],["bind",N],["bindKey",K],["curry",Q],["curryRight",et],["flip",jt],["partial",St],["partialRight",At],["rearg",Gt]],nt="[object Arguments]",ht="[object Array]",ot="[object AsyncFunction]",lt="[object Boolean]",yt="[object Date]",qt="[object DOMException]",Rt="[object Error]",Nt="[object Function]",mn="[object GeneratorFunction]",_t="[object Map]",kt="[object Number]",Dn="[object Null]",Mt="[object Object]",Wt="[object Promise]",cn="[object Proxy]",tn="[object RegExp]",pt="[object Set]",wn="[object String]",qe="[object Symbol]",Mu="[object Undefined]",ye="[object WeakMap]",Cu="[object WeakSet]",Me="[object ArrayBuffer]",re="[object DataView]",$r="[object Float32Array]",zr="[object Float64Array]",Gr="[object Int8Array]",Hr="[object Int16Array]",qr="[object Int32Array]",Kr="[object Uint8Array]",Zr="[object Uint8ClampedArray]",Jr="[object Uint16Array]",Yr="[object Uint32Array]",bu=/\b__p \+= '';/g,Su=/\b(__p \+=) '' \+/g,xu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cs=/&(?:amp|lt|gt|quot|#39);/g,bs=/[&<>"']/g,Au=RegExp(Cs.source),Iu=RegExp(bs.source),Pu=/<%-([\s\S]+?)%>/g,Tu=/<%([\s\S]+?)%>/g,Ss=/<%=([\s\S]+?)%>/g,Fu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Eu=/^\w*$/,Ru=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xr=/[\\^$.*+?()[\]{}|]/g,ku=RegExp(Xr.source),Qr=/^\s+/,Lu=/\s/,Ou=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Du=/\{\n\/\* \[wrapped with (.+)\] \*/,Nu=/,? & /,Wu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Bu=/[()=,{}\[\]\/\s]/,Uu=/\\(\\)?/g,$u=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xs=/\w*$/,zu=/^[-+]0x[0-9a-f]+$/i,Gu=/^0b[01]+$/i,Hu=/^\[object .+?Constructor\]$/,qu=/^0o[0-7]+$/i,Ku=/^(?:0|[1-9]\d*)$/,Zu=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ke=/($^)/,Ju=/['\n\r\u2028\u2029\\]/g,Ze="\\ud800-\\udfff",Yu="\\u0300-\\u036f",Xu="\\ufe20-\\ufe2f",Qu="\\u20d0-\\u20ff",As=Yu+Xu+Qu,Is="\\u2700-\\u27bf",Ps="a-z\\xdf-\\xf6\\xf8-\\xff",Vu="\\xac\\xb1\\xd7\\xf7",ju="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",tl="\\u2000-\\u206f",nl=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ts="A-Z\\xc0-\\xd6\\xd8-\\xde",Fs="\\ufe0e\\ufe0f",Es=Vu+ju+tl+nl,Vr="['’]",el="["+Ze+"]",Rs="["+Es+"]",Je="["+As+"]",ks="\\d+",rl="["+Is+"]",Ls="["+Ps+"]",Os="[^"+Ze+Es+ks+Is+Ps+Ts+"]",jr="\\ud83c[\\udffb-\\udfff]",il="(?:"+Je+"|"+jr+")",Ds="[^"+Ze+"]",ti="(?:\\ud83c[\\udde6-\\uddff]){2}",ni="[\\ud800-\\udbff][\\udc00-\\udfff]",ie="["+Ts+"]",Ns="\\u200d",Ws="(?:"+Ls+"|"+Os+")",sl="(?:"+ie+"|"+Os+")",Bs="(?:"+Vr+"(?:d|ll|m|re|s|t|ve))?",Us="(?:"+Vr+"(?:D|LL|M|RE|S|T|VE))?",$s=il+"?",zs="["+Fs+"]?",al="(?:"+Ns+"(?:"+[Ds,ti,ni].join("|")+")"+zs+$s+")*",ol="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ul="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Gs=zs+$s+al,ll="(?:"+[rl,ti,ni].join("|")+")"+Gs,fl="(?:"+[Ds+Je+"?",Je,ti,ni,el].join("|")+")",cl=RegExp(Vr,"g"),hl=RegExp(Je,"g"),ei=RegExp(jr+"(?="+jr+")|"+fl+Gs,"g"),pl=RegExp([ie+"?"+Ls+"+"+Bs+"(?="+[Rs,ie,"$"].join("|")+")",sl+"+"+Us+"(?="+[Rs,ie+Ws,"$"].join("|")+")",ie+"?"+Ws+"+"+Bs,ie+"+"+Us,ul,ol,ks,ll].join("|"),"g"),gl=RegExp("["+Ns+Ze+As+Fs+"]"),dl=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_l=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],vl=-1,ft={};ft[$r]=ft[zr]=ft[Gr]=ft[Hr]=ft[qr]=ft[Kr]=ft[Zr]=ft[Jr]=ft[Yr]=!0,ft[nt]=ft[ht]=ft[Me]=ft[lt]=ft[re]=ft[yt]=ft[Rt]=ft[Nt]=ft[_t]=ft[kt]=ft[Mt]=ft[tn]=ft[pt]=ft[wn]=ft[ye]=!1;var ut={};ut[nt]=ut[ht]=ut[Me]=ut[re]=ut[lt]=ut[yt]=ut[$r]=ut[zr]=ut[Gr]=ut[Hr]=ut[qr]=ut[_t]=ut[kt]=ut[Mt]=ut[tn]=ut[pt]=ut[wn]=ut[qe]=ut[Kr]=ut[Zr]=ut[Jr]=ut[Yr]=!0,ut[Rt]=ut[Nt]=ut[ye]=!1;var ml={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},wl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},yl={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ml={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Cl=parseFloat,bl=parseInt,Hs=typeof Ne=="object"&&Ne&&Ne.Object===Object&&Ne,Sl=typeof self=="object"&&self&&self.Object===Object&&self,Pt=Hs||Sl||Function("return this")(),ri=i&&!i.nodeType&&i,Zn=ri&&!0&&c&&!c.nodeType&&c,qs=Zn&&Zn.exports===ri,ii=qs&&Hs.process,nn=function(){try{var v=Zn&&Zn.require&&Zn.require("util").types;return v||ii&&ii.binding&&ii.binding("util")}catch{}}(),Ks=nn&&nn.isArrayBuffer,Zs=nn&&nn.isDate,Js=nn&&nn.isMap,Ys=nn&&nn.isRegExp,Xs=nn&&nn.isSet,Qs=nn&&nn.isTypedArray;function Kt(v,x,S){switch(S.length){case 0:return v.call(x);case 1:return v.call(x,S[0]);case 2:return v.call(x,S[0],S[1]);case 3:return v.call(x,S[0],S[1],S[2])}return v.apply(x,S)}function xl(v,x,S,L){for(var H=-1,rt=v==null?0:v.length;++H<rt;){var Ct=v[H];x(L,Ct,S(Ct),v)}return L}function en(v,x){for(var S=-1,L=v==null?0:v.length;++S<L&&x(v[S],S,v)!==!1;);return v}function Al(v,x){for(var S=v==null?0:v.length;S--&&x(v[S],S,v)!==!1;);return v}function Vs(v,x){for(var S=-1,L=v==null?0:v.length;++S<L;)if(!x(v[S],S,v))return!1;return!0}function Nn(v,x){for(var S=-1,L=v==null?0:v.length,H=0,rt=[];++S<L;){var Ct=v[S];x(Ct,S,v)&&(rt[H++]=Ct)}return rt}function Ye(v,x){var S=v==null?0:v.length;return!!S&&se(v,x,0)>-1}function si(v,x,S){for(var L=-1,H=v==null?0:v.length;++L<H;)if(S(x,v[L]))return!0;return!1}function gt(v,x){for(var S=-1,L=v==null?0:v.length,H=Array(L);++S<L;)H[S]=x(v[S],S,v);return H}function Wn(v,x){for(var S=-1,L=x.length,H=v.length;++S<L;)v[H+S]=x[S];return v}function ai(v,x,S,L){var H=-1,rt=v==null?0:v.length;for(L&&rt&&(S=v[++H]);++H<rt;)S=x(S,v[H],H,v);return S}function Il(v,x,S,L){var H=v==null?0:v.length;for(L&&H&&(S=v[--H]);H--;)S=x(S,v[H],H,v);return S}function oi(v,x){for(var S=-1,L=v==null?0:v.length;++S<L;)if(x(v[S],S,v))return!0;return!1}var Pl=ui("length");function Tl(v){return v.split("")}function Fl(v){return v.match(Wu)||[]}function js(v,x,S){var L;return S(v,function(H,rt,Ct){if(x(H,rt,Ct))return L=rt,!1}),L}function Xe(v,x,S,L){for(var H=v.length,rt=S+(L?1:-1);L?rt--:++rt<H;)if(x(v[rt],rt,v))return rt;return-1}function se(v,x,S){return x===x?zl(v,x,S):Xe(v,ta,S)}function El(v,x,S,L){for(var H=S-1,rt=v.length;++H<rt;)if(L(v[H],x))return H;return-1}function ta(v){return v!==v}function na(v,x){var S=v==null?0:v.length;return S?fi(v,x)/S:Sn}function ui(v){return function(x){return x==null?r:x[v]}}function li(v){return function(x){return v==null?r:v[x]}}function ea(v,x,S,L,H){return H(v,function(rt,Ct,at){S=L?(L=!1,rt):x(S,rt,Ct,at)}),S}function Rl(v,x){var S=v.length;for(v.sort(x);S--;)v[S]=v[S].value;return v}function fi(v,x){for(var S,L=-1,H=v.length;++L<H;){var rt=x(v[L]);rt!==r&&(S=S===r?rt:S+rt)}return S}function ci(v,x){for(var S=-1,L=Array(v);++S<v;)L[S]=x(S);return L}function kl(v,x){return gt(x,function(S){return[S,v[S]]})}function ra(v){return v&&v.slice(0,oa(v)+1).replace(Qr,"")}function Zt(v){return function(x){return v(x)}}function hi(v,x){return gt(x,function(S){return v[S]})}function Ce(v,x){return v.has(x)}function ia(v,x){for(var S=-1,L=v.length;++S<L&&se(x,v[S],0)>-1;);return S}function sa(v,x){for(var S=v.length;S--&&se(x,v[S],0)>-1;);return S}function Ll(v,x){for(var S=v.length,L=0;S--;)v[S]===x&&++L;return L}var Ol=li(ml),Dl=li(wl);function Nl(v){return"\\"+Ml[v]}function Wl(v,x){return v==null?r:v[x]}function ae(v){return gl.test(v)}function Bl(v){return dl.test(v)}function Ul(v){for(var x,S=[];!(x=v.next()).done;)S.push(x.value);return S}function pi(v){var x=-1,S=Array(v.size);return v.forEach(function(L,H){S[++x]=[H,L]}),S}function aa(v,x){return function(S){return v(x(S))}}function Bn(v,x){for(var S=-1,L=v.length,H=0,rt=[];++S<L;){var Ct=v[S];(Ct===x||Ct===b)&&(v[S]=b,rt[H++]=S)}return rt}function Qe(v){var x=-1,S=Array(v.size);return v.forEach(function(L){S[++x]=L}),S}function $l(v){var x=-1,S=Array(v.size);return v.forEach(function(L){S[++x]=[L,L]}),S}function zl(v,x,S){for(var L=S-1,H=v.length;++L<H;)if(v[L]===x)return L;return-1}function Gl(v,x,S){for(var L=S+1;L--;)if(v[L]===x)return L;return L}function oe(v){return ae(v)?ql(v):Pl(v)}function hn(v){return ae(v)?Kl(v):Tl(v)}function oa(v){for(var x=v.length;x--&&Lu.test(v.charAt(x)););return x}var Hl=li(yl);function ql(v){for(var x=ei.lastIndex=0;ei.test(v);)++x;return x}function Kl(v){return v.match(ei)||[]}function Zl(v){return v.match(pl)||[]}var Jl=function v(x){x=x==null?Pt:ue.defaults(Pt.Object(),x,ue.pick(Pt,_l));var S=x.Array,L=x.Date,H=x.Error,rt=x.Function,Ct=x.Math,at=x.Object,gi=x.RegExp,Yl=x.String,rn=x.TypeError,Ve=S.prototype,Xl=rt.prototype,le=at.prototype,je=x["__core-js_shared__"],tr=Xl.toString,st=le.hasOwnProperty,Ql=0,ua=function(){var t=/[^.]+$/.exec(je&&je.keys&&je.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),nr=le.toString,Vl=tr.call(at),jl=Pt._,tf=gi("^"+tr.call(st).replace(Xr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),er=qs?x.Buffer:r,Un=x.Symbol,rr=x.Uint8Array,la=er?er.allocUnsafe:r,ir=aa(at.getPrototypeOf,at),fa=at.create,ca=le.propertyIsEnumerable,sr=Ve.splice,ha=Un?Un.isConcatSpreadable:r,be=Un?Un.iterator:r,Jn=Un?Un.toStringTag:r,ar=function(){try{var t=jn(at,"defineProperty");return t({},"",{}),t}catch{}}(),nf=x.clearTimeout!==Pt.clearTimeout&&x.clearTimeout,ef=L&&L.now!==Pt.Date.now&&L.now,rf=x.setTimeout!==Pt.setTimeout&&x.setTimeout,or=Ct.ceil,ur=Ct.floor,di=at.getOwnPropertySymbols,sf=er?er.isBuffer:r,pa=x.isFinite,af=Ve.join,of=aa(at.keys,at),bt=Ct.max,Ft=Ct.min,uf=L.now,lf=x.parseInt,ga=Ct.random,ff=Ve.reverse,_i=jn(x,"DataView"),Se=jn(x,"Map"),vi=jn(x,"Promise"),fe=jn(x,"Set"),xe=jn(x,"WeakMap"),Ae=jn(at,"create"),lr=xe&&new xe,ce={},cf=te(_i),hf=te(Se),pf=te(vi),gf=te(fe),df=te(xe),fr=Un?Un.prototype:r,Ie=fr?fr.valueOf:r,da=fr?fr.toString:r;function u(t){if(vt(t)&&!q(t)&&!(t instanceof j)){if(t instanceof sn)return t;if(st.call(t,"__wrapped__"))return vo(t)}return new sn(t)}var he=function(){function t(){}return function(n){if(!dt(n))return{};if(fa)return fa(n);t.prototype=n;var e=new t;return t.prototype=r,e}}();function cr(){}function sn(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}u.templateSettings={escape:Pu,evaluate:Tu,interpolate:Ss,variable:"",imports:{_:u}},u.prototype=cr.prototype,u.prototype.constructor=u,sn.prototype=he(cr.prototype),sn.prototype.constructor=sn;function j(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=k,this.__views__=[]}function _f(){var t=new j(this.__wrapped__);return t.__actions__=Bt(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Bt(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Bt(this.__views__),t}function vf(){if(this.__filtered__){var t=new j(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function mf(){var t=this.__wrapped__.value(),n=this.__dir__,e=q(t),s=n<0,a=e?t.length:0,l=Fc(0,a,this.__views__),h=l.start,d=l.end,w=d-h,A=s?d:h-1,I=this.__iteratees__,P=I.length,E=0,D=Ft(w,this.__takeCount__);if(!e||!s&&a==w&&D==w)return Ba(t,this.__actions__);var U=[];t:for(;w--&&E<D;){A+=n;for(var J=-1,$=t[A];++J<P;){var V=I[J],tt=V.iteratee,Xt=V.type,Dt=tt($);if(Xt==Ge)$=Dt;else if(!Dt){if(Xt==we)continue t;break t}}U[E++]=$}return U}j.prototype=he(cr.prototype),j.prototype.constructor=j;function Yn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var s=t[n];this.set(s[0],s[1])}}function wf(){this.__data__=Ae?Ae(null):{},this.size=0}function yf(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function Mf(t){var n=this.__data__;if(Ae){var e=n[t];return e===M?r:e}return st.call(n,t)?n[t]:r}function Cf(t){var n=this.__data__;return Ae?n[t]!==r:st.call(n,t)}function bf(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=Ae&&n===r?M:n,this}Yn.prototype.clear=wf,Yn.prototype.delete=yf,Yn.prototype.get=Mf,Yn.prototype.has=Cf,Yn.prototype.set=bf;function xn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var s=t[n];this.set(s[0],s[1])}}function Sf(){this.__data__=[],this.size=0}function xf(t){var n=this.__data__,e=hr(n,t);if(e<0)return!1;var s=n.length-1;return e==s?n.pop():sr.call(n,e,1),--this.size,!0}function Af(t){var n=this.__data__,e=hr(n,t);return e<0?r:n[e][1]}function If(t){return hr(this.__data__,t)>-1}function Pf(t,n){var e=this.__data__,s=hr(e,t);return s<0?(++this.size,e.push([t,n])):e[s][1]=n,this}xn.prototype.clear=Sf,xn.prototype.delete=xf,xn.prototype.get=Af,xn.prototype.has=If,xn.prototype.set=Pf;function An(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var s=t[n];this.set(s[0],s[1])}}function Tf(){this.size=0,this.__data__={hash:new Yn,map:new(Se||xn),string:new Yn}}function Ff(t){var n=Sr(this,t).delete(t);return this.size-=n?1:0,n}function Ef(t){return Sr(this,t).get(t)}function Rf(t){return Sr(this,t).has(t)}function kf(t,n){var e=Sr(this,t),s=e.size;return e.set(t,n),this.size+=e.size==s?0:1,this}An.prototype.clear=Tf,An.prototype.delete=Ff,An.prototype.get=Ef,An.prototype.has=Rf,An.prototype.set=kf;function Xn(t){var n=-1,e=t==null?0:t.length;for(this.__data__=new An;++n<e;)this.add(t[n])}function Lf(t){return this.__data__.set(t,M),this}function Of(t){return this.__data__.has(t)}Xn.prototype.add=Xn.prototype.push=Lf,Xn.prototype.has=Of;function pn(t){var n=this.__data__=new xn(t);this.size=n.size}function Df(){this.__data__=new xn,this.size=0}function Nf(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e}function Wf(t){return this.__data__.get(t)}function Bf(t){return this.__data__.has(t)}function Uf(t,n){var e=this.__data__;if(e instanceof xn){var s=e.__data__;if(!Se||s.length<f-1)return s.push([t,n]),this.size=++e.size,this;e=this.__data__=new An(s)}return e.set(t,n),this.size=e.size,this}pn.prototype.clear=Df,pn.prototype.delete=Nf,pn.prototype.get=Wf,pn.prototype.has=Bf,pn.prototype.set=Uf;function _a(t,n){var e=q(t),s=!e&&ne(t),a=!e&&!s&&qn(t),l=!e&&!s&&!a&&_e(t),h=e||s||a||l,d=h?ci(t.length,Yl):[],w=d.length;for(var A in t)(n||st.call(t,A))&&!(h&&(A=="length"||a&&(A=="offset"||A=="parent")||l&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||Fn(A,w)))&&d.push(A);return d}function va(t){var n=t.length;return n?t[Pi(0,n-1)]:r}function $f(t,n){return xr(Bt(t),Qn(n,0,t.length))}function zf(t){return xr(Bt(t))}function mi(t,n,e){(e!==r&&!gn(t[n],e)||e===r&&!(n in t))&&In(t,n,e)}function Pe(t,n,e){var s=t[n];(!(st.call(t,n)&&gn(s,e))||e===r&&!(n in t))&&In(t,n,e)}function hr(t,n){for(var e=t.length;e--;)if(gn(t[e][0],n))return e;return-1}function Gf(t,n,e,s){return $n(t,function(a,l,h){n(s,a,e(a),h)}),s}function ma(t,n){return t&&Mn(n,xt(n),t)}function Hf(t,n){return t&&Mn(n,$t(n),t)}function In(t,n,e){n=="__proto__"&&ar?ar(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e}function wi(t,n){for(var e=-1,s=n.length,a=S(s),l=t==null;++e<s;)a[e]=l?r:ji(t,n[e]);return a}function Qn(t,n,e){return t===t&&(e!==r&&(t=t<=e?t:e),n!==r&&(t=t>=n?t:n)),t}function an(t,n,e,s,a,l){var h,d=n&m,w=n&F,A=n&O;if(e&&(h=a?e(t,s,a,l):e(t)),h!==r)return h;if(!dt(t))return t;var I=q(t);if(I){if(h=Rc(t),!d)return Bt(t,h)}else{var P=Et(t),E=P==Nt||P==mn;if(qn(t))return za(t,d);if(P==Mt||P==nt||E&&!a){if(h=w||E?{}:oo(t),!d)return w?Mc(t,Hf(h,t)):yc(t,ma(h,t))}else{if(!ut[P])return a?t:{};h=kc(t,P,d)}}l||(l=new pn);var D=l.get(t);if(D)return D;l.set(t,h),No(t)?t.forEach(function($){h.add(an($,n,e,$,t,l))}):Oo(t)&&t.forEach(function($,V){h.set(V,an($,n,e,V,t,l))});var U=A?w?Bi:Wi:w?$t:xt,J=I?r:U(t);return en(J||t,function($,V){J&&(V=$,$=t[V]),Pe(h,V,an($,n,e,V,t,l))}),h}function qf(t){var n=xt(t);return function(e){return wa(e,t,n)}}function wa(t,n,e){var s=e.length;if(t==null)return!s;for(t=at(t);s--;){var a=e[s],l=n[a],h=t[a];if(h===r&&!(a in t)||!l(h))return!1}return!0}function ya(t,n,e){if(typeof t!="function")throw new rn(g);return Oe(function(){t.apply(r,e)},n)}function Te(t,n,e,s){var a=-1,l=Ye,h=!0,d=t.length,w=[],A=n.length;if(!d)return w;e&&(n=gt(n,Zt(e))),s?(l=si,h=!1):n.length>=f&&(l=Ce,h=!1,n=new Xn(n));t:for(;++a<d;){var I=t[a],P=e==null?I:e(I);if(I=s||I!==0?I:0,h&&P===P){for(var E=A;E--;)if(n[E]===P)continue t;w.push(I)}else l(n,P,s)||w.push(I)}return w}var $n=Za(yn),Ma=Za(Mi,!0);function Kf(t,n){var e=!0;return $n(t,function(s,a,l){return e=!!n(s,a,l),e}),e}function pr(t,n,e){for(var s=-1,a=t.length;++s<a;){var l=t[s],h=n(l);if(h!=null&&(d===r?h===h&&!Yt(h):e(h,d)))var d=h,w=l}return w}function Zf(t,n,e,s){var a=t.length;for(e=Z(e),e<0&&(e=-e>a?0:a+e),s=s===r||s>a?a:Z(s),s<0&&(s+=a),s=e>s?0:Bo(s);e<s;)t[e++]=n;return t}function Ca(t,n){var e=[];return $n(t,function(s,a,l){n(s,a,l)&&e.push(s)}),e}function Tt(t,n,e,s,a){var l=-1,h=t.length;for(e||(e=Oc),a||(a=[]);++l<h;){var d=t[l];n>0&&e(d)?n>1?Tt(d,n-1,e,s,a):Wn(a,d):s||(a[a.length]=d)}return a}var yi=Ja(),ba=Ja(!0);function yn(t,n){return t&&yi(t,n,xt)}function Mi(t,n){return t&&ba(t,n,xt)}function gr(t,n){return Nn(n,function(e){return En(t[e])})}function Vn(t,n){n=Gn(n,t);for(var e=0,s=n.length;t!=null&&e<s;)t=t[Cn(n[e++])];return e&&e==s?t:r}function Sa(t,n,e){var s=n(t);return q(t)?s:Wn(s,e(t))}function Lt(t){return t==null?t===r?Mu:Dn:Jn&&Jn in at(t)?Tc(t):zc(t)}function Ci(t,n){return t>n}function Jf(t,n){return t!=null&&st.call(t,n)}function Yf(t,n){return t!=null&&n in at(t)}function Xf(t,n,e){return t>=Ft(n,e)&&t<bt(n,e)}function bi(t,n,e){for(var s=e?si:Ye,a=t[0].length,l=t.length,h=l,d=S(l),w=1/0,A=[];h--;){var I=t[h];h&&n&&(I=gt(I,Zt(n))),w=Ft(I.length,w),d[h]=!e&&(n||a>=120&&I.length>=120)?new Xn(h&&I):r}I=t[0];var P=-1,E=d[0];t:for(;++P<a&&A.length<w;){var D=I[P],U=n?n(D):D;if(D=e||D!==0?D:0,!(E?Ce(E,U):s(A,U,e))){for(h=l;--h;){var J=d[h];if(!(J?Ce(J,U):s(t[h],U,e)))continue t}E&&E.push(U),A.push(D)}}return A}function Qf(t,n,e,s){return yn(t,function(a,l,h){n(s,e(a),l,h)}),s}function Fe(t,n,e){n=Gn(n,t),t=co(t,n);var s=t==null?t:t[Cn(un(n))];return s==null?r:Kt(s,t,e)}function xa(t){return vt(t)&&Lt(t)==nt}function Vf(t){return vt(t)&&Lt(t)==Me}function jf(t){return vt(t)&&Lt(t)==yt}function Ee(t,n,e,s,a){return t===n?!0:t==null||n==null||!vt(t)&&!vt(n)?t!==t&&n!==n:tc(t,n,e,s,Ee,a)}function tc(t,n,e,s,a,l){var h=q(t),d=q(n),w=h?ht:Et(t),A=d?ht:Et(n);w=w==nt?Mt:w,A=A==nt?Mt:A;var I=w==Mt,P=A==Mt,E=w==A;if(E&&qn(t)){if(!qn(n))return!1;h=!0,I=!1}if(E&&!I)return l||(l=new pn),h||_e(t)?io(t,n,e,s,a,l):Ic(t,n,w,e,s,a,l);if(!(e&R)){var D=I&&st.call(t,"__wrapped__"),U=P&&st.call(n,"__wrapped__");if(D||U){var J=D?t.value():t,$=U?n.value():n;return l||(l=new pn),a(J,$,e,s,l)}}return E?(l||(l=new pn),Pc(t,n,e,s,a,l)):!1}function nc(t){return vt(t)&&Et(t)==_t}function Si(t,n,e,s){var a=e.length,l=a,h=!s;if(t==null)return!l;for(t=at(t);a--;){var d=e[a];if(h&&d[2]?d[1]!==t[d[0]]:!(d[0]in t))return!1}for(;++a<l;){d=e[a];var w=d[0],A=t[w],I=d[1];if(h&&d[2]){if(A===r&&!(w in t))return!1}else{var P=new pn;if(s)var E=s(A,I,w,t,n,P);if(!(E===r?Ee(I,A,R|T,s,P):E))return!1}}return!0}function Aa(t){if(!dt(t)||Nc(t))return!1;var n=En(t)?tf:Hu;return n.test(te(t))}function ec(t){return vt(t)&&Lt(t)==tn}function rc(t){return vt(t)&&Et(t)==pt}function ic(t){return vt(t)&&Er(t.length)&&!!ft[Lt(t)]}function Ia(t){return typeof t=="function"?t:t==null?zt:typeof t=="object"?q(t)?Fa(t[0],t[1]):Ta(t):Xo(t)}function xi(t){if(!Le(t))return of(t);var n=[];for(var e in at(t))st.call(t,e)&&e!="constructor"&&n.push(e);return n}function sc(t){if(!dt(t))return $c(t);var n=Le(t),e=[];for(var s in t)s=="constructor"&&(n||!st.call(t,s))||e.push(s);return e}function Ai(t,n){return t<n}function Pa(t,n){var e=-1,s=Ut(t)?S(t.length):[];return $n(t,function(a,l,h){s[++e]=n(a,l,h)}),s}function Ta(t){var n=$i(t);return n.length==1&&n[0][2]?lo(n[0][0],n[0][1]):function(e){return e===t||Si(e,t,n)}}function Fa(t,n){return Gi(t)&&uo(n)?lo(Cn(t),n):function(e){var s=ji(e,t);return s===r&&s===n?ts(e,t):Ee(n,s,R|T)}}function dr(t,n,e,s,a){t!==n&&yi(n,function(l,h){if(a||(a=new pn),dt(l))ac(t,n,h,e,dr,s,a);else{var d=s?s(qi(t,h),l,h+"",t,n,a):r;d===r&&(d=l),mi(t,h,d)}},$t)}function ac(t,n,e,s,a,l,h){var d=qi(t,e),w=qi(n,e),A=h.get(w);if(A){mi(t,e,A);return}var I=l?l(d,w,e+"",t,n,h):r,P=I===r;if(P){var E=q(w),D=!E&&qn(w),U=!E&&!D&&_e(w);I=w,E||D||U?q(d)?I=d:mt(d)?I=Bt(d):D?(P=!1,I=za(w,!0)):U?(P=!1,I=Ga(w,!0)):I=[]:De(w)||ne(w)?(I=d,ne(d)?I=Uo(d):(!dt(d)||En(d))&&(I=oo(w))):P=!1}P&&(h.set(w,I),a(I,w,s,l,h),h.delete(w)),mi(t,e,I)}function Ea(t,n){var e=t.length;if(e)return n+=n<0?e:0,Fn(n,e)?t[n]:r}function Ra(t,n,e){n.length?n=gt(n,function(l){return q(l)?function(h){return Vn(h,l.length===1?l[0]:l)}:l}):n=[zt];var s=-1;n=gt(n,Zt(B()));var a=Pa(t,function(l,h,d){var w=gt(n,function(A){return A(l)});return{criteria:w,index:++s,value:l}});return Rl(a,function(l,h){return wc(l,h,e)})}function oc(t,n){return ka(t,n,function(e,s){return ts(t,s)})}function ka(t,n,e){for(var s=-1,a=n.length,l={};++s<a;){var h=n[s],d=Vn(t,h);e(d,h)&&Re(l,Gn(h,t),d)}return l}function uc(t){return function(n){return Vn(n,t)}}function Ii(t,n,e,s){var a=s?El:se,l=-1,h=n.length,d=t;for(t===n&&(n=Bt(n)),e&&(d=gt(t,Zt(e)));++l<h;)for(var w=0,A=n[l],I=e?e(A):A;(w=a(d,I,w,s))>-1;)d!==t&&sr.call(d,w,1),sr.call(t,w,1);return t}function La(t,n){for(var e=t?n.length:0,s=e-1;e--;){var a=n[e];if(e==s||a!==l){var l=a;Fn(a)?sr.call(t,a,1):Ei(t,a)}}return t}function Pi(t,n){return t+ur(ga()*(n-t+1))}function lc(t,n,e,s){for(var a=-1,l=bt(or((n-t)/(e||1)),0),h=S(l);l--;)h[s?l:++a]=t,t+=e;return h}function Ti(t,n){var e="";if(!t||n<1||n>vn)return e;do n%2&&(e+=t),n=ur(n/2),n&&(t+=t);while(n);return e}function Y(t,n){return Ki(fo(t,n,zt),t+"")}function fc(t){return va(ve(t))}function cc(t,n){var e=ve(t);return xr(e,Qn(n,0,e.length))}function Re(t,n,e,s){if(!dt(t))return t;n=Gn(n,t);for(var a=-1,l=n.length,h=l-1,d=t;d!=null&&++a<l;){var w=Cn(n[a]),A=e;if(w==="__proto__"||w==="constructor"||w==="prototype")return t;if(a!=h){var I=d[w];A=s?s(I,w,d):r,A===r&&(A=dt(I)?I:Fn(n[a+1])?[]:{})}Pe(d,w,A),d=d[w]}return t}var Oa=lr?function(t,n){return lr.set(t,n),t}:zt,hc=ar?function(t,n){return ar(t,"toString",{configurable:!0,enumerable:!1,value:es(n),writable:!0})}:zt;function pc(t){return xr(ve(t))}function on(t,n,e){var s=-1,a=t.length;n<0&&(n=-n>a?0:a+n),e=e>a?a:e,e<0&&(e+=a),a=n>e?0:e-n>>>0,n>>>=0;for(var l=S(a);++s<a;)l[s]=t[s+n];return l}function gc(t,n){var e;return $n(t,function(s,a,l){return e=n(s,a,l),!e}),!!e}function _r(t,n,e){var s=0,a=t==null?s:t.length;if(typeof n=="number"&&n===n&&a<=G){for(;s<a;){var l=s+a>>>1,h=t[l];h!==null&&!Yt(h)&&(e?h<=n:h<n)?s=l+1:a=l}return a}return Fi(t,n,zt,e)}function Fi(t,n,e,s){var a=0,l=t==null?0:t.length;if(l===0)return 0;n=e(n);for(var h=n!==n,d=n===null,w=Yt(n),A=n===r;a<l;){var I=ur((a+l)/2),P=e(t[I]),E=P!==r,D=P===null,U=P===P,J=Yt(P);if(h)var $=s||U;else A?$=U&&(s||E):d?$=U&&E&&(s||!D):w?$=U&&E&&!D&&(s||!J):D||J?$=!1:$=s?P<=n:P<n;$?a=I+1:l=I}return Ft(l,z)}function Da(t,n){for(var e=-1,s=t.length,a=0,l=[];++e<s;){var h=t[e],d=n?n(h):h;if(!e||!gn(d,w)){var w=d;l[a++]=h===0?0:h}}return l}function Na(t){return typeof t=="number"?t:Yt(t)?Sn:+t}function Jt(t){if(typeof t=="string")return t;if(q(t))return gt(t,Jt)+"";if(Yt(t))return da?da.call(t):"";var n=t+"";return n=="0"&&1/t==-bn?"-0":n}function zn(t,n,e){var s=-1,a=Ye,l=t.length,h=!0,d=[],w=d;if(e)h=!1,a=si;else if(l>=f){var A=n?null:xc(t);if(A)return Qe(A);h=!1,a=Ce,w=new Xn}else w=n?[]:d;t:for(;++s<l;){var I=t[s],P=n?n(I):I;if(I=e||I!==0?I:0,h&&P===P){for(var E=w.length;E--;)if(w[E]===P)continue t;n&&w.push(P),d.push(I)}else a(w,P,e)||(w!==d&&w.push(P),d.push(I))}return d}function Ei(t,n){return n=Gn(n,t),t=co(t,n),t==null||delete t[Cn(un(n))]}function Wa(t,n,e,s){return Re(t,n,e(Vn(t,n)),s)}function vr(t,n,e,s){for(var a=t.length,l=s?a:-1;(s?l--:++l<a)&&n(t[l],l,t););return e?on(t,s?0:l,s?l+1:a):on(t,s?l+1:0,s?a:l)}function Ba(t,n){var e=t;return e instanceof j&&(e=e.value()),ai(n,function(s,a){return a.func.apply(a.thisArg,Wn([s],a.args))},e)}function Ri(t,n,e){var s=t.length;if(s<2)return s?zn(t[0]):[];for(var a=-1,l=S(s);++a<s;)for(var h=t[a],d=-1;++d<s;)d!=a&&(l[a]=Te(l[a]||h,t[d],n,e));return zn(Tt(l,1),n,e)}function Ua(t,n,e){for(var s=-1,a=t.length,l=n.length,h={};++s<a;){var d=s<l?n[s]:r;e(h,t[s],d)}return h}function ki(t){return mt(t)?t:[]}function Li(t){return typeof t=="function"?t:zt}function Gn(t,n){return q(t)?t:Gi(t,n)?[t]:_o(it(t))}var dc=Y;function Hn(t,n,e){var s=t.length;return e=e===r?s:e,!n&&e>=s?t:on(t,n,e)}var $a=nf||function(t){return Pt.clearTimeout(t)};function za(t,n){if(n)return t.slice();var e=t.length,s=la?la(e):new t.constructor(e);return t.copy(s),s}function Oi(t){var n=new t.constructor(t.byteLength);return new rr(n).set(new rr(t)),n}function _c(t,n){var e=n?Oi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function vc(t){var n=new t.constructor(t.source,xs.exec(t));return n.lastIndex=t.lastIndex,n}function mc(t){return Ie?at(Ie.call(t)):{}}function Ga(t,n){var e=n?Oi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function Ha(t,n){if(t!==n){var e=t!==r,s=t===null,a=t===t,l=Yt(t),h=n!==r,d=n===null,w=n===n,A=Yt(n);if(!d&&!A&&!l&&t>n||l&&h&&w&&!d&&!A||s&&h&&w||!e&&w||!a)return 1;if(!s&&!l&&!A&&t<n||A&&e&&a&&!s&&!l||d&&e&&a||!h&&a||!w)return-1}return 0}function wc(t,n,e){for(var s=-1,a=t.criteria,l=n.criteria,h=a.length,d=e.length;++s<h;){var w=Ha(a[s],l[s]);if(w){if(s>=d)return w;var A=e[s];return w*(A=="desc"?-1:1)}}return t.index-n.index}function qa(t,n,e,s){for(var a=-1,l=t.length,h=e.length,d=-1,w=n.length,A=bt(l-h,0),I=S(w+A),P=!s;++d<w;)I[d]=n[d];for(;++a<h;)(P||a<l)&&(I[e[a]]=t[a]);for(;A--;)I[d++]=t[a++];return I}function Ka(t,n,e,s){for(var a=-1,l=t.length,h=-1,d=e.length,w=-1,A=n.length,I=bt(l-d,0),P=S(I+A),E=!s;++a<I;)P[a]=t[a];for(var D=a;++w<A;)P[D+w]=n[w];for(;++h<d;)(E||a<l)&&(P[D+e[h]]=t[a++]);return P}function Bt(t,n){var e=-1,s=t.length;for(n||(n=S(s));++e<s;)n[e]=t[e];return n}function Mn(t,n,e,s){var a=!e;e||(e={});for(var l=-1,h=n.length;++l<h;){var d=n[l],w=s?s(e[d],t[d],d,e,t):r;w===r&&(w=t[d]),a?In(e,d,w):Pe(e,d,w)}return e}function yc(t,n){return Mn(t,zi(t),n)}function Mc(t,n){return Mn(t,so(t),n)}function mr(t,n){return function(e,s){var a=q(e)?xl:Gf,l=n?n():{};return a(e,t,B(s,2),l)}}function pe(t){return Y(function(n,e){var s=-1,a=e.length,l=a>1?e[a-1]:r,h=a>2?e[2]:r;for(l=t.length>3&&typeof l=="function"?(a--,l):r,h&&Ot(e[0],e[1],h)&&(l=a<3?r:l,a=1),n=at(n);++s<a;){var d=e[s];d&&t(n,d,s,l)}return n})}function Za(t,n){return function(e,s){if(e==null)return e;if(!Ut(e))return t(e,s);for(var a=e.length,l=n?a:-1,h=at(e);(n?l--:++l<a)&&s(h[l],l,h)!==!1;);return e}}function Ja(t){return function(n,e,s){for(var a=-1,l=at(n),h=s(n),d=h.length;d--;){var w=h[t?d:++a];if(e(l[w],w,l)===!1)break}return n}}function Cc(t,n,e){var s=n&N,a=ke(t);function l(){var h=this&&this!==Pt&&this instanceof l?a:t;return h.apply(s?e:this,arguments)}return l}function Ya(t){return function(n){n=it(n);var e=ae(n)?hn(n):r,s=e?e[0]:n.charAt(0),a=e?Hn(e,1).join(""):n.slice(1);return s[t]()+a}}function ge(t){return function(n){return ai(Jo(Zo(n).replace(cl,"")),t,"")}}function ke(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var e=he(t.prototype),s=t.apply(e,n);return dt(s)?s:e}}function bc(t,n,e){var s=ke(t);function a(){for(var l=arguments.length,h=S(l),d=l,w=de(a);d--;)h[d]=arguments[d];var A=l<3&&h[0]!==w&&h[l-1]!==w?[]:Bn(h,w);if(l-=A.length,l<e)return to(t,n,wr,a.placeholder,r,h,A,r,r,e-l);var I=this&&this!==Pt&&this instanceof a?s:t;return Kt(I,this,h)}return a}function Xa(t){return function(n,e,s){var a=at(n);if(!Ut(n)){var l=B(e,3);n=xt(n),e=function(d){return l(a[d],d,a)}}var h=t(n,e,s);return h>-1?a[l?n[h]:h]:r}}function Qa(t){return Tn(function(n){var e=n.length,s=e,a=sn.prototype.thru;for(t&&n.reverse();s--;){var l=n[s];if(typeof l!="function")throw new rn(g);if(a&&!h&&br(l)=="wrapper")var h=new sn([],!0)}for(s=h?s:e;++s<e;){l=n[s];var d=br(l),w=d=="wrapper"?Ui(l):r;w&&Hi(w[0])&&w[1]==(It|Q|St|Gt)&&!w[4].length&&w[9]==1?h=h[br(w[0])].apply(h,w[3]):h=l.length==1&&Hi(l)?h[d]():h.thru(l)}return function(){var A=arguments,I=A[0];if(h&&A.length==1&&q(I))return h.plant(I).value();for(var P=0,E=e?n[P].apply(this,A):I;++P<e;)E=n[P].call(this,E);return E}})}function wr(t,n,e,s,a,l,h,d,w,A){var I=n&It,P=n&N,E=n&K,D=n&(Q|et),U=n&jt,J=E?r:ke(t);function $(){for(var V=arguments.length,tt=S(V),Xt=V;Xt--;)tt[Xt]=arguments[Xt];if(D)var Dt=de($),Qt=Ll(tt,Dt);if(s&&(tt=qa(tt,s,a,D)),l&&(tt=Ka(tt,l,h,D)),V-=Qt,D&&V<A){var wt=Bn(tt,Dt);return to(t,n,wr,$.placeholder,e,tt,wt,d,w,A-V)}var dn=P?e:this,kn=E?dn[t]:t;return V=tt.length,d?tt=Gc(tt,d):U&&V>1&&tt.reverse(),I&&w<V&&(tt.length=w),this&&this!==Pt&&this instanceof $&&(kn=J||ke(kn)),kn.apply(dn,tt)}return $}function Va(t,n){return function(e,s){return Qf(e,t,n(s),{})}}function yr(t,n){return function(e,s){var a;if(e===r&&s===r)return n;if(e!==r&&(a=e),s!==r){if(a===r)return s;typeof e=="string"||typeof s=="string"?(e=Jt(e),s=Jt(s)):(e=Na(e),s=Na(s)),a=t(e,s)}return a}}function Di(t){return Tn(function(n){return n=gt(n,Zt(B())),Y(function(e){var s=this;return t(n,function(a){return Kt(a,s,e)})})})}function Mr(t,n){n=n===r?" ":Jt(n);var e=n.length;if(e<2)return e?Ti(n,t):n;var s=Ti(n,or(t/oe(n)));return ae(n)?Hn(hn(s),0,t).join(""):s.slice(0,t)}function Sc(t,n,e,s){var a=n&N,l=ke(t);function h(){for(var d=-1,w=arguments.length,A=-1,I=s.length,P=S(I+w),E=this&&this!==Pt&&this instanceof h?l:t;++A<I;)P[A]=s[A];for(;w--;)P[A++]=arguments[++d];return Kt(E,a?e:this,P)}return h}function ja(t){return function(n,e,s){return s&&typeof s!="number"&&Ot(n,e,s)&&(e=s=r),n=Rn(n),e===r?(e=n,n=0):e=Rn(e),s=s===r?n<e?1:-1:Rn(s),lc(n,e,s,t)}}function Cr(t){return function(n,e){return typeof n=="string"&&typeof e=="string"||(n=ln(n),e=ln(e)),t(n,e)}}function to(t,n,e,s,a,l,h,d,w,A){var I=n&Q,P=I?h:r,E=I?r:h,D=I?l:r,U=I?r:l;n|=I?St:At,n&=~(I?At:St),n&X||(n&=~(N|K));var J=[t,n,a,D,P,U,E,d,w,A],$=e.apply(r,J);return Hi(t)&&ho($,J),$.placeholder=s,po($,t,n)}function Ni(t){var n=Ct[t];return function(e,s){if(e=ln(e),s=s==null?0:Ft(Z(s),292),s&&pa(e)){var a=(it(e)+"e").split("e"),l=n(a[0]+"e"+(+a[1]+s));return a=(it(l)+"e").split("e"),+(a[0]+"e"+(+a[1]-s))}return n(e)}}var xc=fe&&1/Qe(new fe([,-0]))[1]==bn?function(t){return new fe(t)}:ss;function no(t){return function(n){var e=Et(n);return e==_t?pi(n):e==pt?$l(n):kl(n,t(n))}}function Pn(t,n,e,s,a,l,h,d){var w=n&K;if(!w&&typeof t!="function")throw new rn(g);var A=s?s.length:0;if(A||(n&=~(St|At),s=a=r),h=h===r?h:bt(Z(h),0),d=d===r?d:Z(d),A-=a?a.length:0,n&At){var I=s,P=a;s=a=r}var E=w?r:Ui(t),D=[t,n,e,s,a,I,P,l,h,d];if(E&&Uc(D,E),t=D[0],n=D[1],e=D[2],s=D[3],a=D[4],d=D[9]=D[9]===r?w?0:t.length:bt(D[9]-A,0),!d&&n&(Q|et)&&(n&=~(Q|et)),!n||n==N)var U=Cc(t,n,e);else n==Q||n==et?U=bc(t,n,d):(n==St||n==(N|St))&&!a.length?U=Sc(t,n,e,s):U=wr.apply(r,D);var J=E?Oa:ho;return po(J(U,D),t,n)}function eo(t,n,e,s){return t===r||gn(t,le[e])&&!st.call(s,e)?n:t}function ro(t,n,e,s,a,l){return dt(t)&&dt(n)&&(l.set(n,t),dr(t,n,r,ro,l),l.delete(n)),t}function Ac(t){return De(t)?r:t}function io(t,n,e,s,a,l){var h=e&R,d=t.length,w=n.length;if(d!=w&&!(h&&w>d))return!1;var A=l.get(t),I=l.get(n);if(A&&I)return A==n&&I==t;var P=-1,E=!0,D=e&T?new Xn:r;for(l.set(t,n),l.set(n,t);++P<d;){var U=t[P],J=n[P];if(s)var $=h?s(J,U,P,n,t,l):s(U,J,P,t,n,l);if($!==r){if($)continue;E=!1;break}if(D){if(!oi(n,function(V,tt){if(!Ce(D,tt)&&(U===V||a(U,V,e,s,l)))return D.push(tt)})){E=!1;break}}else if(!(U===J||a(U,J,e,s,l))){E=!1;break}}return l.delete(t),l.delete(n),E}function Ic(t,n,e,s,a,l,h){switch(e){case re:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case Me:return!(t.byteLength!=n.byteLength||!l(new rr(t),new rr(n)));case lt:case yt:case kt:return gn(+t,+n);case Rt:return t.name==n.name&&t.message==n.message;case tn:case wn:return t==n+"";case _t:var d=pi;case pt:var w=s&R;if(d||(d=Qe),t.size!=n.size&&!w)return!1;var A=h.get(t);if(A)return A==n;s|=T,h.set(t,n);var I=io(d(t),d(n),s,a,l,h);return h.delete(t),I;case qe:if(Ie)return Ie.call(t)==Ie.call(n)}return!1}function Pc(t,n,e,s,a,l){var h=e&R,d=Wi(t),w=d.length,A=Wi(n),I=A.length;if(w!=I&&!h)return!1;for(var P=w;P--;){var E=d[P];if(!(h?E in n:st.call(n,E)))return!1}var D=l.get(t),U=l.get(n);if(D&&U)return D==n&&U==t;var J=!0;l.set(t,n),l.set(n,t);for(var $=h;++P<w;){E=d[P];var V=t[E],tt=n[E];if(s)var Xt=h?s(tt,V,E,n,t,l):s(V,tt,E,t,n,l);if(!(Xt===r?V===tt||a(V,tt,e,s,l):Xt)){J=!1;break}$||($=E=="constructor")}if(J&&!$){var Dt=t.constructor,Qt=n.constructor;Dt!=Qt&&"constructor"in t&&"constructor"in n&&!(typeof Dt=="function"&&Dt instanceof Dt&&typeof Qt=="function"&&Qt instanceof Qt)&&(J=!1)}return l.delete(t),l.delete(n),J}function Tn(t){return Ki(fo(t,r,yo),t+"")}function Wi(t){return Sa(t,xt,zi)}function Bi(t){return Sa(t,$t,so)}var Ui=lr?function(t){return lr.get(t)}:ss;function br(t){for(var n=t.name+"",e=ce[n],s=st.call(ce,n)?e.length:0;s--;){var a=e[s],l=a.func;if(l==null||l==t)return a.name}return n}function de(t){var n=st.call(u,"placeholder")?u:t;return n.placeholder}function B(){var t=u.iteratee||rs;return t=t===rs?Ia:t,arguments.length?t(arguments[0],arguments[1]):t}function Sr(t,n){var e=t.__data__;return Dc(n)?e[typeof n=="string"?"string":"hash"]:e.map}function $i(t){for(var n=xt(t),e=n.length;e--;){var s=n[e],a=t[s];n[e]=[s,a,uo(a)]}return n}function jn(t,n){var e=Wl(t,n);return Aa(e)?e:r}function Tc(t){var n=st.call(t,Jn),e=t[Jn];try{t[Jn]=r;var s=!0}catch{}var a=nr.call(t);return s&&(n?t[Jn]=e:delete t[Jn]),a}var zi=di?function(t){return t==null?[]:(t=at(t),Nn(di(t),function(n){return ca.call(t,n)}))}:as,so=di?function(t){for(var n=[];t;)Wn(n,zi(t)),t=ir(t);return n}:as,Et=Lt;(_i&&Et(new _i(new ArrayBuffer(1)))!=re||Se&&Et(new Se)!=_t||vi&&Et(vi.resolve())!=Wt||fe&&Et(new fe)!=pt||xe&&Et(new xe)!=ye)&&(Et=function(t){var n=Lt(t),e=n==Mt?t.constructor:r,s=e?te(e):"";if(s)switch(s){case cf:return re;case hf:return _t;case pf:return Wt;case gf:return pt;case df:return ye}return n});function Fc(t,n,e){for(var s=-1,a=e.length;++s<a;){var l=e[s],h=l.size;switch(l.type){case"drop":t+=h;break;case"dropRight":n-=h;break;case"take":n=Ft(n,t+h);break;case"takeRight":t=bt(t,n-h);break}}return{start:t,end:n}}function Ec(t){var n=t.match(Du);return n?n[1].split(Nu):[]}function ao(t,n,e){n=Gn(n,t);for(var s=-1,a=n.length,l=!1;++s<a;){var h=Cn(n[s]);if(!(l=t!=null&&e(t,h)))break;t=t[h]}return l||++s!=a?l:(a=t==null?0:t.length,!!a&&Er(a)&&Fn(h,a)&&(q(t)||ne(t)))}function Rc(t){var n=t.length,e=new t.constructor(n);return n&&typeof t[0]=="string"&&st.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function oo(t){return typeof t.constructor=="function"&&!Le(t)?he(ir(t)):{}}function kc(t,n,e){var s=t.constructor;switch(n){case Me:return Oi(t);case lt:case yt:return new s(+t);case re:return _c(t,e);case $r:case zr:case Gr:case Hr:case qr:case Kr:case Zr:case Jr:case Yr:return Ga(t,e);case _t:return new s;case kt:case wn:return new s(t);case tn:return vc(t);case pt:return new s;case qe:return mc(t)}}function Lc(t,n){var e=n.length;if(!e)return t;var s=e-1;return n[s]=(e>1?"& ":"")+n[s],n=n.join(e>2?", ":" "),t.replace(Ou,`{
/* [wrapped with `+n+`] */
`)}function Oc(t){return q(t)||ne(t)||!!(ha&&t&&t[ha])}function Fn(t,n){var e=typeof t;return n=n??vn,!!n&&(e=="number"||e!="symbol"&&Ku.test(t))&&t>-1&&t%1==0&&t<n}function Ot(t,n,e){if(!dt(e))return!1;var s=typeof n;return(s=="number"?Ut(e)&&Fn(n,e.length):s=="string"&&n in e)?gn(e[n],t):!1}function Gi(t,n){if(q(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||Yt(t)?!0:Eu.test(t)||!Fu.test(t)||n!=null&&t in at(n)}function Dc(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Hi(t){var n=br(t),e=u[n];if(typeof e!="function"||!(n in j.prototype))return!1;if(t===e)return!0;var s=Ui(e);return!!s&&t===s[0]}function Nc(t){return!!ua&&ua in t}var Wc=je?En:os;function Le(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||le;return t===e}function uo(t){return t===t&&!dt(t)}function lo(t,n){return function(e){return e==null?!1:e[t]===n&&(n!==r||t in at(e))}}function Bc(t){var n=Tr(t,function(s){return e.size===C&&e.clear(),s}),e=n.cache;return n}function Uc(t,n){var e=t[1],s=n[1],a=e|s,l=a<(N|K|It),h=s==It&&e==Q||s==It&&e==Gt&&t[7].length<=n[8]||s==(It|Gt)&&n[7].length<=n[8]&&e==Q;if(!(l||h))return t;s&N&&(t[2]=n[2],a|=e&N?0:X);var d=n[3];if(d){var w=t[3];t[3]=w?qa(w,d,n[4]):d,t[4]=w?Bn(t[3],b):n[4]}return d=n[5],d&&(w=t[5],t[5]=w?Ka(w,d,n[6]):d,t[6]=w?Bn(t[5],b):n[6]),d=n[7],d&&(t[7]=d),s&It&&(t[8]=t[8]==null?n[8]:Ft(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=a,t}function $c(t){var n=[];if(t!=null)for(var e in at(t))n.push(e);return n}function zc(t){return nr.call(t)}function fo(t,n,e){return n=bt(n===r?t.length-1:n,0),function(){for(var s=arguments,a=-1,l=bt(s.length-n,0),h=S(l);++a<l;)h[a]=s[n+a];a=-1;for(var d=S(n+1);++a<n;)d[a]=s[a];return d[n]=e(h),Kt(t,this,d)}}function co(t,n){return n.length<2?t:Vn(t,on(n,0,-1))}function Gc(t,n){for(var e=t.length,s=Ft(n.length,e),a=Bt(t);s--;){var l=n[s];t[s]=Fn(l,e)?a[l]:r}return t}function qi(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var ho=go(Oa),Oe=rf||function(t,n){return Pt.setTimeout(t,n)},Ki=go(hc);function po(t,n,e){var s=n+"";return Ki(t,Lc(s,Hc(Ec(s),e)))}function go(t){var n=0,e=0;return function(){var s=uf(),a=Br-(s-e);if(e=s,a>0){if(++n>=ze)return arguments[0]}else n=0;return t.apply(r,arguments)}}function xr(t,n){var e=-1,s=t.length,a=s-1;for(n=n===r?s:n;++e<n;){var l=Pi(e,a),h=t[l];t[l]=t[e],t[e]=h}return t.length=n,t}var _o=Bc(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(Ru,function(e,s,a,l){n.push(a?l.replace(Uu,"$1"):s||e)}),n});function Cn(t){if(typeof t=="string"||Yt(t))return t;var n=t+"";return n=="0"&&1/t==-bn?"-0":n}function te(t){if(t!=null){try{return tr.call(t)}catch{}try{return t+""}catch{}}return""}function Hc(t,n){return en(ct,function(e){var s="_."+e[0];n&e[1]&&!Ye(t,s)&&t.push(s)}),t.sort()}function vo(t){if(t instanceof j)return t.clone();var n=new sn(t.__wrapped__,t.__chain__);return n.__actions__=Bt(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function qc(t,n,e){(e?Ot(t,n,e):n===r)?n=1:n=bt(Z(n),0);var s=t==null?0:t.length;if(!s||n<1)return[];for(var a=0,l=0,h=S(or(s/n));a<s;)h[l++]=on(t,a,a+=n);return h}function Kc(t){for(var n=-1,e=t==null?0:t.length,s=0,a=[];++n<e;){var l=t[n];l&&(a[s++]=l)}return a}function Zc(){var t=arguments.length;if(!t)return[];for(var n=S(t-1),e=arguments[0],s=t;s--;)n[s-1]=arguments[s];return Wn(q(e)?Bt(e):[e],Tt(n,1))}var Jc=Y(function(t,n){return mt(t)?Te(t,Tt(n,1,mt,!0)):[]}),Yc=Y(function(t,n){var e=un(n);return mt(e)&&(e=r),mt(t)?Te(t,Tt(n,1,mt,!0),B(e,2)):[]}),Xc=Y(function(t,n){var e=un(n);return mt(e)&&(e=r),mt(t)?Te(t,Tt(n,1,mt,!0),r,e):[]});function Qc(t,n,e){var s=t==null?0:t.length;return s?(n=e||n===r?1:Z(n),on(t,n<0?0:n,s)):[]}function Vc(t,n,e){var s=t==null?0:t.length;return s?(n=e||n===r?1:Z(n),n=s-n,on(t,0,n<0?0:n)):[]}function jc(t,n){return t&&t.length?vr(t,B(n,3),!0,!0):[]}function th(t,n){return t&&t.length?vr(t,B(n,3),!0):[]}function nh(t,n,e,s){var a=t==null?0:t.length;return a?(e&&typeof e!="number"&&Ot(t,n,e)&&(e=0,s=a),Zf(t,n,e,s)):[]}function mo(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var a=e==null?0:Z(e);return a<0&&(a=bt(s+a,0)),Xe(t,B(n,3),a)}function wo(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var a=s-1;return e!==r&&(a=Z(e),a=e<0?bt(s+a,0):Ft(a,s-1)),Xe(t,B(n,3),a,!0)}function yo(t){var n=t==null?0:t.length;return n?Tt(t,1):[]}function eh(t){var n=t==null?0:t.length;return n?Tt(t,bn):[]}function rh(t,n){var e=t==null?0:t.length;return e?(n=n===r?1:Z(n),Tt(t,n)):[]}function ih(t){for(var n=-1,e=t==null?0:t.length,s={};++n<e;){var a=t[n];s[a[0]]=a[1]}return s}function Mo(t){return t&&t.length?t[0]:r}function sh(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var a=e==null?0:Z(e);return a<0&&(a=bt(s+a,0)),se(t,n,a)}function ah(t){var n=t==null?0:t.length;return n?on(t,0,-1):[]}var oh=Y(function(t){var n=gt(t,ki);return n.length&&n[0]===t[0]?bi(n):[]}),uh=Y(function(t){var n=un(t),e=gt(t,ki);return n===un(e)?n=r:e.pop(),e.length&&e[0]===t[0]?bi(e,B(n,2)):[]}),lh=Y(function(t){var n=un(t),e=gt(t,ki);return n=typeof n=="function"?n:r,n&&e.pop(),e.length&&e[0]===t[0]?bi(e,r,n):[]});function fh(t,n){return t==null?"":af.call(t,n)}function un(t){var n=t==null?0:t.length;return n?t[n-1]:r}function ch(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var a=s;return e!==r&&(a=Z(e),a=a<0?bt(s+a,0):Ft(a,s-1)),n===n?Gl(t,n,a):Xe(t,ta,a,!0)}function hh(t,n){return t&&t.length?Ea(t,Z(n)):r}var ph=Y(Co);function Co(t,n){return t&&t.length&&n&&n.length?Ii(t,n):t}function gh(t,n,e){return t&&t.length&&n&&n.length?Ii(t,n,B(e,2)):t}function dh(t,n,e){return t&&t.length&&n&&n.length?Ii(t,n,r,e):t}var _h=Tn(function(t,n){var e=t==null?0:t.length,s=wi(t,n);return La(t,gt(n,function(a){return Fn(a,e)?+a:a}).sort(Ha)),s});function vh(t,n){var e=[];if(!(t&&t.length))return e;var s=-1,a=[],l=t.length;for(n=B(n,3);++s<l;){var h=t[s];n(h,s,t)&&(e.push(h),a.push(s))}return La(t,a),e}function Zi(t){return t==null?t:ff.call(t)}function mh(t,n,e){var s=t==null?0:t.length;return s?(e&&typeof e!="number"&&Ot(t,n,e)?(n=0,e=s):(n=n==null?0:Z(n),e=e===r?s:Z(e)),on(t,n,e)):[]}function wh(t,n){return _r(t,n)}function yh(t,n,e){return Fi(t,n,B(e,2))}function Mh(t,n){var e=t==null?0:t.length;if(e){var s=_r(t,n);if(s<e&&gn(t[s],n))return s}return-1}function Ch(t,n){return _r(t,n,!0)}function bh(t,n,e){return Fi(t,n,B(e,2),!0)}function Sh(t,n){var e=t==null?0:t.length;if(e){var s=_r(t,n,!0)-1;if(gn(t[s],n))return s}return-1}function xh(t){return t&&t.length?Da(t):[]}function Ah(t,n){return t&&t.length?Da(t,B(n,2)):[]}function Ih(t){var n=t==null?0:t.length;return n?on(t,1,n):[]}function Ph(t,n,e){return t&&t.length?(n=e||n===r?1:Z(n),on(t,0,n<0?0:n)):[]}function Th(t,n,e){var s=t==null?0:t.length;return s?(n=e||n===r?1:Z(n),n=s-n,on(t,n<0?0:n,s)):[]}function Fh(t,n){return t&&t.length?vr(t,B(n,3),!1,!0):[]}function Eh(t,n){return t&&t.length?vr(t,B(n,3)):[]}var Rh=Y(function(t){return zn(Tt(t,1,mt,!0))}),kh=Y(function(t){var n=un(t);return mt(n)&&(n=r),zn(Tt(t,1,mt,!0),B(n,2))}),Lh=Y(function(t){var n=un(t);return n=typeof n=="function"?n:r,zn(Tt(t,1,mt,!0),r,n)});function Oh(t){return t&&t.length?zn(t):[]}function Dh(t,n){return t&&t.length?zn(t,B(n,2)):[]}function Nh(t,n){return n=typeof n=="function"?n:r,t&&t.length?zn(t,r,n):[]}function Ji(t){if(!(t&&t.length))return[];var n=0;return t=Nn(t,function(e){if(mt(e))return n=bt(e.length,n),!0}),ci(n,function(e){return gt(t,ui(e))})}function bo(t,n){if(!(t&&t.length))return[];var e=Ji(t);return n==null?e:gt(e,function(s){return Kt(n,r,s)})}var Wh=Y(function(t,n){return mt(t)?Te(t,n):[]}),Bh=Y(function(t){return Ri(Nn(t,mt))}),Uh=Y(function(t){var n=un(t);return mt(n)&&(n=r),Ri(Nn(t,mt),B(n,2))}),$h=Y(function(t){var n=un(t);return n=typeof n=="function"?n:r,Ri(Nn(t,mt),r,n)}),zh=Y(Ji);function Gh(t,n){return Ua(t||[],n||[],Pe)}function Hh(t,n){return Ua(t||[],n||[],Re)}var qh=Y(function(t){var n=t.length,e=n>1?t[n-1]:r;return e=typeof e=="function"?(t.pop(),e):r,bo(t,e)});function So(t){var n=u(t);return n.__chain__=!0,n}function Kh(t,n){return n(t),t}function Ar(t,n){return n(t)}var Zh=Tn(function(t){var n=t.length,e=n?t[0]:0,s=this.__wrapped__,a=function(l){return wi(l,t)};return n>1||this.__actions__.length||!(s instanceof j)||!Fn(e)?this.thru(a):(s=s.slice(e,+e+(n?1:0)),s.__actions__.push({func:Ar,args:[a],thisArg:r}),new sn(s,this.__chain__).thru(function(l){return n&&!l.length&&l.push(r),l}))});function Jh(){return So(this)}function Yh(){return new sn(this.value(),this.__chain__)}function Xh(){this.__values__===r&&(this.__values__=Wo(this.value()));var t=this.__index__>=this.__values__.length,n=t?r:this.__values__[this.__index__++];return{done:t,value:n}}function Qh(){return this}function Vh(t){for(var n,e=this;e instanceof cr;){var s=vo(e);s.__index__=0,s.__values__=r,n?a.__wrapped__=s:n=s;var a=s;e=e.__wrapped__}return a.__wrapped__=t,n}function jh(){var t=this.__wrapped__;if(t instanceof j){var n=t;return this.__actions__.length&&(n=new j(this)),n=n.reverse(),n.__actions__.push({func:Ar,args:[Zi],thisArg:r}),new sn(n,this.__chain__)}return this.thru(Zi)}function tp(){return Ba(this.__wrapped__,this.__actions__)}var np=mr(function(t,n,e){st.call(t,e)?++t[e]:In(t,e,1)});function ep(t,n,e){var s=q(t)?Vs:Kf;return e&&Ot(t,n,e)&&(n=r),s(t,B(n,3))}function rp(t,n){var e=q(t)?Nn:Ca;return e(t,B(n,3))}var ip=Xa(mo),sp=Xa(wo);function ap(t,n){return Tt(Ir(t,n),1)}function op(t,n){return Tt(Ir(t,n),bn)}function up(t,n,e){return e=e===r?1:Z(e),Tt(Ir(t,n),e)}function xo(t,n){var e=q(t)?en:$n;return e(t,B(n,3))}function Ao(t,n){var e=q(t)?Al:Ma;return e(t,B(n,3))}var lp=mr(function(t,n,e){st.call(t,e)?t[e].push(n):In(t,e,[n])});function fp(t,n,e,s){t=Ut(t)?t:ve(t),e=e&&!s?Z(e):0;var a=t.length;return e<0&&(e=bt(a+e,0)),Rr(t)?e<=a&&t.indexOf(n,e)>-1:!!a&&se(t,n,e)>-1}var cp=Y(function(t,n,e){var s=-1,a=typeof n=="function",l=Ut(t)?S(t.length):[];return $n(t,function(h){l[++s]=a?Kt(n,h,e):Fe(h,n,e)}),l}),hp=mr(function(t,n,e){In(t,e,n)});function Ir(t,n){var e=q(t)?gt:Pa;return e(t,B(n,3))}function pp(t,n,e,s){return t==null?[]:(q(n)||(n=n==null?[]:[n]),e=s?r:e,q(e)||(e=e==null?[]:[e]),Ra(t,n,e))}var gp=mr(function(t,n,e){t[e?0:1].push(n)},function(){return[[],[]]});function dp(t,n,e){var s=q(t)?ai:ea,a=arguments.length<3;return s(t,B(n,4),e,a,$n)}function _p(t,n,e){var s=q(t)?Il:ea,a=arguments.length<3;return s(t,B(n,4),e,a,Ma)}function vp(t,n){var e=q(t)?Nn:Ca;return e(t,Fr(B(n,3)))}function mp(t){var n=q(t)?va:fc;return n(t)}function wp(t,n,e){(e?Ot(t,n,e):n===r)?n=1:n=Z(n);var s=q(t)?$f:cc;return s(t,n)}function yp(t){var n=q(t)?zf:pc;return n(t)}function Mp(t){if(t==null)return 0;if(Ut(t))return Rr(t)?oe(t):t.length;var n=Et(t);return n==_t||n==pt?t.size:xi(t).length}function Cp(t,n,e){var s=q(t)?oi:gc;return e&&Ot(t,n,e)&&(n=r),s(t,B(n,3))}var bp=Y(function(t,n){if(t==null)return[];var e=n.length;return e>1&&Ot(t,n[0],n[1])?n=[]:e>2&&Ot(n[0],n[1],n[2])&&(n=[n[0]]),Ra(t,Tt(n,1),[])}),Pr=ef||function(){return Pt.Date.now()};function Sp(t,n){if(typeof n!="function")throw new rn(g);return t=Z(t),function(){if(--t<1)return n.apply(this,arguments)}}function Io(t,n,e){return n=e?r:n,n=t&&n==null?t.length:n,Pn(t,It,r,r,r,r,n)}function Po(t,n){var e;if(typeof n!="function")throw new rn(g);return t=Z(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=r),e}}var Yi=Y(function(t,n,e){var s=N;if(e.length){var a=Bn(e,de(Yi));s|=St}return Pn(t,s,n,e,a)}),To=Y(function(t,n,e){var s=N|K;if(e.length){var a=Bn(e,de(To));s|=St}return Pn(n,s,t,e,a)});function Fo(t,n,e){n=e?r:n;var s=Pn(t,Q,r,r,r,r,r,n);return s.placeholder=Fo.placeholder,s}function Eo(t,n,e){n=e?r:n;var s=Pn(t,et,r,r,r,r,r,n);return s.placeholder=Eo.placeholder,s}function Ro(t,n,e){var s,a,l,h,d,w,A=0,I=!1,P=!1,E=!0;if(typeof t!="function")throw new rn(g);n=ln(n)||0,dt(e)&&(I=!!e.leading,P="maxWait"in e,l=P?bt(ln(e.maxWait)||0,n):l,E="trailing"in e?!!e.trailing:E);function D(wt){var dn=s,kn=a;return s=a=r,A=wt,h=t.apply(kn,dn),h}function U(wt){return A=wt,d=Oe(V,n),I?D(wt):h}function J(wt){var dn=wt-w,kn=wt-A,Qo=n-dn;return P?Ft(Qo,l-kn):Qo}function $(wt){var dn=wt-w,kn=wt-A;return w===r||dn>=n||dn<0||P&&kn>=l}function V(){var wt=Pr();if($(wt))return tt(wt);d=Oe(V,J(wt))}function tt(wt){return d=r,E&&s?D(wt):(s=a=r,h)}function Xt(){d!==r&&$a(d),A=0,s=w=a=d=r}function Dt(){return d===r?h:tt(Pr())}function Qt(){var wt=Pr(),dn=$(wt);if(s=arguments,a=this,w=wt,dn){if(d===r)return U(w);if(P)return $a(d),d=Oe(V,n),D(w)}return d===r&&(d=Oe(V,n)),h}return Qt.cancel=Xt,Qt.flush=Dt,Qt}var xp=Y(function(t,n){return ya(t,1,n)}),Ap=Y(function(t,n,e){return ya(t,ln(n)||0,e)});function Ip(t){return Pn(t,jt)}function Tr(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new rn(g);var e=function(){var s=arguments,a=n?n.apply(this,s):s[0],l=e.cache;if(l.has(a))return l.get(a);var h=t.apply(this,s);return e.cache=l.set(a,h)||l,h};return e.cache=new(Tr.Cache||An),e}Tr.Cache=An;function Fr(t){if(typeof t!="function")throw new rn(g);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function Pp(t){return Po(2,t)}var Tp=dc(function(t,n){n=n.length==1&&q(n[0])?gt(n[0],Zt(B())):gt(Tt(n,1),Zt(B()));var e=n.length;return Y(function(s){for(var a=-1,l=Ft(s.length,e);++a<l;)s[a]=n[a].call(this,s[a]);return Kt(t,this,s)})}),Xi=Y(function(t,n){var e=Bn(n,de(Xi));return Pn(t,St,r,n,e)}),ko=Y(function(t,n){var e=Bn(n,de(ko));return Pn(t,At,r,n,e)}),Fp=Tn(function(t,n){return Pn(t,Gt,r,r,r,n)});function Ep(t,n){if(typeof t!="function")throw new rn(g);return n=n===r?n:Z(n),Y(t,n)}function Rp(t,n){if(typeof t!="function")throw new rn(g);return n=n==null?0:bt(Z(n),0),Y(function(e){var s=e[n],a=Hn(e,0,n);return s&&Wn(a,s),Kt(t,this,a)})}function kp(t,n,e){var s=!0,a=!0;if(typeof t!="function")throw new rn(g);return dt(e)&&(s="leading"in e?!!e.leading:s,a="trailing"in e?!!e.trailing:a),Ro(t,n,{leading:s,maxWait:n,trailing:a})}function Lp(t){return Io(t,1)}function Op(t,n){return Xi(Li(n),t)}function Dp(){if(!arguments.length)return[];var t=arguments[0];return q(t)?t:[t]}function Np(t){return an(t,O)}function Wp(t,n){return n=typeof n=="function"?n:r,an(t,O,n)}function Bp(t){return an(t,m|O)}function Up(t,n){return n=typeof n=="function"?n:r,an(t,m|O,n)}function $p(t,n){return n==null||wa(t,n,xt(n))}function gn(t,n){return t===n||t!==t&&n!==n}var zp=Cr(Ci),Gp=Cr(function(t,n){return t>=n}),ne=xa(function(){return arguments}())?xa:function(t){return vt(t)&&st.call(t,"callee")&&!ca.call(t,"callee")},q=S.isArray,Hp=Ks?Zt(Ks):Vf;function Ut(t){return t!=null&&Er(t.length)&&!En(t)}function mt(t){return vt(t)&&Ut(t)}function qp(t){return t===!0||t===!1||vt(t)&&Lt(t)==lt}var qn=sf||os,Kp=Zs?Zt(Zs):jf;function Zp(t){return vt(t)&&t.nodeType===1&&!De(t)}function Jp(t){if(t==null)return!0;if(Ut(t)&&(q(t)||typeof t=="string"||typeof t.splice=="function"||qn(t)||_e(t)||ne(t)))return!t.length;var n=Et(t);if(n==_t||n==pt)return!t.size;if(Le(t))return!xi(t).length;for(var e in t)if(st.call(t,e))return!1;return!0}function Yp(t,n){return Ee(t,n)}function Xp(t,n,e){e=typeof e=="function"?e:r;var s=e?e(t,n):r;return s===r?Ee(t,n,r,e):!!s}function Qi(t){if(!vt(t))return!1;var n=Lt(t);return n==Rt||n==qt||typeof t.message=="string"&&typeof t.name=="string"&&!De(t)}function Qp(t){return typeof t=="number"&&pa(t)}function En(t){if(!dt(t))return!1;var n=Lt(t);return n==Nt||n==mn||n==ot||n==cn}function Lo(t){return typeof t=="number"&&t==Z(t)}function Er(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=vn}function dt(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function vt(t){return t!=null&&typeof t=="object"}var Oo=Js?Zt(Js):nc;function Vp(t,n){return t===n||Si(t,n,$i(n))}function jp(t,n,e){return e=typeof e=="function"?e:r,Si(t,n,$i(n),e)}function tg(t){return Do(t)&&t!=+t}function ng(t){if(Wc(t))throw new H(p);return Aa(t)}function eg(t){return t===null}function rg(t){return t==null}function Do(t){return typeof t=="number"||vt(t)&&Lt(t)==kt}function De(t){if(!vt(t)||Lt(t)!=Mt)return!1;var n=ir(t);if(n===null)return!0;var e=st.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&tr.call(e)==Vl}var Vi=Ys?Zt(Ys):ec;function ig(t){return Lo(t)&&t>=-vn&&t<=vn}var No=Xs?Zt(Xs):rc;function Rr(t){return typeof t=="string"||!q(t)&&vt(t)&&Lt(t)==wn}function Yt(t){return typeof t=="symbol"||vt(t)&&Lt(t)==qe}var _e=Qs?Zt(Qs):ic;function sg(t){return t===r}function ag(t){return vt(t)&&Et(t)==ye}function og(t){return vt(t)&&Lt(t)==Cu}var ug=Cr(Ai),lg=Cr(function(t,n){return t<=n});function Wo(t){if(!t)return[];if(Ut(t))return Rr(t)?hn(t):Bt(t);if(be&&t[be])return Ul(t[be]());var n=Et(t),e=n==_t?pi:n==pt?Qe:ve;return e(t)}function Rn(t){if(!t)return t===0?t:0;if(t=ln(t),t===bn||t===-bn){var n=t<0?-1:1;return n*He}return t===t?t:0}function Z(t){var n=Rn(t),e=n%1;return n===n?e?n-e:n:0}function Bo(t){return t?Qn(Z(t),0,k):0}function ln(t){if(typeof t=="number")return t;if(Yt(t))return Sn;if(dt(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=dt(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=ra(t);var e=Gu.test(t);return e||qu.test(t)?bl(t.slice(2),e?2:8):zu.test(t)?Sn:+t}function Uo(t){return Mn(t,$t(t))}function fg(t){return t?Qn(Z(t),-vn,vn):t===0?t:0}function it(t){return t==null?"":Jt(t)}var cg=pe(function(t,n){if(Le(n)||Ut(n)){Mn(n,xt(n),t);return}for(var e in n)st.call(n,e)&&Pe(t,e,n[e])}),$o=pe(function(t,n){Mn(n,$t(n),t)}),kr=pe(function(t,n,e,s){Mn(n,$t(n),t,s)}),hg=pe(function(t,n,e,s){Mn(n,xt(n),t,s)}),pg=Tn(wi);function gg(t,n){var e=he(t);return n==null?e:ma(e,n)}var dg=Y(function(t,n){t=at(t);var e=-1,s=n.length,a=s>2?n[2]:r;for(a&&Ot(n[0],n[1],a)&&(s=1);++e<s;)for(var l=n[e],h=$t(l),d=-1,w=h.length;++d<w;){var A=h[d],I=t[A];(I===r||gn(I,le[A])&&!st.call(t,A))&&(t[A]=l[A])}return t}),_g=Y(function(t){return t.push(r,ro),Kt(zo,r,t)});function vg(t,n){return js(t,B(n,3),yn)}function mg(t,n){return js(t,B(n,3),Mi)}function wg(t,n){return t==null?t:yi(t,B(n,3),$t)}function yg(t,n){return t==null?t:ba(t,B(n,3),$t)}function Mg(t,n){return t&&yn(t,B(n,3))}function Cg(t,n){return t&&Mi(t,B(n,3))}function bg(t){return t==null?[]:gr(t,xt(t))}function Sg(t){return t==null?[]:gr(t,$t(t))}function ji(t,n,e){var s=t==null?r:Vn(t,n);return s===r?e:s}function xg(t,n){return t!=null&&ao(t,n,Jf)}function ts(t,n){return t!=null&&ao(t,n,Yf)}var Ag=Va(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=nr.call(n)),t[n]=e},es(zt)),Ig=Va(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=nr.call(n)),st.call(t,n)?t[n].push(e):t[n]=[e]},B),Pg=Y(Fe);function xt(t){return Ut(t)?_a(t):xi(t)}function $t(t){return Ut(t)?_a(t,!0):sc(t)}function Tg(t,n){var e={};return n=B(n,3),yn(t,function(s,a,l){In(e,n(s,a,l),s)}),e}function Fg(t,n){var e={};return n=B(n,3),yn(t,function(s,a,l){In(e,a,n(s,a,l))}),e}var Eg=pe(function(t,n,e){dr(t,n,e)}),zo=pe(function(t,n,e,s){dr(t,n,e,s)}),Rg=Tn(function(t,n){var e={};if(t==null)return e;var s=!1;n=gt(n,function(l){return l=Gn(l,t),s||(s=l.length>1),l}),Mn(t,Bi(t),e),s&&(e=an(e,m|F|O,Ac));for(var a=n.length;a--;)Ei(e,n[a]);return e});function kg(t,n){return Go(t,Fr(B(n)))}var Lg=Tn(function(t,n){return t==null?{}:oc(t,n)});function Go(t,n){if(t==null)return{};var e=gt(Bi(t),function(s){return[s]});return n=B(n),ka(t,e,function(s,a){return n(s,a[0])})}function Og(t,n,e){n=Gn(n,t);var s=-1,a=n.length;for(a||(a=1,t=r);++s<a;){var l=t==null?r:t[Cn(n[s])];l===r&&(s=a,l=e),t=En(l)?l.call(t):l}return t}function Dg(t,n,e){return t==null?t:Re(t,n,e)}function Ng(t,n,e,s){return s=typeof s=="function"?s:r,t==null?t:Re(t,n,e,s)}var Ho=no(xt),qo=no($t);function Wg(t,n,e){var s=q(t),a=s||qn(t)||_e(t);if(n=B(n,4),e==null){var l=t&&t.constructor;a?e=s?new l:[]:dt(t)?e=En(l)?he(ir(t)):{}:e={}}return(a?en:yn)(t,function(h,d,w){return n(e,h,d,w)}),e}function Bg(t,n){return t==null?!0:Ei(t,n)}function Ug(t,n,e){return t==null?t:Wa(t,n,Li(e))}function $g(t,n,e,s){return s=typeof s=="function"?s:r,t==null?t:Wa(t,n,Li(e),s)}function ve(t){return t==null?[]:hi(t,xt(t))}function zg(t){return t==null?[]:hi(t,$t(t))}function Gg(t,n,e){return e===r&&(e=n,n=r),e!==r&&(e=ln(e),e=e===e?e:0),n!==r&&(n=ln(n),n=n===n?n:0),Qn(ln(t),n,e)}function Hg(t,n,e){return n=Rn(n),e===r?(e=n,n=0):e=Rn(e),t=ln(t),Xf(t,n,e)}function qg(t,n,e){if(e&&typeof e!="boolean"&&Ot(t,n,e)&&(n=e=r),e===r&&(typeof n=="boolean"?(e=n,n=r):typeof t=="boolean"&&(e=t,t=r)),t===r&&n===r?(t=0,n=1):(t=Rn(t),n===r?(n=t,t=0):n=Rn(n)),t>n){var s=t;t=n,n=s}if(e||t%1||n%1){var a=ga();return Ft(t+a*(n-t+Cl("1e-"+((a+"").length-1))),n)}return Pi(t,n)}var Kg=ge(function(t,n,e){return n=n.toLowerCase(),t+(e?Ko(n):n)});function Ko(t){return ns(it(t).toLowerCase())}function Zo(t){return t=it(t),t&&t.replace(Zu,Ol).replace(hl,"")}function Zg(t,n,e){t=it(t),n=Jt(n);var s=t.length;e=e===r?s:Qn(Z(e),0,s);var a=e;return e-=n.length,e>=0&&t.slice(e,a)==n}function Jg(t){return t=it(t),t&&Iu.test(t)?t.replace(bs,Dl):t}function Yg(t){return t=it(t),t&&ku.test(t)?t.replace(Xr,"\\$&"):t}var Xg=ge(function(t,n,e){return t+(e?"-":"")+n.toLowerCase()}),Qg=ge(function(t,n,e){return t+(e?" ":"")+n.toLowerCase()}),Vg=Ya("toLowerCase");function jg(t,n,e){t=it(t),n=Z(n);var s=n?oe(t):0;if(!n||s>=n)return t;var a=(n-s)/2;return Mr(ur(a),e)+t+Mr(or(a),e)}function td(t,n,e){t=it(t),n=Z(n);var s=n?oe(t):0;return n&&s<n?t+Mr(n-s,e):t}function nd(t,n,e){t=it(t),n=Z(n);var s=n?oe(t):0;return n&&s<n?Mr(n-s,e)+t:t}function ed(t,n,e){return e||n==null?n=0:n&&(n=+n),lf(it(t).replace(Qr,""),n||0)}function rd(t,n,e){return(e?Ot(t,n,e):n===r)?n=1:n=Z(n),Ti(it(t),n)}function id(){var t=arguments,n=it(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var sd=ge(function(t,n,e){return t+(e?"_":"")+n.toLowerCase()});function ad(t,n,e){return e&&typeof e!="number"&&Ot(t,n,e)&&(n=e=r),e=e===r?k:e>>>0,e?(t=it(t),t&&(typeof n=="string"||n!=null&&!Vi(n))&&(n=Jt(n),!n&&ae(t))?Hn(hn(t),0,e):t.split(n,e)):[]}var od=ge(function(t,n,e){return t+(e?" ":"")+ns(n)});function ud(t,n,e){return t=it(t),e=e==null?0:Qn(Z(e),0,t.length),n=Jt(n),t.slice(e,e+n.length)==n}function ld(t,n,e){var s=u.templateSettings;e&&Ot(t,n,e)&&(n=r),t=it(t),n=kr({},n,s,eo);var a=kr({},n.imports,s.imports,eo),l=xt(a),h=hi(a,l),d,w,A=0,I=n.interpolate||Ke,P="__p += '",E=gi((n.escape||Ke).source+"|"+I.source+"|"+(I===Ss?$u:Ke).source+"|"+(n.evaluate||Ke).source+"|$","g"),D="//# sourceURL="+(st.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++vl+"]")+`
`;t.replace(E,function($,V,tt,Xt,Dt,Qt){return tt||(tt=Xt),P+=t.slice(A,Qt).replace(Ju,Nl),V&&(d=!0,P+=`' +
__e(`+V+`) +
'`),Dt&&(w=!0,P+=`';
`+Dt+`;
__p += '`),tt&&(P+=`' +
((__t = (`+tt+`)) == null ? '' : __t) +
'`),A=Qt+$.length,$}),P+=`';
`;var U=st.call(n,"variable")&&n.variable;if(!U)P=`with (obj) {
`+P+`
}
`;else if(Bu.test(U))throw new H(_);P=(w?P.replace(bu,""):P).replace(Su,"$1").replace(xu,"$1;"),P="function("+(U||"obj")+`) {
`+(U?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(w?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+P+`return __p
}`;var J=Yo(function(){return rt(l,D+"return "+P).apply(r,h)});if(J.source=P,Qi(J))throw J;return J}function fd(t){return it(t).toLowerCase()}function cd(t){return it(t).toUpperCase()}function hd(t,n,e){if(t=it(t),t&&(e||n===r))return ra(t);if(!t||!(n=Jt(n)))return t;var s=hn(t),a=hn(n),l=ia(s,a),h=sa(s,a)+1;return Hn(s,l,h).join("")}function pd(t,n,e){if(t=it(t),t&&(e||n===r))return t.slice(0,oa(t)+1);if(!t||!(n=Jt(n)))return t;var s=hn(t),a=sa(s,hn(n))+1;return Hn(s,0,a).join("")}function gd(t,n,e){if(t=it(t),t&&(e||n===r))return t.replace(Qr,"");if(!t||!(n=Jt(n)))return t;var s=hn(t),a=ia(s,hn(n));return Hn(s,a).join("")}function dd(t,n){var e=Ht,s=me;if(dt(n)){var a="separator"in n?n.separator:a;e="length"in n?Z(n.length):e,s="omission"in n?Jt(n.omission):s}t=it(t);var l=t.length;if(ae(t)){var h=hn(t);l=h.length}if(e>=l)return t;var d=e-oe(s);if(d<1)return s;var w=h?Hn(h,0,d).join(""):t.slice(0,d);if(a===r)return w+s;if(h&&(d+=w.length-d),Vi(a)){if(t.slice(d).search(a)){var A,I=w;for(a.global||(a=gi(a.source,it(xs.exec(a))+"g")),a.lastIndex=0;A=a.exec(I);)var P=A.index;w=w.slice(0,P===r?d:P)}}else if(t.indexOf(Jt(a),d)!=d){var E=w.lastIndexOf(a);E>-1&&(w=w.slice(0,E))}return w+s}function _d(t){return t=it(t),t&&Au.test(t)?t.replace(Cs,Hl):t}var vd=ge(function(t,n,e){return t+(e?" ":"")+n.toUpperCase()}),ns=Ya("toUpperCase");function Jo(t,n,e){return t=it(t),n=e?r:n,n===r?Bl(t)?Zl(t):Fl(t):t.match(n)||[]}var Yo=Y(function(t,n){try{return Kt(t,r,n)}catch(e){return Qi(e)?e:new H(e)}}),md=Tn(function(t,n){return en(n,function(e){e=Cn(e),In(t,e,Yi(t[e],t))}),t});function wd(t){var n=t==null?0:t.length,e=B();return t=n?gt(t,function(s){if(typeof s[1]!="function")throw new rn(g);return[e(s[0]),s[1]]}):[],Y(function(s){for(var a=-1;++a<n;){var l=t[a];if(Kt(l[0],this,s))return Kt(l[1],this,s)}})}function yd(t){return qf(an(t,m))}function es(t){return function(){return t}}function Md(t,n){return t==null||t!==t?n:t}var Cd=Qa(),bd=Qa(!0);function zt(t){return t}function rs(t){return Ia(typeof t=="function"?t:an(t,m))}function Sd(t){return Ta(an(t,m))}function xd(t,n){return Fa(t,an(n,m))}var Ad=Y(function(t,n){return function(e){return Fe(e,t,n)}}),Id=Y(function(t,n){return function(e){return Fe(t,e,n)}});function is(t,n,e){var s=xt(n),a=gr(n,s);e==null&&!(dt(n)&&(a.length||!s.length))&&(e=n,n=t,t=this,a=gr(n,xt(n)));var l=!(dt(e)&&"chain"in e)||!!e.chain,h=En(t);return en(a,function(d){var w=n[d];t[d]=w,h&&(t.prototype[d]=function(){var A=this.__chain__;if(l||A){var I=t(this.__wrapped__),P=I.__actions__=Bt(this.__actions__);return P.push({func:w,args:arguments,thisArg:t}),I.__chain__=A,I}return w.apply(t,Wn([this.value()],arguments))})}),t}function Pd(){return Pt._===this&&(Pt._=jl),this}function ss(){}function Td(t){return t=Z(t),Y(function(n){return Ea(n,t)})}var Fd=Di(gt),Ed=Di(Vs),Rd=Di(oi);function Xo(t){return Gi(t)?ui(Cn(t)):uc(t)}function kd(t){return function(n){return t==null?r:Vn(t,n)}}var Ld=ja(),Od=ja(!0);function as(){return[]}function os(){return!1}function Dd(){return{}}function Nd(){return""}function Wd(){return!0}function Bd(t,n){if(t=Z(t),t<1||t>vn)return[];var e=k,s=Ft(t,k);n=B(n),t-=k;for(var a=ci(s,n);++e<t;)n(e);return a}function Ud(t){return q(t)?gt(t,Cn):Yt(t)?[t]:Bt(_o(it(t)))}function $d(t){var n=++Ql;return it(t)+n}var zd=yr(function(t,n){return t+n},0),Gd=Ni("ceil"),Hd=yr(function(t,n){return t/n},1),qd=Ni("floor");function Kd(t){return t&&t.length?pr(t,zt,Ci):r}function Zd(t,n){return t&&t.length?pr(t,B(n,2),Ci):r}function Jd(t){return na(t,zt)}function Yd(t,n){return na(t,B(n,2))}function Xd(t){return t&&t.length?pr(t,zt,Ai):r}function Qd(t,n){return t&&t.length?pr(t,B(n,2),Ai):r}var Vd=yr(function(t,n){return t*n},1),jd=Ni("round"),t0=yr(function(t,n){return t-n},0);function n0(t){return t&&t.length?fi(t,zt):0}function e0(t,n){return t&&t.length?fi(t,B(n,2)):0}return u.after=Sp,u.ary=Io,u.assign=cg,u.assignIn=$o,u.assignInWith=kr,u.assignWith=hg,u.at=pg,u.before=Po,u.bind=Yi,u.bindAll=md,u.bindKey=To,u.castArray=Dp,u.chain=So,u.chunk=qc,u.compact=Kc,u.concat=Zc,u.cond=wd,u.conforms=yd,u.constant=es,u.countBy=np,u.create=gg,u.curry=Fo,u.curryRight=Eo,u.debounce=Ro,u.defaults=dg,u.defaultsDeep=_g,u.defer=xp,u.delay=Ap,u.difference=Jc,u.differenceBy=Yc,u.differenceWith=Xc,u.drop=Qc,u.dropRight=Vc,u.dropRightWhile=jc,u.dropWhile=th,u.fill=nh,u.filter=rp,u.flatMap=ap,u.flatMapDeep=op,u.flatMapDepth=up,u.flatten=yo,u.flattenDeep=eh,u.flattenDepth=rh,u.flip=Ip,u.flow=Cd,u.flowRight=bd,u.fromPairs=ih,u.functions=bg,u.functionsIn=Sg,u.groupBy=lp,u.initial=ah,u.intersection=oh,u.intersectionBy=uh,u.intersectionWith=lh,u.invert=Ag,u.invertBy=Ig,u.invokeMap=cp,u.iteratee=rs,u.keyBy=hp,u.keys=xt,u.keysIn=$t,u.map=Ir,u.mapKeys=Tg,u.mapValues=Fg,u.matches=Sd,u.matchesProperty=xd,u.memoize=Tr,u.merge=Eg,u.mergeWith=zo,u.method=Ad,u.methodOf=Id,u.mixin=is,u.negate=Fr,u.nthArg=Td,u.omit=Rg,u.omitBy=kg,u.once=Pp,u.orderBy=pp,u.over=Fd,u.overArgs=Tp,u.overEvery=Ed,u.overSome=Rd,u.partial=Xi,u.partialRight=ko,u.partition=gp,u.pick=Lg,u.pickBy=Go,u.property=Xo,u.propertyOf=kd,u.pull=ph,u.pullAll=Co,u.pullAllBy=gh,u.pullAllWith=dh,u.pullAt=_h,u.range=Ld,u.rangeRight=Od,u.rearg=Fp,u.reject=vp,u.remove=vh,u.rest=Ep,u.reverse=Zi,u.sampleSize=wp,u.set=Dg,u.setWith=Ng,u.shuffle=yp,u.slice=mh,u.sortBy=bp,u.sortedUniq=xh,u.sortedUniqBy=Ah,u.split=ad,u.spread=Rp,u.tail=Ih,u.take=Ph,u.takeRight=Th,u.takeRightWhile=Fh,u.takeWhile=Eh,u.tap=Kh,u.throttle=kp,u.thru=Ar,u.toArray=Wo,u.toPairs=Ho,u.toPairsIn=qo,u.toPath=Ud,u.toPlainObject=Uo,u.transform=Wg,u.unary=Lp,u.union=Rh,u.unionBy=kh,u.unionWith=Lh,u.uniq=Oh,u.uniqBy=Dh,u.uniqWith=Nh,u.unset=Bg,u.unzip=Ji,u.unzipWith=bo,u.update=Ug,u.updateWith=$g,u.values=ve,u.valuesIn=zg,u.without=Wh,u.words=Jo,u.wrap=Op,u.xor=Bh,u.xorBy=Uh,u.xorWith=$h,u.zip=zh,u.zipObject=Gh,u.zipObjectDeep=Hh,u.zipWith=qh,u.entries=Ho,u.entriesIn=qo,u.extend=$o,u.extendWith=kr,is(u,u),u.add=zd,u.attempt=Yo,u.camelCase=Kg,u.capitalize=Ko,u.ceil=Gd,u.clamp=Gg,u.clone=Np,u.cloneDeep=Bp,u.cloneDeepWith=Up,u.cloneWith=Wp,u.conformsTo=$p,u.deburr=Zo,u.defaultTo=Md,u.divide=Hd,u.endsWith=Zg,u.eq=gn,u.escape=Jg,u.escapeRegExp=Yg,u.every=ep,u.find=ip,u.findIndex=mo,u.findKey=vg,u.findLast=sp,u.findLastIndex=wo,u.findLastKey=mg,u.floor=qd,u.forEach=xo,u.forEachRight=Ao,u.forIn=wg,u.forInRight=yg,u.forOwn=Mg,u.forOwnRight=Cg,u.get=ji,u.gt=zp,u.gte=Gp,u.has=xg,u.hasIn=ts,u.head=Mo,u.identity=zt,u.includes=fp,u.indexOf=sh,u.inRange=Hg,u.invoke=Pg,u.isArguments=ne,u.isArray=q,u.isArrayBuffer=Hp,u.isArrayLike=Ut,u.isArrayLikeObject=mt,u.isBoolean=qp,u.isBuffer=qn,u.isDate=Kp,u.isElement=Zp,u.isEmpty=Jp,u.isEqual=Yp,u.isEqualWith=Xp,u.isError=Qi,u.isFinite=Qp,u.isFunction=En,u.isInteger=Lo,u.isLength=Er,u.isMap=Oo,u.isMatch=Vp,u.isMatchWith=jp,u.isNaN=tg,u.isNative=ng,u.isNil=rg,u.isNull=eg,u.isNumber=Do,u.isObject=dt,u.isObjectLike=vt,u.isPlainObject=De,u.isRegExp=Vi,u.isSafeInteger=ig,u.isSet=No,u.isString=Rr,u.isSymbol=Yt,u.isTypedArray=_e,u.isUndefined=sg,u.isWeakMap=ag,u.isWeakSet=og,u.join=fh,u.kebabCase=Xg,u.last=un,u.lastIndexOf=ch,u.lowerCase=Qg,u.lowerFirst=Vg,u.lt=ug,u.lte=lg,u.max=Kd,u.maxBy=Zd,u.mean=Jd,u.meanBy=Yd,u.min=Xd,u.minBy=Qd,u.stubArray=as,u.stubFalse=os,u.stubObject=Dd,u.stubString=Nd,u.stubTrue=Wd,u.multiply=Vd,u.nth=hh,u.noConflict=Pd,u.noop=ss,u.now=Pr,u.pad=jg,u.padEnd=td,u.padStart=nd,u.parseInt=ed,u.random=qg,u.reduce=dp,u.reduceRight=_p,u.repeat=rd,u.replace=id,u.result=Og,u.round=jd,u.runInContext=v,u.sample=mp,u.size=Mp,u.snakeCase=sd,u.some=Cp,u.sortedIndex=wh,u.sortedIndexBy=yh,u.sortedIndexOf=Mh,u.sortedLastIndex=Ch,u.sortedLastIndexBy=bh,u.sortedLastIndexOf=Sh,u.startCase=od,u.startsWith=ud,u.subtract=t0,u.sum=n0,u.sumBy=e0,u.template=ld,u.times=Bd,u.toFinite=Rn,u.toInteger=Z,u.toLength=Bo,u.toLower=fd,u.toNumber=ln,u.toSafeInteger=fg,u.toString=it,u.toUpper=cd,u.trim=hd,u.trimEnd=pd,u.trimStart=gd,u.truncate=dd,u.unescape=_d,u.uniqueId=$d,u.upperCase=vd,u.upperFirst=ns,u.each=xo,u.eachRight=Ao,u.first=Mo,is(u,function(){var t={};return yn(u,function(n,e){st.call(u.prototype,e)||(t[e]=n)}),t}(),{chain:!1}),u.VERSION=o,en(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){u[t].placeholder=u}),en(["drop","take"],function(t,n){j.prototype[t]=function(e){e=e===r?1:bt(Z(e),0);var s=this.__filtered__&&!n?new j(this):this.clone();return s.__filtered__?s.__takeCount__=Ft(e,s.__takeCount__):s.__views__.push({size:Ft(e,k),type:t+(s.__dir__<0?"Right":"")}),s},j.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),en(["filter","map","takeWhile"],function(t,n){var e=n+1,s=e==we||e==Ur;j.prototype[t]=function(a){var l=this.clone();return l.__iteratees__.push({iteratee:B(a,3),type:e}),l.__filtered__=l.__filtered__||s,l}}),en(["head","last"],function(t,n){var e="take"+(n?"Right":"");j.prototype[t]=function(){return this[e](1).value()[0]}}),en(["initial","tail"],function(t,n){var e="drop"+(n?"":"Right");j.prototype[t]=function(){return this.__filtered__?new j(this):this[e](1)}}),j.prototype.compact=function(){return this.filter(zt)},j.prototype.find=function(t){return this.filter(t).head()},j.prototype.findLast=function(t){return this.reverse().find(t)},j.prototype.invokeMap=Y(function(t,n){return typeof t=="function"?new j(this):this.map(function(e){return Fe(e,t,n)})}),j.prototype.reject=function(t){return this.filter(Fr(B(t)))},j.prototype.slice=function(t,n){t=Z(t);var e=this;return e.__filtered__&&(t>0||n<0)?new j(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==r&&(n=Z(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},j.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},j.prototype.toArray=function(){return this.take(k)},yn(j.prototype,function(t,n){var e=/^(?:filter|find|map|reject)|While$/.test(n),s=/^(?:head|last)$/.test(n),a=u[s?"take"+(n=="last"?"Right":""):n],l=s||/^find/.test(n);a&&(u.prototype[n]=function(){var h=this.__wrapped__,d=s?[1]:arguments,w=h instanceof j,A=d[0],I=w||q(h),P=function(V){var tt=a.apply(u,Wn([V],d));return s&&E?tt[0]:tt};I&&e&&typeof A=="function"&&A.length!=1&&(w=I=!1);var E=this.__chain__,D=!!this.__actions__.length,U=l&&!E,J=w&&!D;if(!l&&I){h=J?h:new j(this);var $=t.apply(h,d);return $.__actions__.push({func:Ar,args:[P],thisArg:r}),new sn($,E)}return U&&J?t.apply(this,d):($=this.thru(P),U?s?$.value()[0]:$.value():$)})}),en(["pop","push","shift","sort","splice","unshift"],function(t){var n=Ve[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",s=/^(?:pop|shift)$/.test(t);u.prototype[t]=function(){var a=arguments;if(s&&!this.__chain__){var l=this.value();return n.apply(q(l)?l:[],a)}return this[e](function(h){return n.apply(q(h)?h:[],a)})}}),yn(j.prototype,function(t,n){var e=u[n];if(e){var s=e.name+"";st.call(ce,s)||(ce[s]=[]),ce[s].push({name:n,func:e})}}),ce[wr(r,K).name]=[{name:"wrapper",func:r}],j.prototype.clone=_f,j.prototype.reverse=vf,j.prototype.value=mf,u.prototype.at=Zh,u.prototype.chain=Jh,u.prototype.commit=Yh,u.prototype.next=Xh,u.prototype.plant=Vh,u.prototype.reverse=jh,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=tp,u.prototype.first=u.prototype.head,be&&(u.prototype[be]=Qh),u},ue=Jl();Zn?((Zn.exports=ue)._=ue,ri._=ue):Pt._=ue}).call(Ne)})(Dr,Dr.exports);var au=Dr.exports;const W=su(au);var hs={exports:{}},us,Vo;function s0(){if(Vo)return us;Vo=1;var c=1e3,i=c*60,r=i*60,o=r*24,f=o*7,p=o*365.25;us=function(b,m){m=m||{};var F=typeof b;if(F==="string"&&b.length>0)return g(b);if(F==="number"&&isFinite(b))return m.long?M(b):_(b);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(b))};function g(b){if(b=String(b),!(b.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(b);if(m){var F=parseFloat(m[1]),O=(m[2]||"ms").toLowerCase();switch(O){case"years":case"year":case"yrs":case"yr":case"y":return F*p;case"weeks":case"week":case"w":return F*f;case"days":case"day":case"d":return F*o;case"hours":case"hour":case"hrs":case"hr":case"h":return F*r;case"minutes":case"minute":case"mins":case"min":case"m":return F*i;case"seconds":case"second":case"secs":case"sec":case"s":return F*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return F;default:return}}}}function _(b){var m=Math.abs(b);return m>=o?Math.round(b/o)+"d":m>=r?Math.round(b/r)+"h":m>=i?Math.round(b/i)+"m":m>=c?Math.round(b/c)+"s":b+"ms"}function M(b){var m=Math.abs(b);return m>=o?C(b,m,o,"day"):m>=r?C(b,m,r,"hour"):m>=i?C(b,m,i,"minute"):m>=c?C(b,m,c,"second"):b+" ms"}function C(b,m,F,O){var R=m>=F*1.5;return Math.round(b/F)+" "+O+(R?"s":"")}return us}function a0(c){r.debug=r,r.default=r,r.coerce=M,r.disable=p,r.enable=f,r.enabled=g,r.humanize=s0(),r.destroy=C,Object.keys(c).forEach(b=>{r[b]=c[b]}),r.names=[],r.skips=[],r.formatters={};function i(b){let m=0;for(let F=0;F<b.length;F++)m=(m<<5)-m+b.charCodeAt(F),m|=0;return r.colors[Math.abs(m)%r.colors.length]}r.selectColor=i;function r(b){let m,F=null,O,R;function T(...N){if(!T.enabled)return;const K=T,X=Number(new Date),Q=X-(m||X);K.diff=Q,K.prev=m,K.curr=X,m=X,N[0]=r.coerce(N[0]),typeof N[0]!="string"&&N.unshift("%O");let et=0;N[0]=N[0].replace(/%([a-zA-Z%])/g,(At,It)=>{if(At==="%%")return"%";et++;const Gt=r.formatters[It];if(typeof Gt=="function"){const jt=N[et];At=Gt.call(K,jt),N.splice(et,1),et--}return At}),r.formatArgs.call(K,N),(K.log||r.log).apply(K,N)}return T.namespace=b,T.useColors=r.useColors(),T.color=r.selectColor(b),T.extend=o,T.destroy=r.destroy,Object.defineProperty(T,"enabled",{enumerable:!0,configurable:!1,get:()=>F!==null?F:(O!==r.namespaces&&(O=r.namespaces,R=r.enabled(b)),R),set:N=>{F=N}}),typeof r.init=="function"&&r.init(T),T}function o(b,m){const F=r(this.namespace+(typeof m>"u"?":":m)+b);return F.log=this.log,F}function f(b){r.save(b),r.namespaces=b,r.names=[],r.skips=[];let m;const F=(typeof b=="string"?b:"").split(/[\s,]+/),O=F.length;for(m=0;m<O;m++)F[m]&&(b=F[m].replace(/\*/g,".*?"),b[0]==="-"?r.skips.push(new RegExp("^"+b.slice(1)+"$")):r.names.push(new RegExp("^"+b+"$")))}function p(){const b=[...r.names.map(_),...r.skips.map(_).map(m=>"-"+m)].join(",");return r.enable(""),b}function g(b){if(b[b.length-1]==="*")return!0;let m,F;for(m=0,F=r.skips.length;m<F;m++)if(r.skips[m].test(b))return!1;for(m=0,F=r.names.length;m<F;m++)if(r.names[m].test(b))return!0;return!1}function _(b){return b.toString().substring(2,b.toString().length-2).replace(/\.\*\?$/,"*")}function M(b){return b instanceof Error?b.stack||b.message:b}function C(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var o0=a0;(function(c,i){i.formatArgs=o,i.save=f,i.load=p,i.useColors=r,i.storage=g(),i.destroy=(()=>{let M=!1;return()=>{M||(M=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(M){if(M[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+M[0]+(this.useColors?"%c ":" ")+"+"+c.exports.humanize(this.diff),!this.useColors)return;const C="color: "+this.color;M.splice(1,0,C,"color: inherit");let b=0,m=0;M[0].replace(/%[a-zA-Z%]/g,F=>{F!=="%%"&&(b++,F==="%c"&&(m=b))}),M.splice(m,0,C)}i.log=console.debug||console.log||(()=>{});function f(M){try{M?i.storage.setItem("debug",M):i.storage.removeItem("debug")}catch{}}function p(){let M;try{M=i.storage.getItem("debug")}catch{}return!M&&typeof process<"u"&&"env"in process&&(M=process.env.DEBUG),M}function g(){try{return localStorage}catch{}}c.exports=o0(i);const{formatters:_}=c.exports;_.j=function(M){try{return JSON.stringify(M)}catch(C){return"[UnexpectedJSONParseError]: "+C.message}}})(hs,hs.exports);var u0=hs.exports;const l0=su(u0),ls={};function Kn(c){if(!ls[c]){const i=l0("ultraPacer:core");i(`loading debug for namespace "${c}"`),ls[c]=i.extend(c)}return ls[c]}function fn(c,i=0){return Math.round(c*10**i)/10**i}function Be(c,i,r,o,f){return r+(f-c)/(i-c)*(o-r)}function f0(c,i,r){let o=0,f=0;const p=[];for(o=0;o<r.length;o++)if(r[o]<c[f])p.push(i[f]);else{for(;f<c.length-1&&c[f+1]<=r[o];)f++;f===c.length-1||r[o]===c[f]?p.push(i[f]):p.push(Be(c[f],c[f+1],i[f],i[f+1],r[o]))}return p}function c0(c){let i,r,o,f,p=0,g=0,_=0,M=0,C=0;for(i=0;i<c.length;i++)r=c[i][0],o=c[i][1],f=c[i][2],C+=f,p+=f*r,_+=f*(r*r),g+=f*o,M+=f*(r*o);const b=(g*_-p*M)/(C*_-p*p);return[(C*M-p*g)/(C*_-p*p),b]}function h0(c,i,r,o){let f=0,p=0;const g=[];return r.forEach(_=>{for(;c[f]<_-o;)f++;for(f>0&&c[f]>=_&&f--;p<c.length-1&&c[p+1]<=_+o;)p++;p<c.length-1&&c[p]<=_&&p++;const M=Math.max(o,Math.abs(_-c[f])+.001,Math.abs(_-c[p])+.001),C=[];let b=0;for(let m=f;m<=p;m++)b=(1-(Math.abs(_-c[m])/M)**3)**3,C.push([c[m],i[m],b]);g.push(c0(C))}),g}function ou(c,i,r){return fn(c,r)<fn(i,r)}function Ue(c,i,r){return fn(c,r)<=fn(i,r)}function ms(c,i,r){return fn(c,r)>=fn(i,r)}function Wr(c,i,r){return fn(c,r)===fn(i,r)}class $e extends Error{constructor(r,o){super(r);y(this,"field");this.name="MissingDataError",this.field=o}}class On{constructor(i){y(this,"_altitude",1);y(this,"_grade",1);y(this,"_terrain",1);y(this,"_heat",1);y(this,"_dark",1);y(this,"_fatigue",1);y(this,"_strategy",1);y(this,"_combined");Object.assign(this,i)}init(i){return this._altitude=i,this._grade=i,this._terrain=i,this._heat=i,this._dark=i,this._fatigue=i,this._strategy=i,this}get altitude(){return this._altitude}set altitude(i){this._altitude=i,delete this._combined}get grade(){return this._grade}set grade(i){this._grade=i,delete this._combined}get terrain(){return this._terrain}set terrain(i){this._terrain=i,delete this._combined}get heat(){return this._heat}set heat(i){this._heat=i,delete this._combined}get dark(){return this._dark}set dark(i){this._dark=i,delete this._combined}get fatigue(){return this._fatigue}set fatigue(i){this._fatigue=i,delete this._combined}get strategy(){return this._strategy}set strategy(i){this._strategy=i,delete this._combined}get combined(){return this._combined===void 0&&(this._combined=this._altitude*this._grade*this._terrain*this._heat*this._dark*this._fatigue*this._strategy),this._combined}get(i){switch(i){case"altitude":return this.altitude;case"grade":return this.grade;case"terrain":return this.terrain;case"heat":return this.heat;case"dark":return this.dark;case"fatigue":return this.fatigue;case"strategy":return this.strategy;default:throw new Error(`${i} is not a valid factor`)}}applyEach(i,r){this._altitude=i(this._altitude,r.altitude),this._grade=i(this._grade,r.grade),this._terrain=i(this._terrain,r.terrain),this._heat=i(this._heat,r.heat),this._dark=i(this._dark,r.dark),this._fatigue=i(this._fatigue,r.fatigue),this._strategy=i(this._strategy,r.strategy)}scaleEach(i){return this._altitude*=i,this._grade*=i,this._terrain*=i,this._heat*=i,this._dark*=i,this._fatigue*=i,this._strategy*=i,delete this._combined,this}}function ws(c){const i=new On().init(0);return c.forEach(({factors:r,dist:o})=>{i.applyEach((f,p)=>f+o*p,r)}),i.scaleEach(1/au.sumBy(c,"dist")),i}class ps{constructor(i,r,o){y(this,"factors",new On);y(this,"point");y(this,"course");y(this,"loop");Object.defineProperty(this,"course",{writable:!0}),this.point=r,this.course=i,this.loop=o}get lat(){return this.point.lat}get lon(){return this.point.lon}get alt(){return this.point.alt}get latlon(){return this.point.latlon}get grade(){return this.point.grade*(this.point.grade>0?this.course.gainScale:this.course.lossScale)}get loc(){let i=this.point.loc*this.course.distScale;return this.loop&&(i+=this.course.loopDist*this.loop),i}}const p0={rate:6,span:1e3,th:750};function g0(c,i){(i===null||typeof i>"u")&&(i=p0);let r=0;return Array.isArray(c)?r=(c[0]+c[1])/2:r=c,r<=i.th?1:(1+i.rate/i.span/100)**(r-i.th)}const jo={baseline:0,terrainScale:1};function d0(c,i){function r(o){return o<c.noon?o+86400:o}return i>=c.sunrise&&i<=c.sunset?0:!isNaN(c.dawn)&&!isNaN(c.dusk)&&(i<=c.dawn||i>=c.dusk)?1:r(i)>=r(c.nadir)?Be(r(isNaN(c.dawn)?c.nadir:c.dawn),r(c.sunrise),1,0,r(i)):Be(r(c.sunset),r(isNaN(c.dusk)?c.nadir:c.dusk),0,1,r(i))}function _0(c,i,r,o=jo){if(i===1||c>=r.sunrise&&c<=r.sunset)return 1;(o===null||typeof o>"u")&&(o=jo);const f=r.nadirAltitude<-6?1:-(r.nadirAltitude/6),p=(o.terrainScale*(i-1)+o.baseline)*f,g=d0(r,c);return 1+p*g}const v0={a:.0021,b:.034,lower:{lim:-22,m:-.0584,b:-.0164},upper:{lim:16,m:.1012,b:.4624}};function m0(c,i){return(i===null||typeof i>"u")&&(i=v0),c<i.lower.lim?i.lower.m*c+i.lower.b:c>i.upper.lim?i.upper.m*c+i.upper.b:i.a*c**2+i.b*c+1}function w0(c,i){if(!i)return 1;if(c.tod===void 0)throw new Error("tod is undefined");const r=c.tod;let o=1;if(r>i.start&&r<i.stop){const f=(r-i.start)/(i.stop-i.start)*Math.PI;o+=(i.max-i.baseline)*Math.sin(f)/100}return o+=i.baseline/100,o}function y0(c,i){const r=W.findLast(i.terrainFactors,o=>Ue(o.start,c.loc,4));return r?r.value/100+1:1}const M0=["altitude","grade","terrain","heat","dark","fatigue","strategy"];function C0(c,i){let r=0,o=0;return c.forEach((f,p)=>{const g=p===c.length-1?i:c[p+1].onset,_=f.type==="linear"?f.value/2:f.value;o+=(r+_)*(g-f.onset),r+=f.value}),o/i}function b0(c){return c<30?2:c<60?5:c<90?10:c<120?15:20}function S0(c,i,r){let o=-C0(i,r);return i.forEach((f,p)=>{if(c>=f.onset){if(f.type==="step")o+=f.value;else if(f.type==="linear"){const g=p===i.length-1?r:i[p+1].onset;c>g?o+=f.value:o+=f.value*(c-f.onset)/(g-f.onset)}}}),o}class tu{constructor(i,r){y(this,"plan");y(this,"values");this.plan=i,this.values=r?W.cloneDeep(r):[{onset:0,value:b0(this.plan.course.dist),type:"linear"}]}at(i){return 1+S0(i,this.values,this.plan.course.dist)/100}addValue(i){const r=this.values.findIndex(o=>o.onset>=i.onset);r>=0?this.values.splice(r,0,i):this.values.push(i)}}function nu(c,i){return(c-1)*i+1}function uu(c,i){c.factors||(c.factors=new On),Object.assign(c.factors,{grade:m0(c.grade),altitude:g0(c.alt),terrain:y0(c,i)})}function gs(c,i){if(c.factors||(c.factors=new On),uu(c,i.course),i){if(c.factors===void 0)throw new Error("no factors");c.factors.strategy=i.strategy.at(c.loc),Object.assign(c.factors,{heat:i.heatModel?w0(c,i.heatModel):1,dark:i.event.sun?_0(c.tod,c.factors.terrain,i.event.sun):1})}c.factors.altitude=nu(c.factors.altitude,i.scales.altitude),c.factors.dark=nu(c.factors.dark,i.scales.dark)}function lu(c){switch(c){case"kilometers":return 1;case"miles":return .621371;default:throw new Error("Invalid distance unit")}}function fu(c,i,r){const o=c.filter((p,g)=>g>=c.findIndex(_=>_===i)&&g<=c.findIndex(_=>_===r)),f=o.map((p,g)=>({factors:p.factors,dist:g===o.length-1?0:o[g+1].loc-o[g].loc}));return f.pop(),ws(f)}class cu{constructor(i){y(this,"point1");y(this,"point2");y(this,"gain");y(this,"loss");y(this,"grade");y(this,"waypoint");y(this,"_name");this.point1=i.point1,this.point2=i.point2,this.gain=i.gain,this.loss=i.loss,this.grade=i.grade,i.name&&(this._name=i.name)}get name(){var i;return this._name||((i=this.waypoint)==null?void 0:i.name)||void 0}get start(){return this.point1.loc}get len(){return this.point2.loc-this.point1.loc}get dist(){return this.len}get end(){return this.point2.loc}get alt(){return this.point2.alt}}class hu extends cu{constructor(r,o){super(o);y(this,"_course");y(this,"point1");y(this,"point2");y(this,"_factors");this._course=r,this.point1=o.point1,this.point2=o.point2}get factors(){return this._factors||(this._factors=fu(this._course.points,this.point1,this.point2))}}class pu extends cu{constructor(r,o){super(o);y(this,"_plan");y(this,"point1");y(this,"point2");y(this,"_factors");this._plan=r,this.point1=o.point1,this.point2=o.point2}get pace(){if(W.isNumber(this.time))return this.time?this.time/this.len:0}get delay(){if(!(!W.isNumber(this.point1.elapsed)||!W.isNumber(this.point2.elapsed)||!W.isNumber(this.point1.time)||!W.isNumber(this.point2.time)))return this.point2.elapsed-this.point1.elapsed-(this.point2.time-this.point1.time)}get elapsed(){return this.point2.elapsed}get time(){if(!(!W.isNumber(this.point1.time)||!W.isNumber(this.point2.time)))return this.point2.time-this.point1.time}get tod(){return this.point2.tod}set delay(r){}set pace(r){}set elapsed(r){}set time(r){}set tod(r){}get factors(){return this._factors||(this._factors=fu(this._plan.points,this.point1,this.point2))}}const fs=Kn("CourseSplits");class x0{constructor(i){y(this,"_segments");y(this,"_miles");y(this,"_kilometers");y(this,"course");this.course=i}get segments(){return this._segments||(this._segments=this.createSegments()),this._segments}set segments(i){this._segments=i}get miles(){var i;return(i=this._miles)!=null&&i.length||(this._miles=this.createSplits("miles")),this._miles}set miles(i){this._miles=i}get kilometers(){var i;return(i=this._kilometers)!=null&&i.length||(this._kilometers=this.createSplits("kilometers")),this._kilometers}set kilometers(i){this._kilometers=i}createSegments(){fs("createSegments");const i=this.course.waypoints.filter(o=>o.tier<3).sort((o,f)=>o.loc-f.loc),r=this.calcSegments(this.course.locationsToBreaks(i.map(o=>o.loc)));if(!r.length)throw new Error("createSegments result is empty");return r.forEach((o,f)=>{o.waypoint=i[f+1]}),r}createSplits(i){fs(`createSplits:${i}`);const r=lu(i),o=W.range(this.course.dist*r).map(p=>p/r);this.course.dist-o[o.length-1]>1e-4&&o.push(this.course.dist);const f=this.calcSegments(this.course.locationsToBreaks(o));if(!f.length)throw new Error("createSplits result is empty");return f}calcSegments(i){var F;const r=fs.extend("calcSegments");r("exec");const o=this.course,f=o.points;if(!(f!=null&&f.length))throw r("Course points are not defined."),new $e("Course points are not defined.","points");const p=[],g=[];let _,M,C=o.points[0],b;for(_=0,M=i.length;_<M;_++){const O=i[_];b&&Wr((F=i[_-1])==null?void 0:F.end,O.start,4)?C=b:C=o.getPoint(O.start),b=o.getPoint(O.end);const R=O.end-O.start,T=new hu(this.course,{gain:0,loss:0,grade:R>0?(b.alt-C.alt)/R/10*(b.alt-C.alt>0?o.gainScale:o.lossScale):0,point1:C,point2:b}),N=new On().init(0);p.push(T),g.push(N)}const m=(O,R,T,N)=>{const K=T.alt-R.alt;O[K>0?"gain":"loss"]+=K*(K>0?o.gainScale:o.lossScale),uu(R,o);const X=T.loc-R.loc;N.applyEach((Q,et)=>Q+et*X,R.factors)};_=1;for(let O=0;O<p.length;O++){const R=p[O],T=g[O];for(;Ue(f[_].loc,R.point1.loc,4);)_++;let N=R.point1;for(;_<f.length&&Ue(f[_].loc,R.point2.loc,4);){const K=f[_];m(R,N,K,T),N=K,_++}m(R,N,R.point2,T)}return p}}var gu={};(function(c){c.parseDMS=function(r){if(typeof f=="object")throw new TypeError("geo.parseDMS - dmsStr is [DOM?] object");if(typeof r=="number"&&isFinite(r))return Number(r);var o=String(r).trim().replace(/^-/,"").replace(/[NSEW]$/i,"").split(/[^0-9.,]+/);if(o[o.length-1]==""&&o.splice(o.length-1),o=="")return NaN;switch(o.length){case 3:var f=o[0]/1+o[1]/60+o[2]/3600;break;case 2:var f=o[0]/1+o[1]/60;break;case 1:var f=o[0];break;default:return NaN}return/^-|[WS]$/i.test(r.trim())&&(f=-f),Number(f)},c.toDMS=function(r,o,f){if(typeof r=="object")throw new TypeError("geo.toDMS - deg is [DOM?] object");if(isNaN(r))return null;if(typeof o>"u"&&(o="dms"),typeof f>"u")switch(o){case"d":f=4;break;case"dm":f=2;break;case"dms":f=0;break;default:o="dms",f=0}switch(r=Math.abs(r),o){case"d":_=r.toFixed(f),_<100&&(_="0"+_),_<10&&(_="0"+_),dms=_+"°";break;case"dm":var p=(r*60).toFixed(f),_=Math.floor(p/60),M=(p%60).toFixed(f);_<100&&(_="0"+_),_<10&&(_="0"+_),M<10&&(M="0"+M),dms=_+"°"+M+"′";break;case"dms":var g=(r*3600).toFixed(f),_=Math.floor(g/3600),M=Math.floor(g/60)%60,C=(g%60).toFixed(f);_<100&&(_="0"+_),_<10&&(_="0"+_),M<10&&(M="0"+M),C<10&&(C="0"+C),dms=_+"°"+M+"′"+C+"″";break}return dms},c.toLat=function(r,o,f){var p=c.toDMS(r,o,f);return p==null?".":p.slice(1)+(r<0?"S":"N")},c.toLon=function(r,o,f){var p=c.toDMS(r,o,f);return p==null?".":p+(r<0?"W":"E")},c.toBrng=function(r,o,f){r=(Number(r)+360)%360;var p=c.toDMS(r,o,f);return p==null?".":p.replace("360","0")};var i=6371;c.latlon=function(r,o){this.lat=typeof r=="number"?r:typeof r=="string"&&r.trim()!=""?+r:NaN,this.lng=typeof o=="number"?o:typeof o=="string"&&o.trim()!=""?+o:NaN},c.latlon.prototype.distanceTo=function(r,o){typeof o>"u"&&(o=4);var f=this.distanceRadTo(r),p=i*f;return p.toPrecisionFixed(o)},c.latlon.prototype.distanceRadTo=function(r){var o=this.lat.toRad(),f=this.lng.toRad(),p=r.lat.toRad(),g=r.lng.toRad(),_=p-o,M=g-f,C=Math.sin(_/2)*Math.sin(_/2)+Math.cos(o)*Math.cos(p)*Math.sin(M/2)*Math.sin(M/2),b=2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C));return b},c.latlon.prototype.bearingTo=function(r){var o=this.bearingRadTo(r);return(o.toDeg()+360)%360},c.latlon.prototype.bearingRadTo=function(r){var o=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),g=Math.cos(o)*Math.sin(f)-Math.sin(o)*Math.cos(f)*Math.cos(p),_=Math.cos(f)*Math.sin(p),M=Math.atan2(_,g);return M},c.latlon.prototype.finalBearingTo=function(r){var o=r.lat.toRad(),f=this.lat.toRad(),p=(this.lng-r.lng).toRad(),g=Math.sin(p)*Math.cos(f),_=Math.cos(o)*Math.sin(f)-Math.sin(o)*Math.cos(f)*Math.cos(p),M=Math.atan2(g,_);return(M.toDeg()+180)%360},c.latlon.prototype.midpointTo=function(r){var o=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),g=Math.cos(f)*Math.cos(p),_=Math.cos(f)*Math.sin(p),M=this.lng.toRad(),C=Math.atan2(Math.sin(o)+Math.sin(f),Math.sqrt((Math.cos(o)+g)*(Math.cos(o)+g)+_*_)),b=M+Math.atan2(_,Math.cos(o)+g);return b=(b+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(C.toDeg(),b.toDeg())},c.midpoint=function(r){var o=0,f=0,p=0;for(var g in r){var _=r[g],M=_.lat*Math.PI/180,C=_.lng*Math.PI/180,b=Math.cos(M)*Math.cos(C),m=Math.cos(M)*Math.sin(C),F=Math.sin(M);o+=b,f+=m,p+=F}o=o/r.length,f=f/r.length,p=p/r.length;var O=Math.atan2(f,o),R=Math.sqrt(o*o+f*f),T=Math.atan2(p,R);return new c.latlon(T*180/Math.PI,O*180/Math.PI)},c.latlon.prototype.interpolate=function(r,o){var f=this.distanceRadTo(r),p=this.bearingRadTo(r),g=this.lat.toRad(),_=this.lng.toRad();r.lat.toRad(),r.lng.toRad();for(var M=Math.sin(g),C=Math.cos(g),b=[],m=0;m<o;m++){var F=1/(o-1)*m,O=f*F,R=Math.sin(O),T=Math.cos(O),N=Math.asin(M*T+C*R*Math.cos(p)),K=_+Math.atan2(Math.sin(p)*R*C,T-M*Math.sin(N)),X=N.toDeg(),Q=K.toDeg();for(X>90&&(X=90),X<-90&&(X=-90);Q>180;)Q-=360;for(;Q<=-180;)Q+=360;b.push(new c.latlon(X,Q))}return b},c.latlon.prototype.destinationPoint=function(r,o){o=typeof o=="number"?o:typeof o=="string"&&o.trim()!=""?+o:NaN,o=o/i,r=r.toRad();var f=this.lat.toRad(),p=this.lng.toRad(),g=Math.asin(Math.sin(f)*Math.cos(o)+Math.cos(f)*Math.sin(o)*Math.cos(r)),_=p+Math.atan2(Math.sin(r)*Math.sin(o)*Math.cos(f),Math.cos(o)-Math.sin(f)*Math.sin(g));return _=(_+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(g.toDeg(),_.toDeg())},c.latlon.intersection=function(r,o,f,p){o=typeof o=="number"?o:typeof o=="string"&&trim(o)!=""?+o:NaN,p=typeof p=="number"?p:typeof p=="string"&&trim(p)!=""?+p:NaN;var g=r.lat.toRad(),_=r.lng.toRad(),M=f.lat.toRad(),C=f.lng.toRad(),b=o.toRad(),m=p.toRad(),F=M-g,O=C-_,R=2*Math.asin(Math.sqrt(Math.sin(F/2)*Math.sin(F/2)+Math.cos(g)*Math.cos(M)*Math.sin(O/2)*Math.sin(O/2)));if(R==0)return null;var T=Math.acos((Math.sin(M)-Math.sin(g)*Math.cos(R))/(Math.sin(R)*Math.cos(g)));isNaN(T)&&(T=0);var N=Math.acos((Math.sin(g)-Math.sin(M)*Math.cos(R))/(Math.sin(R)*Math.cos(M)));if(Math.sin(C-_)>0)var K=T,X=2*Math.PI-N;else K=2*Math.PI-T,X=N;var Q=(b-K+Math.PI)%(2*Math.PI)-Math.PI,et=(X-m+Math.PI)%(2*Math.PI)-Math.PI;if(Math.sin(Q)==0&&Math.sin(et)==0||Math.sin(Q)*Math.sin(et)<0)return null;var St=Math.acos(-Math.cos(Q)*Math.cos(et)+Math.sin(Q)*Math.sin(et)*Math.cos(R)),At=Math.atan2(Math.sin(R)*Math.sin(Q)*Math.sin(et),Math.cos(et)+Math.cos(Q)*Math.cos(St)),It=Math.asin(Math.sin(g)*Math.cos(At)+Math.cos(g)*Math.sin(At)*Math.cos(b)),Gt=Math.atan2(Math.sin(b)*Math.sin(At)*Math.cos(g),Math.cos(At)-Math.sin(g)*Math.sin(It)),jt=_+Gt;return jt=(jt+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(It.toDeg(),jt.toDeg())},c.latlon.prototype.rhumbDistanceTo=function(r){var o=i,f=this.lat.toRad(),p=r.lat.toRad(),g=(r.lat-this.lat).toRad(),_=Math.abs(r.lng-this.lng).toRad(),M=Math.log(Math.tan(p/2+Math.PI/4)/Math.tan(f/2+Math.PI/4)),C=isFinite(g/M)?g/M:Math.cos(f);Math.abs(_)>Math.PI&&(_=_>0?-(2*Math.PI-_):2*Math.PI+_);var b=Math.sqrt(g*g+C*C*_*_)*o;return b.toPrecisionFixed(4)},c.latlon.prototype.rhumbBearingTo=function(r){var o=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),g=Math.log(Math.tan(f/2+Math.PI/4)/Math.tan(o/2+Math.PI/4));Math.abs(p)>Math.PI&&(p=p>0?-(2*Math.PI-p):2*Math.PI+p);var _=Math.atan2(p,g);return(_.toDeg()+360)%360},c.latlon.prototype.rhumbDestinationPoint=function(r,o){var f=i,p=parseFloat(o)/f,g=this.lat.toRad(),_=this.lng.toRad();r=r.toRad();var M=p*Math.cos(r);Math.abs(M)<1e-10&&(M=0);var C=g+M,b=Math.log(Math.tan(C/2+Math.PI/4)/Math.tan(g/2+Math.PI/4)),m=isFinite(M/b)?M/b:Math.cos(g),F=p*Math.sin(r)/m;Math.abs(C)>Math.PI/2&&(C=C>0?Math.PI-C:-Math.PI-C);var O=(_+F+3*Math.PI)%(2*Math.PI)-Math.PI;return new c.latlon(C.toDeg(),O.toDeg())},c.latlon.prototype.rhumbMidpointTo=function(r){var o=this.lat.toRad(),f=this.lng.toRad(),p=r.lat.toRad(),g=r.lng.toRad();Math.abs(g-f)>Math.PI&&(f+=2*Math.PI);var _=(o+p)/2,M=Math.tan(Math.PI/4+o/2),C=Math.tan(Math.PI/4+p/2),b=Math.tan(Math.PI/4+_/2),m=((g-f)*Math.log(b)+f*Math.log(C)-g*Math.log(M))/Math.log(C/M);return isFinite(m)||(m=(f+g)/2),m=(m+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(_.toDeg(),m.toDeg())},c.latlon.prototype.lat=function(r,o){return typeof r>"u"?this.lat:c.toLat(this.lat,r,o)},c.latlon.prototype.lon=function(r,o){return typeof r>"u"?this.lng:c.toLon(this.lng,r,o)},c.latlon.prototype.toString=function(r,o){return typeof r>"u"&&(r="dms"),c.toLat(this.lat,r,o)+", "+c.toLon(this.lng,r,o)},typeof Number.prototype.toRad>"u"&&(Number.prototype.toRad=function(){return this*Math.PI/180}),typeof Number.prototype.toDeg>"u"&&(Number.prototype.toDeg=function(){return this*180/Math.PI}),typeof Number.prototype.toPrecisionFixed>"u"&&(Number.prototype.toPrecisionFixed=function(r){var o=this.toPrecision(r);return o=o.replace(/(.+)e\+(.+)/,function(f,p,g){p=p.replace(/\./,"");for(var _=p.length-1;g-- >_;)p=p+"0";return p}),o=o.replace(/(.+)e-(.+)/,function(f,p,g){for(p=p.replace(/\./,"");g-- >1;)p="0"+p;return"0."+p}),o}),typeof String.prototype.trim>"u"&&(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")})})(gu);class ys{constructor(i,r,o){y(this,"alt");y(this,"lat");y(this,"lon");this.lat=i,this.lon=r,this.alt=o}get latlon(){return new gu.latlon(this.lat,this.lon)}}class du extends ys{constructor(r,o,f,p,g){super(r,o,f);y(this,"loc");y(this,"grade");this.loc=p,this.grade=g}}function _u(c,i,r){if(c.loc>i.loc&&r>c.loc||i.loc>c.loc&&r>i.loc)throw new Error("Input location must be between points");const o=Math.abs(c.loc-r),f=c.latlon.bearingTo(i.latlon),{lat:p,lng:g}=c.latlon.destinationPoint(f,o),_=c.grade,M=Be(c.loc,i.loc,c.alt,i.alt,r);return new du(p,g,M,r,_)}function A0(c,i){return(typeof c=="object"?String(c._id):c)===(typeof i=="object"?String(i._id):i)}function ds(c,i){return!!(c&&i&&A0(c.site,i.site)&&c.loop===i.loop)}class _s{constructor(i,r=1){y(this,"_data");y(this,"loop");y(this,"site");this._data={},this.site=i,this.loop=r}get course(){return this.site.course}get name(){return this.loop>=2&&this.type!=="finish"?`${this.site.name} ${this.loop}`:this.site.name}get description(){return this.site.description}get loc(){return(this.site.percent+this.loop-1)*this.course.loopDist}set loc(i){if(!W.isNumber(i))throw new Error("Wrong format for Waypoint.loc");this.type==="start"?this.site.percent=0:this.type==="finish"?this.site.percent=1:this.site.percent=i/this.course.loopDist%1}get lat(){return this.site.lat}get lon(){return this.site.lon}get alt(){return this.site.alt}get tier(){return this.site.tier||1}get type(){return this.site.type}get dropbags(){return this.site.dropbags||!1}set dropbags(i){this.site.dropbags=!!i}get crew(){return this.site.crew||!1}set crew(i){this.site.crew=!!i}get terrainFactor(){return this.site.terrainFactor}get terrainType(){return this.site.terrainType}get hasTypicalDelay(){return this.type==="aid"||this.type==="water"||this.loop>=2&&this.type==="start"}get cutoff(){var i;if(this.tier===1){const r=(i=this.site.cutoffs)==null?void 0:i.find(o=>o.loop===this.loop);if(r)return r.time}return null}set cutoff(i){var o;const r=(o=this.site.cutoffs)==null?void 0:o.findIndex(f=>f.loop===this.loop);r>=0?i?this.site.cutoffs[r].time=i:this.site.cutoffs.splice(r,1):i&&(this.site.cutoffs||(this.site.cutoffs=[]),this.site.cutoffs.push({time:i,loop:this.loop}))}matchingSegment(i){return i.find(r=>r.waypoint&&ds(this,r.waypoint))}serialize(){return{...W.pick(this,["loop","name","type","cutoff","loc","lat","lon","alt","tier","crew","dropbags","terrainType","terrainFactor"]),site:this.site._id}}}const We=Kn("models:Waypoint");class Or{constructor(i,r){y(this,"_waypoints");y(this,"_lat");y(this,"_lon");y(this,"_alt");y(this,"_data");y(this,"_id");y(this,"course");y(this,"cutoffs",[]);y(this,"name");y(this,"tier",1);y(this,"type");y(this,"terrainFactor");y(this,"terrainType");y(this,"description");y(this,"pointsIndex");y(this,"dropbags");y(this,"crew");this._data={percent:r.percent},this.course=i,this._id=r._id,this.type=r.type,this.name=r.name,r.cutoffs&&(this.cutoffs=r.cutoffs),r.tier!==void 0&&(this.tier=r.tier),r.terrainFactor!==void 0&&(this.terrainFactor=r.terrainFactor),r.terrainType!==void 0&&(this.terrainType=r.terrainType),r.description&&(this.description=r.description),this.crew=r.crew||!1,this.dropbags=r.dropbags||!1,We(`constructor: ${this.name}`)}clearCache(){We(`clearCache: ${this.name}`),delete this._waypoints,delete this._lat,delete this._lon,delete this._alt}get percent(){switch(this.type){case"start":return 0;case"finish":return 1;default:return this._data.percent}}set percent(i){this._data.percent=i}get waypoints(){return this._waypoints?this._waypoints:(We(`generating waypoints array: ${this.name}`),this.type==="finish"?this._waypoints=[new _s(this,this.course.loops)]:this._waypoints=W.range(this.course.loops).map(i=>new _s(this,i+1)),this._waypoints)}get lat(){return this._lat||this.refreshLLA(),this._lat}get lon(){return this._lon||this.refreshLLA(),this._lon}get alt(){return this._alt||this.refreshLLA(),this._alt}refreshLLA(){var f,p,g;if(We("refreshLLA"),!((g=(p=(f=this.course)==null?void 0:f.track)==null?void 0:p.points)!=null&&g.length))throw new $e("No track points defined","points");let i,r,o;this.type==="start"?{lat:i,lon:r,alt:o}=this.course.track.points[0]:this.type==="finish"?{lat:i,lon:r,alt:o}=this.course.track.points[this.course.track.points.length-1]:{lat:i,lon:r,alt:o}=this.course.track.getLLA(this.percent*this.course.track.dist),this._lat=i,this._lon=r,this._alt=o,this.course.clearCache(1)}serialize(){We(`serialize: ${this.name}`);const i=Object.keys(this);return i.push("percent"),W.pick(this,i)}}const Ln=Kn("models:Course"),I0=["track","dist","gain","loss","cache","distance"];class P0{constructor(i){y(this,"name");y(this,"_cache",{});y(this,"_loops",1);y(this,"_distOverride");y(this,"_gainOverride");y(this,"_lossOverride");y(this,"_dist");y(this,"_gain");y(this,"_loss");y(this,"_sites",[new Or(this,{_id:String(W.random(1e4,2e4)),name:"Start",type:"start",percent:0}),new Or(this,{_id:String(W.random(3e4,4e4)),name:"Finish",type:"finish",percent:1})]);y(this,"_waypoints");y(this,"_track");y(this,"_points");y(this,"_terrainFactors");y(this,"_terrainTypes");y(this,"_cutoffs");y(this,"_splits");y(this,"_stats");this._track=i.track,i.loops&&(this.loops=i.loops),i.dist&&(this._distOverride=i.dist),i.gain&&(this._gainOverride=i.gain),i.loss&&(this._lossOverride=i.loss);const r=Object.keys(i).filter(o=>!I0.includes(o));Object.assign(this,W.pick(i,r))}get loops(){return this._loops}set loops(i){this._loops=i,this.clearCache(2)}set dist(i){Ln(`overriding dist to ${i}`),this._distOverride=i,this.clearCache(2)}set gain(i){Ln(`overriding gain to ${i}`),this._gainOverride=i,this.clearCache(2)}set loss(i){Ln(`overriding loss to ${i}`),this._lossOverride=i,this.clearCache(2)}get dist(){return this._dist||(this._dist=this._distOverride||this.track.dist*this.loops)}get gain(){return this.gain||(this._gain=this._gainOverride||this.track.gain*this.loops)}get loss(){return this._loss||(this._loss=this._lossOverride||this.track.loss*this.loops)}get distScale(){return this._distOverride?this._distOverride/(this.track.dist*this.loops):1}get gainScale(){return this._gainOverride?this._gainOverride/(this.track.gain*this.loops):1}get lossScale(){return this._lossOverride?this._lossOverride/(this.track.loss*this.loops):1}get loopDist(){return this.dist/this.loops}get loopGain(){return this.gain/this.loops}get loopLoss(){return this.loss/this.loops}get sites(){return this._sites}set sites(i){this._sites=i.map(r=>new Or(this,r)),this.clearCache(1)}clearCache(i=1){Ln(`clearCache-${i}`),delete this._cutoffs,delete this._splits,delete this._stats,delete this._terrainFactors,delete this._terrainTypes,delete this._waypoints,i===2&&(delete this._dist,delete this._gain,delete this._loss,delete this._points,this.sites.forEach(r=>{r.clearCache()}))}get waypoints(){var r;if(this._waypoints)return this._waypoints;if(!((r=this.track)!=null&&r.dist))return[];let i=[];return this.sites.forEach(o=>{i.push(...o.waypoints)}),i=i.sort((o,f)=>o.loc-f.loc),this._waypoints=i,this._waypoints}set track(i){this._track=i,this.clearCache(2)}get track(){return this._track}get points(){var i,r;if(this._points)return this._points;if(Ln("generating points array"),!((r=(i=this.track)==null?void 0:i.points)!=null&&r.length))throw new $e("Track points are not defined.","points");this._points=new Array(this.track.points.length*this.loops);for(let o=0;o<this.loops;o++)for(let f=0;f<this.track.points.length;f++)this.points[f+o*this.track.points.length]=new ps(this,this.track.points[f],o);return this._points}set points(i){throw new Error("cannot set points directly")}getPoint(i,r=!1){const o=this.points.findIndex(C=>ms(C.loc,i,4)),f=this.points[o];if(Wr(f.loc,i,4))return f;Ln(`getPoint: ${r?"inserting":"creating"} new CoursePoint at ${i}`);const p=o-1,g=this.points[p],_=_u(g.point,f.point,i%this.loopDist/this.distScale),M=new ps(this,_,Math.floor(i/this.loopDist));return r&&this.points.splice(o,0,M),M}get terrainFactors(){if(this._terrainFactors)return this._terrainFactors;Ln("regenerating terrainFactors");const i=this.waypoints.filter((r,o)=>{var f;return o===0||!W.isNil(r.terrainFactor)&&r.terrainFactor!==((f=this.waypoints[o-1])==null?void 0:f.terrainFactor)});return this._terrainFactors=i.map((r,o)=>new F0(r,i[o+1]||W.last(this.waypoints),r.terrainFactor)),this._terrainFactors}get terrainTypes(){if(this._terrainTypes)return this._terrainTypes;Ln("regenerating terrainTypes");const i=this.waypoints.filter((r,o)=>{var f;return!W.isNil(r.terrainType)&&r.terrainType!==((f=this.waypoints[o-1])==null?void 0:f.terrainType)});return this._terrainTypes=i.map((r,o)=>new E0(r,i[o+1]||W.last(this.waypoints),r.terrainType||"")),this._terrainTypes}get cutoffs(){return this._cutoffs?this._cutoffs:(this._cutoffs=this.waypoints.filter(i=>i.cutoff).map(i=>new T0(i)),this._cutoffs)}get splits(){return this._splits?this._splits:(this._splits=new x0(this),this._splits)}get stats(){if(this._stats)return this._stats;Ln("stats:calculate");const i=this.track.points.map(g=>g.alt),r=this.track.points.map(g=>g.grade),o=this.terrainFactors.map(g=>g.value/100+1),f={altitude:{avg:W.sum(this.track.points.map((g,_)=>{var M;return g.alt*(g.loc-(((M=this.track.points[_-1])==null?void 0:M.loc)||0))}))/this.track.dist,max:W.max(i)||0,min:W.min(i)||0},grade:{avg:(this.track.points[this.track.points.length-1].alt-this.track.points[0].alt)/this.track.dist/10,max:W.max(r)||0,min:W.min(r)||0},terrain:{avg:(W.sumBy(this.terrainFactors,g=>(g.end-g.start)*g.value)/this.dist+100)/100,max:W.max(o)||0,min:W.min(o)||0,maxDist:0,minDist:0}},p=g=>this.terrainFactors.reduce((_,M)=>M.value/100+1===g?_+M.end-M.start:_,0);return Object.assign(f.terrain,{maxDist:p(f.terrain.max),minDist:p(f.terrain.min)}),this._stats=f,f}locationsToBreaks(i){const r=i.filter(f=>f>0&&ou(f,this.dist,4));return r.unshift(0),r.map((f,p)=>({start:f,end:r[p+1]||this.dist}))}}class T0{constructor(i){y(this,"waypoint");this.waypoint=i}get loc(){return this.waypoint.loc}get time(){if(!this.waypoint.cutoff)throw new Error("Invalid cutoff");return this.waypoint.cutoff}}class F0{constructor(i,r,o=0){y(this,"value");y(this,"startWaypoint");y(this,"endWaypoint");this.startWaypoint=i,this.endWaypoint=r,this.value=o}get start(){return this.startWaypoint.loc}get end(){return this.endWaypoint.loc}}class E0{constructor(i,r,o){y(this,"type");y(this,"startWaypoint");y(this,"endWaypoint");this.startWaypoint=i,this.endWaypoint=r,this.type=o}get start(){return this.startWaypoint.loc}get end(){return this.endWaypoint.loc}}var vu={exports:{}};(function(c,i){(function(){var r=Math.PI,o=Math.sin,f=Math.cos,p=Math.tan,g=Math.asin,_=Math.atan2,M=Math.acos,C=r/180,b=1e3*60*60*24,m=2440588,F=2451545;function O(k){return k.valueOf()/b-.5+m}function R(k){return new Date((k+.5-m)*b)}function T(k){return O(k)-F}var N=C*23.4397;function K(k,z){return _(o(k)*f(N)-p(z)*o(N),f(k))}function X(k,z){return g(o(z)*f(N)+f(z)*o(N)*o(k))}function Q(k,z,G){return _(o(k),f(k)*o(z)-p(G)*f(z))}function et(k,z,G){return g(o(z)*o(G)+f(z)*f(G)*f(k))}function St(k,z){return C*(280.16+360.9856235*k)-z}function At(k){return k<0&&(k=0),2967e-7/Math.tan(k+.00312536/(k+.08901179))}function It(k){return C*(357.5291+.98560028*k)}function Gt(k){var z=C*(1.9148*o(k)+.02*o(2*k)+3e-4*o(3*k)),G=C*102.9372;return k+z+G+r}function jt(k){var z=It(k),G=Gt(z);return{dec:X(G,0),ra:K(G,0)}}var Ht={};Ht.getPosition=function(k,z,G){var ct=C*-G,nt=C*z,ht=T(k),ot=jt(ht),lt=St(ht,ct)-ot.ra;return{azimuth:Q(lt,nt,ot.dec),altitude:et(lt,nt,ot.dec)}};var me=Ht.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];Ht.addTime=function(k,z,G){me.push([k,z,G])};var ze=9e-4;function Br(k,z){return Math.round(k-ze-z/(2*r))}function we(k,z,G){return ze+(k+z)/(2*r)+G}function Ge(k,z,G){return F+k+.0053*o(z)-.0069*o(2*G)}function Ur(k,z,G){return M((o(k)-o(z)*o(G))/(f(z)*f(G)))}function bn(k){return-2.076*Math.sqrt(k)/60}function vn(k,z,G,ct,nt,ht,ot){var lt=Ur(k,G,ct),yt=we(lt,z,nt);return Ge(yt,ht,ot)}Ht.getTimes=function(k,z,G,ct){ct=ct||0;var nt=C*-G,ht=C*z,ot=bn(ct),lt=T(k),yt=Br(lt,nt),qt=we(0,nt,yt),Rt=It(qt),Nt=Gt(Rt),mn=X(Nt,0),_t=Ge(qt,Rt,Nt),kt,Dn,Mt,Wt,cn,tn,pt={solarNoon:R(_t),nadir:R(_t-.5)};for(kt=0,Dn=me.length;kt<Dn;kt+=1)Mt=me[kt],Wt=(Mt[0]+ot)*C,cn=vn(Wt,nt,ht,mn,yt,Rt,Nt),tn=_t-(cn-_t),pt[Mt[1]]=R(tn),pt[Mt[2]]=R(cn);return pt};function He(k){var z=C*(218.316+13.176396*k),G=C*(134.963+13.064993*k),ct=C*(93.272+13.22935*k),nt=z+C*6.289*o(G),ht=C*5.128*o(ct),ot=385001-20905*f(G);return{ra:K(nt,ht),dec:X(nt,ht),dist:ot}}Ht.getMoonPosition=function(k,z,G){var ct=C*-G,nt=C*z,ht=T(k),ot=He(ht),lt=St(ht,ct)-ot.ra,yt=et(lt,nt,ot.dec),qt=_(o(lt),p(nt)*f(ot.dec)-o(ot.dec)*f(lt));return yt=yt+At(yt),{azimuth:Q(lt,nt,ot.dec),altitude:yt,distance:ot.dist,parallacticAngle:qt}},Ht.getMoonIllumination=function(k){var z=T(k||new Date),G=jt(z),ct=He(z),nt=149598e3,ht=M(o(G.dec)*o(ct.dec)+f(G.dec)*f(ct.dec)*f(G.ra-ct.ra)),ot=_(nt*o(ht),ct.dist-nt*f(ht)),lt=_(f(G.dec)*o(G.ra-ct.ra),o(G.dec)*f(ct.dec)-f(G.dec)*o(ct.dec)*f(G.ra-ct.ra));return{fraction:(1+f(ot))/2,phase:.5+.5*ot*(lt<0?-1:1)/Math.PI,angle:lt}};function Sn(k,z){return new Date(k.valueOf()+z*b/24)}Ht.getMoonTimes=function(k,z,G,ct){var nt=new Date(k);ct?nt.setUTCHours(0,0,0,0):nt.setHours(0,0,0,0);for(var ht=.133*C,ot=Ht.getMoonPosition(nt,z,G).altitude-ht,lt,yt,qt,Rt,Nt,mn,_t,kt,Dn,Mt,Wt,cn,tn,pt=1;pt<=24&&(lt=Ht.getMoonPosition(Sn(nt,pt),z,G).altitude-ht,yt=Ht.getMoonPosition(Sn(nt,pt+1),z,G).altitude-ht,Nt=(ot+yt)/2-lt,mn=(yt-ot)/2,_t=-mn/(2*Nt),kt=(Nt*_t+mn)*_t+lt,Dn=mn*mn-4*Nt*lt,Mt=0,Dn>=0&&(tn=Math.sqrt(Dn)/(Math.abs(Nt)*2),Wt=_t-tn,cn=_t+tn,Math.abs(Wt)<=1&&Mt++,Math.abs(cn)<=1&&Mt++,Wt<-1&&(Wt=cn)),Mt===1?ot<0?qt=pt+Wt:Rt=pt+Wt:Mt===2&&(qt=pt+(kt<0?cn:Wt),Rt=pt+(kt<0?Wt:cn)),!(qt&&Rt));pt+=2)ot=yt;var wn={};return qt&&(wn.rise=Sn(nt,qt)),Rt&&(wn.set=Sn(nt,Rt)),!qt&&!Rt&&(wn[kt>0?"alwaysUp":"alwaysDown"]=!0),wn},c.exports=Ht})()})(vu);var eu=vu.exports;function ee(c,i){const r=c.toLocaleString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:i}).split(":").map(o=>Number(o));return r[0]*60*60+r[1]*60+r[2]}class R0{constructor(i){y(this,"nadir",0);y(this,"dawn",0);y(this,"sunrise",0);y(this,"dusk",0);y(this,"sunset",0);y(this,"noon",0);y(this,"nadirAltitude",0);Object.assign(this,i)}}class ru{constructor(i,r,o,f){y(this,"start");y(this,"lat");y(this,"lon");y(this,"timezone");y(this,"sun");y(this,"startTime");this.start=i,this.lat=o,this.lon=f,this.timezone=r;const p=eu.getTimes(this.start,this.lat,this.lon),g=eu.getPosition(p.nadir,this.lat,this.lon);this.sun=new R0({nadir:ee(p.nadir,this.timezone),dawn:ee(p.dawn,this.timezone),sunrise:ee(p.sunrise,this.timezone),dusk:ee(p.dusk,this.timezone),sunset:ee(p.sunset,this.timezone),noon:ee(p.solarNoon,this.timezone),nadirAltitude:g.altitude*180/Math.PI}),this.startTime=ee(this.start,this.timezone)}dateAtElapsed(i){const r=new Date(this.start);return r.setTime(r.getTime()+i*1e3),r}elapsedToTimeOfDay(i){return(this.startTime+i)%86400}serialize(){return W.pick(this,["start","sun","lat","lon","timezone"])}}var Nr={};(function(c){(function(){var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(_){return f(g(_),arguments)}function o(_,M){return r.apply(null,[_].concat(M||[]))}function f(_,M){var C=1,b=_.length,m,F="",O,R,T,N,K,X,Q,et;for(O=0;O<b;O++)if(typeof _[O]=="string")F+=_[O];else if(typeof _[O]=="object"){if(T=_[O],T.keys)for(m=M[C],R=0;R<T.keys.length;R++){if(m==null)throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',T.keys[R],T.keys[R-1]));m=m[T.keys[R]]}else T.param_no?m=M[T.param_no]:m=M[C++];if(i.not_type.test(T.type)&&i.not_primitive.test(T.type)&&m instanceof Function&&(m=m()),i.numeric_arg.test(T.type)&&typeof m!="number"&&isNaN(m))throw new TypeError(r("[sprintf] expecting number but found %T",m));switch(i.number.test(T.type)&&(Q=m>=0),T.type){case"b":m=parseInt(m,10).toString(2);break;case"c":m=String.fromCharCode(parseInt(m,10));break;case"d":case"i":m=parseInt(m,10);break;case"j":m=JSON.stringify(m,null,T.width?parseInt(T.width):0);break;case"e":m=T.precision?parseFloat(m).toExponential(T.precision):parseFloat(m).toExponential();break;case"f":m=T.precision?parseFloat(m).toFixed(T.precision):parseFloat(m);break;case"g":m=T.precision?String(Number(m.toPrecision(T.precision))):parseFloat(m);break;case"o":m=(parseInt(m,10)>>>0).toString(8);break;case"s":m=String(m),m=T.precision?m.substring(0,T.precision):m;break;case"t":m=String(!!m),m=T.precision?m.substring(0,T.precision):m;break;case"T":m=Object.prototype.toString.call(m).slice(8,-1).toLowerCase(),m=T.precision?m.substring(0,T.precision):m;break;case"u":m=parseInt(m,10)>>>0;break;case"v":m=m.valueOf(),m=T.precision?m.substring(0,T.precision):m;break;case"x":m=(parseInt(m,10)>>>0).toString(16);break;case"X":m=(parseInt(m,10)>>>0).toString(16).toUpperCase();break}i.json.test(T.type)?F+=m:(i.number.test(T.type)&&(!Q||T.sign)?(et=Q?"+":"-",m=m.toString().replace(i.sign,"")):et="",K=T.pad_char?T.pad_char==="0"?"0":T.pad_char.charAt(1):" ",X=T.width-(et+m).length,N=T.width&&X>0?K.repeat(X):"",F+=T.align?et+m+N:K==="0"?et+N+m:N+et+m)}return F}var p=Object.create(null);function g(_){if(p[_])return p[_];for(var M=_,C,b=[],m=0;M;){if((C=i.text.exec(M))!==null)b.push(C[0]);else if((C=i.modulo.exec(M))!==null)b.push("%");else if((C=i.placeholder.exec(M))!==null){if(C[2]){m|=1;var F=[],O=C[2],R=[];if((R=i.key.exec(O))!==null)for(F.push(R[1]);(O=O.substring(R[0].length))!=="";)if((R=i.key_access.exec(O))!==null)F.push(R[1]);else if((R=i.index_access.exec(O))!==null)F.push(R[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");C[2]=F}else m|=2;if(m===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");b.push({placeholder:C[0],param_no:C[1],keys:C[2],sign:C[3],pad_char:C[4],align:C[5],width:C[6],precision:C[7],type:C[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");M=M.substring(C[0].length)}return p[_]=b}c.sprintf=r,c.vsprintf=o,typeof window<"u"&&(window.sprintf=r,window.vsprintf=o)})()})(Nr);class mu{constructor(i,r){y(this,"_callbacks",{});y(this,"_target");this._target=i,this._callbacks=W.fromPairs(r.map(o=>[o,[]]))}add(i,r){if(!this._callbacks[i])throw new Error(`${i} is not a valid callback for object`);this._callbacks[i].find(o=>o===r)?console.warn("callback already exists."):this._callbacks[i].push(r)}remove(i,r){if(!this._callbacks[i])throw new Error(`${i} is not a valid callback for object`);W.pull(this._callbacks[i],r)}clear(i){(i?[i]:Object.keys(this._callbacks)).forEach(o=>this._callbacks[o]=[])}execute(i){this._callbacks[i].forEach(r=>r(this._target))}}const k0=Kn("PaceChunk");class L0{constructor(){y(this,"iterations",!1);y(this,"factor",!1);y(this,"target",!1)}get passing(){return this.iterations&&this.factor&&this.target}get statusString(){return[`iterations=${this.iterations?"P":"F"}`,`factor=${this.factor?"P":"F"}`,`target=${this.target?"P":"F"}`].join("|")}}class iu{constructor(i,r,o,f){y(this,"constraints");y(this,"points");y(this,"plan");y(this,"delay");y(this,"factor");y(this,"factors",new On);y(this,"status");this.constraints=o,this.points=r,this.plan=i,this.delay=f,this.factor=1}get elapsed(){const i=W.isFunction(this.constraints[0])?this.constraints[0]():this.constraints[0];return(W.isFunction(this.constraints[1])?this.constraints[1]():this.constraints[1])-i}get dist(){return this.points[this.points.length-1].loc-this.points[0].loc}get pace(){return(this.elapsed-this.delay)/this.dist}get np(){return this.pace/this.factor}get moving(){return this.elapsed-this.delay}applyPacing(){this.plan.pacing.clearFactor();const i=this.points;i[0].elapsed=W.isFunction(this.constraints[0])?this.constraints[0]():this.constraints[0],i[0].time=i[0].elapsed-W.sum(this.plan.pacing.chunks.filter(C=>C.points[0].loc<i[0].loc).map(C=>C.delay)),this.plan.event.start&&(i[0].tod=this.plan.event.elapsedToTimeOfDay(i[0].elapsed));let r=i[0].elapsed,o=i[0].delay||0,f=0,p=0,g=0;const _=this.factor?this.np:this.plan.pacing.pace,M=new On().init(0);for(let C=1,b=i.length;C<b;C++){f=i[C].loc-i[C-1].loc,gs(i[C-1],this.plan),M.applyEach((F,O)=>F+O*f,i[C-1].factors);const m=i[C-1].factors.combined;g+=m*f,p=_*m*f,i[C].time=i[C-1].time+p,o=i[C-1].delay||0,r+=p+o,i[C].elapsed=r,this.plan.event.start&&(i[C].tod=this.plan.event.elapsedToTimeOfDay(r))}gs(i[i.length-1],this.plan),this.factors=M.scaleEach(1/this.dist),this.factor=g/this.dist}calculate(){const o=k0.extend(Nr.vsprintf("calculate:%.2f-%.2f",[this.points[0].loc,this.points[this.points.length-1].loc]));let f=this.factor||0,p;const g=new L0;for(p=0;p<20&&(this.applyPacing(),g.iterations=p>=2,g.factor=!W.round(f-this.factor,10),f=this.factor,g.target=Math.abs((W.isFunction(this.constraints[1])?this.constraints[1]():this.constraints[1])-this.points[this.points.length-1].elapsed)<.1,o(Nr.vsprintf("%i|%s",[p,g.statusString])),!g.passing);p++);o("iteration complete"),this.status={tests:g,success:g.passing,iterations:p+1}}}const Vt=Kn("Pacing");class O0{constructor(i){y(this,"callbacks",new mu(this,["onUpdated","onFail","onInvalidated"]));y(this,"chunks",[]);y(this,"plan");y(this,"_elapsed");y(this,"_factor");y(this,"_factors");this.plan=i}clearCache(){Vt("clearCache"),delete this._elapsed,delete this._factor,delete this._factors}invalidate(){Vt("invalidate"),this.chunks=[],this.clearCache(),this.callbacks.execute("onInvalidated")}get elapsed(){return Vt("elapsed:get"),this._elapsed||this.plan.points[this.plan.points.length-1].elapsed}get pace(){return Vt("pace:get"),(this.elapsed-this.plan.delay)/this.plan.course.dist}get factor(){return this._factor?this._factor:(Vt("factor:update"),this.chunks&&(this._factor=W.sum(this.chunks.map(i=>i.factor*i.dist))/this.plan.course.dist),this._factor||1)}clearFactor(){delete this._factor}get factors(){return Vt("factors:get"),this._factors||(Vt("factors:update"),this._factors=ws(this.chunks)),this._factors}get np(){return Vt("np:get"),this.pace/this.factor}get moving(){return this.elapsed-this.plan.delay}get status(){var i,r,o;return{complete:((i=this.chunks)==null?void 0:i.length)>0,success:((r=this.chunks)==null?void 0:r.filter(f=>{var p;return!((p=f.status)!=null&&p.success)}).length)===0,chunks:((o=this.chunks)==null?void 0:o.length)||0}}calculate(){var o,f,p;const i=Vt.extend("calculate");if(i("exec"),!((o=this.plan.points)!=null&&o.length))throw i("calculate: error; no points"),new $e("Plan points are not defined.","points");i("clearing cache"),this.clearCache(),i("adding points at each terrain factor break"),(f=this.plan.course.terrainFactors)==null||f.forEach(g=>this.plan.getPoint(g.start,!0)),i("adding points at each cutoff"),this.plan.cutoffMargin&&this.plan.cutoffs.forEach(g=>{g.point=this.plan.getPoint(g.loc,!0)}),this.plan.points.filter(g=>g.delay).forEach(g=>{g.delay=0}),(p=this.plan.delays)==null||p.forEach(g=>{const _=this.plan.getPoint(g.loc,!0);_.delay=g.delay}),i("creating pace chunks"),this.initChunks(),[null,...W.reverse([...this.plan.cutoffs]),null].forEach(g=>{for(;this.chunks.find(_=>!_.status);)this.calcChunks(),this.validateChunks();if(!g)return!0;if(g.point.elapsed-g.time>.5){i(`cutoff at ${g.loc} missed`);const _=this.chunks[0];W.last(_.points)===g.point?(i(`setting cutoff at ${g.loc}`),_.constraints=[0,g.time],delete _.status):this.splitChunk(_,g.point,g.time)}}),W.isFunction(this.chunks[this.chunks.length-1].constraints[1])&&this.chunks.length>2&&(i("rerunning last chunk"),this.chunks[this.chunks.length-1].calculate()),Vt(`pacing status=${this.status.success?"PASS":"FAIL"}.`),this.status.success?this.callbacks.execute("onUpdated"):this.callbacks.execute("onFail")}initChunks(){let i;switch(this.plan.method){case"time":i=this.plan.target;break;case"pace":i=this.plan.target*this.plan.course.dist+this.plan.delay;break;case"np":i=()=>this.plan.target*(this.factor||1)*this.plan.course.dist+this.plan.delay;break;default:throw new Error(`Incorrect pacing method ${this.plan.method}`)}this.chunks=[new iu(this.plan,this.plan.points,[0,i],this.plan.delay)],this.plan.points.forEach(r=>{r._chunk=this.chunks[0]})}calcChunks(){Vt("calcChunks"),this.clearCache(),this.chunks.filter(i=>!i.status).forEach(i=>i.calculate())}validateChunks(){let i=1;for(;i<=this.chunks.length-1;)this.chunks[i].np<this.chunks[i-1].np?this.mergeChunks(this.chunks[i-1],this.chunks[i]):i++}splitChunk(i,r,o){Vt.extend("split")(`breaking chunks at ${r.loc} km`);const p=i.points.findIndex(M=>M===r),g=W.round(r.elapsed-r.time),_=new iu(this.plan,i.points.slice(0,p+1),[0,o],g);_.points.filter((M,C)=>C<_.points.length-1).forEach(M=>{M._chunk=_}),this.chunks.unshift(_),i.constraints[0]=o,i.delay-=g,i.points=i.points.slice(p),delete i.status}mergeChunks(i,r){const o=this.chunks.findIndex(p=>p===i),f=this.chunks.findIndex(p=>p===r);if(f-o!==1)throw new Error("chunks must be sequential");Vt(Nr.sprintf("calcChunks: merging %i&%i (%.2f&%.2f)",o,f,i.np,r.np)),i.points.pop(),i.points.push(...r.points),i.delay+=r.delay,delete i.status,i.points.forEach(p=>{p._chunk=i}),i.constraints=[i.constraints[0],r.constraints[1]],this.chunks.splice(f,1)}}class vs{constructor(i,r){y(this,"factors",new On);y(this,"_chunk");y(this,"_plan");y(this,"_point");y(this,"elapsed");y(this,"time");y(this,"tod");y(this,"delay");this._plan=i,this._point=r,this.time=0,this.elapsed=0,this.tod=0,this.delay=0}get lat(){return this._point.lat}get lon(){return this._point.lon}get alt(){return this._point.alt}get latlon(){return this._point.latlon}get grade(){return this._point.grade}get loc(){return this._point.loc}get np(){var i;if(!this._chunk)throw new Error("PlanPoint._chunk not defined");return(i=this._chunk)==null?void 0:i.np}get factor(){var i;return(i=this.factors)==null?void 0:i.combined}get pace(){return this.np*this.factor}}const cs=Kn("PlanSplits");class D0{constructor(i){y(this,"_segments");y(this,"_miles");y(this,"_kilometers");y(this,"plan");this.plan=i}get segments(){var i;return(i=this._segments)!=null&&i.length||(this.plan.checkPacing(),this._segments=this.createSegments()),this._segments}set segments(i){this._segments=i}get miles(){var i;return(i=this._miles)!=null&&i.length||(this.plan.checkPacing(),this._miles=this.createSplits("miles")),this._miles}set miles(i){this._miles=i}get kilometers(){var i;return(i=this._kilometers)!=null&&i.length||(this.plan.checkPacing(),this._kilometers=this.createSplits("kilometers")),this._kilometers}set kilometers(i){this._kilometers=i}createSegments(){cs("createSegments");const i=this.plan.course.waypoints.filter(o=>o.tier<3).sort((o,f)=>o.loc-f.loc),r=this.calcSegments(this.plan.course.locationsToBreaks(i.map(o=>o.loc)));if(!r.length)throw new Error("createSegments result is empty");return r.forEach((o,f)=>{o.waypoint=i[f+1]}),r}createSplits(i){cs(`createSplits:${i}`);const r=lu(i),o=W.range(this.plan.course.dist*r).map(p=>p/r);this.plan.course.dist-o[o.length-1]>1e-4&&o.push(this.plan.course.dist);const f=this.calcSegments(this.plan.course.locationsToBreaks(o));if(!f.length)throw new Error("createSplits result is empty");return f}calcSegments(i){var O;const r=cs.extend("calcSegments");r("exec");const o=this.plan,f=o.course,p=o.points;if(!(p!=null&&p.length))throw r("Plan points are not defined."),new $e("Plan points are not defined.","points");const g=[],_=[];let M,C,b=o.points[0],m;for(M=0,C=i.length;M<C;M++){const R=i[M];m&&Wr((O=i[M-1])==null?void 0:O.end,R.start,4)?b=m:b=o.getPoint(R.start),m=o.getPoint(R.end);const T=R.end-R.start,N=new pu(this.plan,{gain:0,loss:0,grade:T>0?(m.alt-b.alt)/T/10*(m.alt-b.alt>0?f.gainScale:f.lossScale):0,point1:b,point2:m}),K=new On().init(0);g.push(N),_.push(K)}const F=(R,T,N,K)=>{const X=N.alt-T.alt;R[X>0?"gain":"loss"]+=X*(X>0?f.gainScale:f.lossScale),gs(T,o);const Q=N.loc-T.loc;K.applyEach((et,St)=>et+St*Q,T.factors)};M=1;for(let R=0;R<g.length;R++){const T=g[R],N=_[R];for(;Ue(p[M].loc,T.point1.loc,4);)M++;let K=T.point1;for(;M<p.length&&Ue(p[M].loc,T.point2.loc,4);){const X=p[M];F(T,K,X,N),K=X,M++}F(T,K,T.point2,N),o&&(T.delay=o.delays.filter(X=>ms(T.point1.loc,X.loc,4)&&ou(T.point2.loc,X.loc,4)).reduce((X,Q)=>X+Q.delay,0))}return g}}const _n=Kn("models:Plan");class N0{constructor(i){y(this,"plan");y(this,"_altitude",1);y(this,"_dark",1);this.plan=i}get altitude(){return this._altitude}set altitude(i){this._altitude=i,this.plan.clearCache()}get dark(){return this._dark}set dark(i){this._dark=i,this.plan.clearCache()}}class W0{constructor(i){y(this,"course");y(this,"event");y(this,"points");y(this,"method");y(this,"target");y(this,"name");y(this,"scales",new N0(this));y(this,"callbacks");y(this,"pacing");y(this,"_cutoffs");y(this,"_strategy");y(this,"_typicalDelay",0);y(this,"_cutoffMargin",0);y(this,"_heatModel");y(this,"_specifiedDelays",[]);y(this,"_delays");y(this,"_splits");y(this,"_events");y(this,"_stats");this.pacing=new O0(this),this.course=i.course,this.points=this.course.points.map(r=>new vs(this,r)),this.event=new ru(i.start.date,i.start.timezone,this.points[0].lat,this.points[0].lon),this.method=i.method,this.target=i.target,this.typicalDelay=i.typicalDelay||0,i.delays&&(this.delays=i.delays),this.cutoffMargin=i.cutoffMargin,this._strategy=new tu(this,i.strategy),Object.assign(this.scales,i.scales||{}),i.heatModel&&(this.heatModel=i.heatModel),this.name=i.name,this.callbacks=new mu(this,["onUpdated"])}clearCache(){_n("clearCache"),delete this._cutoffs,delete this._splits,delete this._stats}get cutoffs(){if(this._cutoffs)return this._cutoffs;this._cutoffs=this.cutoffMargin?this.course.cutoffs.map(r=>new U0(this,r,this.getPoint(r.loc,!0))):[];let i=0;for(;this._cutoffs.length-1>=i;){const r=this._cutoffs[i];this._cutoffs.find((o,f)=>f>i&&o.time<=r.time)?(_n(`get cutoffs: deleting extraneous cutoff at ${r.loc} km`),this._cutoffs.splice(i,1)):i++}return this._cutoffs}set start(i){this.event=new ru(i.date,i.timezone,this.points[0].lat,this.points[0].lon)}get strategy(){return this._strategy}set strategy(i){this._strategy=new tu(this,i),this.clearCache()}get typicalDelay(){return this._typicalDelay}set typicalDelay(i){this._typicalDelay=i,this.clearCache()}get cutoffMargin(){return this._cutoffMargin}set cutoffMargin(i){this._cutoffMargin=i,this.clearCache()}set heatModel(i){this._heatModel={start:this.event.sun.sunrise+1800,stop:this.event.sun.sunset+7200,baseline:i.baseline,max:i.max}}get heatModel(){return this._heatModel}set delays(i){this._specifiedDelays=i,delete this._delays}get delays(){if(this._delays)return this._delays;const i=this.course.waypoints.map(o=>{var g;const f=(g=this._specifiedDelays)==null?void 0:g.find(_=>ds(_.waypoint,o)),p=f?f.delay:o.hasTypicalDelay?this.typicalDelay:0;return new B0(o,p)}).filter(o=>o.delay>0).sort((o,f)=>o.loc-f.loc);let r=0;for(;i.length-1>=r;)r>0&&i[r].loc===i[r-1].loc?(_n(`get delays: merging delay at ${i[r].loc} km`),i[r-1].delay+=i[r].delay,i.splice(r,1)):r++;return this._delays=i,this._delays}get delay(){return W.sumBy(this.delays,"delay")}get splits(){return this._splits?this._splits:(_n("creating splits"),this._splits=new D0(this),this._splits)}get events(){if(this._events)return this._events;_n("calculating events.sun");const i=[],r=this.event.elapsedToTimeOfDay(0),o=Math.ceil((r+this.points[this.points.length-1].elapsed)/86400);for(let g=0;g<o;g++)[{event:"dawn",time:this.event.sun.dawn},{event:"sunrise",time:this.event.sun.sunrise},{event:"sunset",time:this.event.sun.sunset},{event:"dusk",time:this.event.sun.dusk}].forEach(M=>{const C=M.time-r+86400*g;C>=0&&C<=this.points[this.points.length-1].elapsed&&i.push({event:M.event,elapsed:C})});i.sort((g,_)=>g.elapsed-_.elapsed);const f=f0(this.points.map(g=>g.elapsed),this.points.map(g=>g.loc),i.map(g=>g.elapsed)),p=i.map((g,_)=>({...g,loc:f[_]}));return this._events={sun:p},this._events}get stats(){if(this._stats)return this._stats;_n("calculating stats.factors");const i=W.fromPairs(M0.map(p=>{const g=this.points.map(_=>_.factors.get(p));return[p,{min:W.min(g),max:W.max(g)}]}));_n("calculating stats.sun");const r={day:{time:0,dist:0},twilight:{time:0,dist:0},dark:{time:0,dist:0}};let o=0,f=0;return this.points.forEach((p,g)=>{var _,M;o=p.loc-(((_=this.points[g-1])==null?void 0:_.loc)||0),f=p.elapsed-(((M=this.points[g-1])==null?void 0:M.elapsed)||0),!isNaN(this.event.sun.dawn)&&!isNaN(this.event.sun.dusk)&&(p.tod<=this.event.sun.dawn||p.tod>=this.event.sun.dusk)?(r.dark.time+=f,r.dark.dist+=o):p.tod<this.event.sun.sunrise||p.tod>this.event.sun.sunset?(r.twilight.time+=f,r.twilight.dist+=o):(r.day.time+=f,r.day.dist+=o)}),this._stats={factors:i,sun:r},this._stats}getDelayAtWaypoint(i){var r;return((r=this.delays.find(o=>ds(o.waypoint,i)))==null?void 0:r.delay)||0}getTypicalDelayAtWaypoint(i){return i.hasTypicalDelay?this.typicalDelay:0}getPoint(i,r=!1){const o=this.points.findIndex(M=>ms(M.loc,i,4)),f=this.points[o];if(Wr(f.loc,i,4))return f;_n(`getPoint: ${r?"inserting":"creating"} new PlanPoint at ${i}`);const p=o-1,g=this.points[p],_=new vs(this,this.course.getPoint(i,r));if(!isNaN(g.time)&&!isNaN(f.time)){const M=f.elapsed-f.time-(g.elapsed-g.time);_.time=Be(g.loc,f.loc,g.time+M,f.time,f.loc),_.elapsed=f.elapsed-(f.time-_.time),this.event.start&&(_.tod=this.event.elapsedToTimeOfDay(_.elapsed))}return r&&this.points.splice(o,0,_),_}invalidatePacing(){_n("invalidatePacing"),this.pacing.invalidate(),delete this._splits}checkPacing(){var i,r;if(_n("checkPacing"),(i=this.pacing.status)!=null&&i.complete||(_n("checkPacing: calculate"),this.pacing.calculate()),!((r=this.points)!=null&&r.length))throw new Error("No plan points");return!0}}class B0{constructor(i,r){y(this,"delay");y(this,"waypoint");this.waypoint=i,this.delay=r}get loc(){return this.waypoint.loc}}class U0{constructor(i,r,o){y(this,"plan");y(this,"courseCutoff");y(this,"point");this.plan=i,this.courseCutoff=r,this.point=o}get waypoint(){return this.courseCutoff.waypoint}get loc(){return this.courseCutoff.loc}get time(){return this.courseCutoff.time-Math.max(this.plan.cutoffMargin||0,this.plan.getDelayAtWaypoint(this.waypoint))}}class wu{constructor(i){y(this,"segments");this.segments=i}get first(){return this.segments[0]}get last(){return this.segments[this.segments.length-1]}get start(){return this.segments[0].start}get end(){return this.last.end}get len(){return this.last.end-this.first.start}get gain(){return W.sum(this.segments.map(i=>i.gain))}get loss(){return W.sum(this.segments.map(i=>i.loss))}get grade(){return this.segments.reduce((i,r)=>i+r.grade*r.len,0)/this.len}get name(){return this.last.name}get waypoint(){return this.last.waypoint}get factors(){return ws(this.segments)}get point1(){return this.first.point1}get point2(){return this.last.point2}}class $0 extends wu{constructor(r){super(r);y(this,"segments");this.segments=r}}class z0 extends wu{constructor(r){super(r);y(this,"segments");this.segments=r}get last(){return this.segments[this.segments.length-1]}get elapsed(){return this.last.elapsed}get time(){return W.sum(this.segments.map(r=>r.time))}get tod(){return this.last.tod}}const yu=(c,i,r,o)=>{const f=h0(c,i,r,o),p=[];return r.forEach((g,_)=>{let M=f[_][0]/10;M>50?M=50:M<-50&&(M=-50);const C=g*f[_][0]+f[_][1];p.push({grade:M,alt:C})}),p};function G0(c,i){return yu(i,c.map(o=>o.alt),i,.05).map(o=>o.grade)}const H0=c=>{let i=0,r=0;const o=[0];for(let f=1,p=c.length;f<p;f++)i=Number(c[f-1].latlon.distanceTo(c[f].latlon)),r+=i,o.push(r);return o},Lr=Kn("models:Track");class Ms{constructor(i){y(this,"dist");y(this,"gain");y(this,"loss");y(this,"points");Lr("Creating new Track object");const r=i.map(C=>new ys(C.lat,C.lon,C.alt)),o=H0(r),f=G0(r,o);this.points=r.map((C,b)=>new du(C.lat,C.lon,C.alt,o[b],f[b])),Lr(`set-points - ${r.length} points`),Lr("Calculating"),this.dist=this.points[this.points.length-1].loc;let p=0,g=0,_=0,M=this.points[0].alt;this.points.forEach(C=>{_=C.alt-M,_<0?g+=_:p+=_,M=C.alt}),this.gain=p,this.loss=g}get start(){return W.pick(this.points[0],["lat","lon"])}get finish(){return W.pick(this.points[this.points.length-1],["lat","lon"])}getLLA(i){i>this.dist&&(i=i%this.dist);let r;if(i===0)r=this.points[0];else{const o=this.points.findIndex(f=>f.loc>=i);r=_u(this.points[o-1],this.points[o],i)}return W.pick(r,["lat","lon","alt"])}getNearestPoint(i,r,o){let p=this.points.findIndex(M=>M===r),g=this.points[p],_=0;for(;o>.025;){const M=o/5,C=[g];for(let F=1;F<=5;F++){const O=g.loc+M*F;if(O<=this.dist){for(;this.points[p+1].loc<O&&p<this.points.length-1;)p++;C.push(this.points[p])}}const b=C.map(F=>Number(i.distanceTo(F.latlon)));_=Math.min(...b);const m=b.findIndex(F=>F===_);g=C[m],o=o/5}return{point:g,delta:_}}reduceDensity(i=.025,r=this.points.length/2){const o=Lr.extend("reduceDensity");if(this.dist/i>r/2)return o("Does not meet criteria"),this;const f=this.dist,p=Math.floor(f/i)+1,g=Array(p).fill(0).map((b,m)=>fn(m++*i,3));g[g.length-1]<f&&g.push(f);const _=yu(this.points.map(b=>b.loc),this.points.map(b=>b.alt),g,2*i),M=g.map(b=>this.getLLA(b)).map((b,m)=>({lat:fn(b.lat,6),lon:fn(b.lon,6),alt:fn(_[m].alt,2)})),C=new Ms(M);return o(`Reduced from ${this.points.length} to ${C.points.length} points.`),C}}exports.Course=P0;exports.CoursePoint=ps;exports.CourseSegment=hu;exports.Plan=W0;exports.PlanPoint=vs;exports.PlanSegment=pu;exports.Point=ys;exports.Site=Or;exports.SuperCourseSegment=$0;exports.SuperPlanSegment=z0;exports.Track=Ms;exports.Waypoint=_s;
