"use strict";var g0=Object.defineProperty;var d0=(h,s,r)=>s in h?g0(h,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):h[s]=r;var C=(h,s,r)=>d0(h,typeof s!="symbol"?s+"":s,r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var We=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lu(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var Nr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Nr.exports;(function(h,s){(function(){var r,o="4.17.21",f=200,p="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",_="Invalid `variable` option passed into `_.template`",y="__lodash_hash_undefined__",M=500,S="__lodash_placeholder__",m=1,T=2,O=4,F=1,E=2,N=1,K=2,Y=4,X=8,et=16,bt=32,At=64,It=128,Ht=256,jt=512,qt=30,we="...",Ue=800,Gr=16,ye=1,$e=2,zr=3,Sn=1/0,vn=9007199254740991,Ge=17976931348623157e292,bn=NaN,L=4294967295,$=L-1,G=L>>>1,ht=[["ary",It],["bind",N],["bindKey",K],["curry",X],["curryRight",et],["flip",jt],["partial",bt],["partialRight",At],["rearg",Ht]],nt="[object Arguments]",ct="[object Array]",ot="[object AsyncFunction]",lt="[object Boolean]",yt="[object Date]",Kt="[object DOMException]",Ft="[object Error]",Wt="[object Function]",mn="[object GeneratorFunction]",_t="[object Map]",Lt="[object Number]",kn="[object Null]",Mt="[object Object]",Bt="[object Promise]",hn="[object Proxy]",tn="[object RegExp]",pt="[object Set]",wn="[object String]",ze="[object Symbol]",Fu="[object Undefined]",Me="[object WeakMap]",Lu="[object WeakSet]",Ce="[object ArrayBuffer]",ee="[object DataView]",Hr="[object Float32Array]",qr="[object Float64Array]",Kr="[object Int8Array]",Vr="[object Int16Array]",Zr="[object Int32Array]",Jr="[object Uint8Array]",Yr="[object Uint8ClampedArray]",Xr="[object Uint16Array]",Qr="[object Uint32Array]",ku=/\b__p \+= '';/g,Ou=/\b(__p \+=) '' \+/g,Du=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Es=/&(?:amp|lt|gt|quot|#39);/g,Ts=/[&<>"']/g,Nu=RegExp(Es.source),Wu=RegExp(Ts.source),Bu=/<%-([\s\S]+?)%>/g,Uu=/<%([\s\S]+?)%>/g,Rs=/<%=([\s\S]+?)%>/g,$u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Gu=/^\w*$/,zu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jr=/[\\^$.*+?()[\]{}|]/g,Hu=RegExp(jr.source),ti=/^\s+/,qu=/\s/,Ku=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Vu=/\{\n\/\* \[wrapped with (.+)\] \*/,Zu=/,? & /,Ju=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Yu=/[()=,{}\[\]\/\s]/,Xu=/\\(\\)?/g,Qu=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Fs=/\w*$/,ju=/^[-+]0x[0-9a-f]+$/i,tl=/^0b[01]+$/i,nl=/^\[object .+?Constructor\]$/,el=/^0o[0-7]+$/i,rl=/^(?:0|[1-9]\d*)$/,il=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,He=/($^)/,sl=/['\n\r\u2028\u2029\\]/g,qe="\\ud800-\\udfff",al="\\u0300-\\u036f",ol="\\ufe20-\\ufe2f",ul="\\u20d0-\\u20ff",Ls=al+ol+ul,ks="\\u2700-\\u27bf",Os="a-z\\xdf-\\xf6\\xf8-\\xff",ll="\\xac\\xb1\\xd7\\xf7",fl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",hl="\\u2000-\\u206f",cl=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ds="A-Z\\xc0-\\xd6\\xd8-\\xde",Ns="\\ufe0e\\ufe0f",Ws=ll+fl+hl+cl,ni="['’]",pl="["+qe+"]",Bs="["+Ws+"]",Ke="["+Ls+"]",Us="\\d+",gl="["+ks+"]",$s="["+Os+"]",Gs="[^"+qe+Ws+Us+ks+Os+Ds+"]",ei="\\ud83c[\\udffb-\\udfff]",dl="(?:"+Ke+"|"+ei+")",zs="[^"+qe+"]",ri="(?:\\ud83c[\\udde6-\\uddff]){2}",ii="[\\ud800-\\udbff][\\udc00-\\udfff]",re="["+Ds+"]",Hs="\\u200d",qs="(?:"+$s+"|"+Gs+")",_l="(?:"+re+"|"+Gs+")",Ks="(?:"+ni+"(?:d|ll|m|re|s|t|ve))?",Vs="(?:"+ni+"(?:D|LL|M|RE|S|T|VE))?",Zs=dl+"?",Js="["+Ns+"]?",vl="(?:"+Hs+"(?:"+[zs,ri,ii].join("|")+")"+Js+Zs+")*",ml="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",wl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ys=Js+Zs+vl,yl="(?:"+[gl,ri,ii].join("|")+")"+Ys,Ml="(?:"+[zs+Ke+"?",Ke,ri,ii,pl].join("|")+")",Cl=RegExp(ni,"g"),Sl=RegExp(Ke,"g"),si=RegExp(ei+"(?="+ei+")|"+Ml+Ys,"g"),bl=RegExp([re+"?"+$s+"+"+Ks+"(?="+[Bs,re,"$"].join("|")+")",_l+"+"+Vs+"(?="+[Bs,re+qs,"$"].join("|")+")",re+"?"+qs+"+"+Ks,re+"+"+Vs,wl,ml,Us,yl].join("|"),"g"),xl=RegExp("["+Hs+qe+Ls+Ns+"]"),Al=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Il=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Pl=-1,ft={};ft[Hr]=ft[qr]=ft[Kr]=ft[Vr]=ft[Zr]=ft[Jr]=ft[Yr]=ft[Xr]=ft[Qr]=!0,ft[nt]=ft[ct]=ft[Ce]=ft[lt]=ft[ee]=ft[yt]=ft[Ft]=ft[Wt]=ft[_t]=ft[Lt]=ft[Mt]=ft[tn]=ft[pt]=ft[wn]=ft[Me]=!1;var ut={};ut[nt]=ut[ct]=ut[Ce]=ut[ee]=ut[lt]=ut[yt]=ut[Hr]=ut[qr]=ut[Kr]=ut[Vr]=ut[Zr]=ut[_t]=ut[Lt]=ut[Mt]=ut[tn]=ut[pt]=ut[wn]=ut[ze]=ut[Jr]=ut[Yr]=ut[Xr]=ut[Qr]=!0,ut[Ft]=ut[Wt]=ut[Me]=!1;var El={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Tl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rl={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Fl={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ll=parseFloat,kl=parseInt,Xs=typeof We=="object"&&We&&We.Object===Object&&We,Ol=typeof self=="object"&&self&&self.Object===Object&&self,Pt=Xs||Ol||Function("return this")(),ai=s&&!s.nodeType&&s,Vn=ai&&!0&&h&&!h.nodeType&&h,Qs=Vn&&Vn.exports===ai,oi=Qs&&Xs.process,nn=function(){try{var v=Vn&&Vn.require&&Vn.require("util").types;return v||oi&&oi.binding&&oi.binding("util")}catch{}}(),js=nn&&nn.isArrayBuffer,ta=nn&&nn.isDate,na=nn&&nn.isMap,ea=nn&&nn.isRegExp,ra=nn&&nn.isSet,ia=nn&&nn.isTypedArray;function Vt(v,x,b){switch(b.length){case 0:return v.call(x);case 1:return v.call(x,b[0]);case 2:return v.call(x,b[0],b[1]);case 3:return v.call(x,b[0],b[1],b[2])}return v.apply(x,b)}function Dl(v,x,b,k){for(var z=-1,rt=v==null?0:v.length;++z<rt;){var Ct=v[z];x(k,Ct,b(Ct),v)}return k}function en(v,x){for(var b=-1,k=v==null?0:v.length;++b<k&&x(v[b],b,v)!==!1;);return v}function Nl(v,x){for(var b=v==null?0:v.length;b--&&x(v[b],b,v)!==!1;);return v}function sa(v,x){for(var b=-1,k=v==null?0:v.length;++b<k;)if(!x(v[b],b,v))return!1;return!0}function On(v,x){for(var b=-1,k=v==null?0:v.length,z=0,rt=[];++b<k;){var Ct=v[b];x(Ct,b,v)&&(rt[z++]=Ct)}return rt}function Ve(v,x){var b=v==null?0:v.length;return!!b&&ie(v,x,0)>-1}function ui(v,x,b){for(var k=-1,z=v==null?0:v.length;++k<z;)if(b(x,v[k]))return!0;return!1}function gt(v,x){for(var b=-1,k=v==null?0:v.length,z=Array(k);++b<k;)z[b]=x(v[b],b,v);return z}function Dn(v,x){for(var b=-1,k=x.length,z=v.length;++b<k;)v[z+b]=x[b];return v}function li(v,x,b,k){var z=-1,rt=v==null?0:v.length;for(k&&rt&&(b=v[++z]);++z<rt;)b=x(b,v[z],z,v);return b}function Wl(v,x,b,k){var z=v==null?0:v.length;for(k&&z&&(b=v[--z]);z--;)b=x(b,v[z],z,v);return b}function fi(v,x){for(var b=-1,k=v==null?0:v.length;++b<k;)if(x(v[b],b,v))return!0;return!1}var Bl=hi("length");function Ul(v){return v.split("")}function $l(v){return v.match(Ju)||[]}function aa(v,x,b){var k;return b(v,function(z,rt,Ct){if(x(z,rt,Ct))return k=rt,!1}),k}function Ze(v,x,b,k){for(var z=v.length,rt=b+(k?1:-1);k?rt--:++rt<z;)if(x(v[rt],rt,v))return rt;return-1}function ie(v,x,b){return x===x?jl(v,x,b):Ze(v,oa,b)}function Gl(v,x,b,k){for(var z=b-1,rt=v.length;++z<rt;)if(k(v[z],x))return z;return-1}function oa(v){return v!==v}function ua(v,x){var b=v==null?0:v.length;return b?pi(v,x)/b:bn}function hi(v){return function(x){return x==null?r:x[v]}}function ci(v){return function(x){return v==null?r:v[x]}}function la(v,x,b,k,z){return z(v,function(rt,Ct,at){b=k?(k=!1,rt):x(b,rt,Ct,at)}),b}function zl(v,x){var b=v.length;for(v.sort(x);b--;)v[b]=v[b].value;return v}function pi(v,x){for(var b,k=-1,z=v.length;++k<z;){var rt=x(v[k]);rt!==r&&(b=b===r?rt:b+rt)}return b}function gi(v,x){for(var b=-1,k=Array(v);++b<v;)k[b]=x(b);return k}function Hl(v,x){return gt(x,function(b){return[b,v[b]]})}function fa(v){return v&&v.slice(0,ga(v)+1).replace(ti,"")}function Zt(v){return function(x){return v(x)}}function di(v,x){return gt(x,function(b){return v[b]})}function Se(v,x){return v.has(x)}function ha(v,x){for(var b=-1,k=v.length;++b<k&&ie(x,v[b],0)>-1;);return b}function ca(v,x){for(var b=v.length;b--&&ie(x,v[b],0)>-1;);return b}function ql(v,x){for(var b=v.length,k=0;b--;)v[b]===x&&++k;return k}var Kl=ci(El),Vl=ci(Tl);function Zl(v){return"\\"+Fl[v]}function Jl(v,x){return v==null?r:v[x]}function se(v){return xl.test(v)}function Yl(v){return Al.test(v)}function Xl(v){for(var x,b=[];!(x=v.next()).done;)b.push(x.value);return b}function _i(v){var x=-1,b=Array(v.size);return v.forEach(function(k,z){b[++x]=[z,k]}),b}function pa(v,x){return function(b){return v(x(b))}}function Nn(v,x){for(var b=-1,k=v.length,z=0,rt=[];++b<k;){var Ct=v[b];(Ct===x||Ct===S)&&(v[b]=S,rt[z++]=b)}return rt}function Je(v){var x=-1,b=Array(v.size);return v.forEach(function(k){b[++x]=k}),b}function Ql(v){var x=-1,b=Array(v.size);return v.forEach(function(k){b[++x]=[k,k]}),b}function jl(v,x,b){for(var k=b-1,z=v.length;++k<z;)if(v[k]===x)return k;return-1}function tf(v,x,b){for(var k=b+1;k--;)if(v[k]===x)return k;return k}function ae(v){return se(v)?ef(v):Bl(v)}function cn(v){return se(v)?rf(v):Ul(v)}function ga(v){for(var x=v.length;x--&&qu.test(v.charAt(x)););return x}var nf=ci(Rl);function ef(v){for(var x=si.lastIndex=0;si.test(v);)++x;return x}function rf(v){return v.match(si)||[]}function sf(v){return v.match(bl)||[]}var af=function v(x){x=x==null?Pt:oe.defaults(Pt.Object(),x,oe.pick(Pt,Il));var b=x.Array,k=x.Date,z=x.Error,rt=x.Function,Ct=x.Math,at=x.Object,vi=x.RegExp,of=x.String,rn=x.TypeError,Ye=b.prototype,uf=rt.prototype,ue=at.prototype,Xe=x["__core-js_shared__"],Qe=uf.toString,st=ue.hasOwnProperty,lf=0,da=function(){var t=/[^.]+$/.exec(Xe&&Xe.keys&&Xe.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),je=ue.toString,ff=Qe.call(at),hf=Pt._,cf=vi("^"+Qe.call(st).replace(jr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tr=Qs?x.Buffer:r,Wn=x.Symbol,nr=x.Uint8Array,_a=tr?tr.allocUnsafe:r,er=pa(at.getPrototypeOf,at),va=at.create,ma=ue.propertyIsEnumerable,rr=Ye.splice,wa=Wn?Wn.isConcatSpreadable:r,be=Wn?Wn.iterator:r,Zn=Wn?Wn.toStringTag:r,ir=function(){try{var t=jn(at,"defineProperty");return t({},"",{}),t}catch{}}(),pf=x.clearTimeout!==Pt.clearTimeout&&x.clearTimeout,gf=k&&k.now!==Pt.Date.now&&k.now,df=x.setTimeout!==Pt.setTimeout&&x.setTimeout,sr=Ct.ceil,ar=Ct.floor,mi=at.getOwnPropertySymbols,_f=tr?tr.isBuffer:r,ya=x.isFinite,vf=Ye.join,mf=pa(at.keys,at),St=Ct.max,Tt=Ct.min,wf=k.now,yf=x.parseInt,Ma=Ct.random,Mf=Ye.reverse,wi=jn(x,"DataView"),xe=jn(x,"Map"),yi=jn(x,"Promise"),le=jn(x,"Set"),Ae=jn(x,"WeakMap"),Ie=jn(at,"create"),or=Ae&&new Ae,fe={},Cf=te(wi),Sf=te(xe),bf=te(yi),xf=te(le),Af=te(Ae),ur=Wn?Wn.prototype:r,Pe=ur?ur.valueOf:r,Ca=ur?ur.toString:r;function u(t){if(vt(t)&&!H(t)&&!(t instanceof j)){if(t instanceof sn)return t;if(st.call(t,"__wrapped__"))return bo(t)}return new sn(t)}var he=function(){function t(){}return function(n){if(!dt(n))return{};if(va)return va(n);t.prototype=n;var e=new t;return t.prototype=r,e}}();function lr(){}function sn(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}u.templateSettings={escape:Bu,evaluate:Uu,interpolate:Rs,variable:"",imports:{_:u}},u.prototype=lr.prototype,u.prototype.constructor=u,sn.prototype=he(lr.prototype),sn.prototype.constructor=sn;function j(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=L,this.__views__=[]}function If(){var t=new j(this.__wrapped__);return t.__actions__=Ut(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ut(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ut(this.__views__),t}function Pf(){if(this.__filtered__){var t=new j(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Ef(){var t=this.__wrapped__.value(),n=this.__dir__,e=H(t),i=n<0,a=e?t.length:0,l=$h(0,a,this.__views__),c=l.start,g=l.end,w=g-c,A=i?g:c-1,I=this.__iteratees__,P=I.length,R=0,D=Tt(w,this.__takeCount__);if(!e||!i&&a==w&&D==w)return Ka(t,this.__actions__);var B=[];t:for(;w--&&R<D;){A+=n;for(var Z=-1,U=t[A];++Z<P;){var Q=I[Z],tt=Q.iteratee,Xt=Q.type,Dt=tt(U);if(Xt==$e)U=Dt;else if(!Dt){if(Xt==ye)continue t;break t}}B[R++]=U}return B}j.prototype=he(lr.prototype),j.prototype.constructor=j;function Jn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var i=t[n];this.set(i[0],i[1])}}function Tf(){this.__data__=Ie?Ie(null):{},this.size=0}function Rf(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function Ff(t){var n=this.__data__;if(Ie){var e=n[t];return e===y?r:e}return st.call(n,t)?n[t]:r}function Lf(t){var n=this.__data__;return Ie?n[t]!==r:st.call(n,t)}function kf(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=Ie&&n===r?y:n,this}Jn.prototype.clear=Tf,Jn.prototype.delete=Rf,Jn.prototype.get=Ff,Jn.prototype.has=Lf,Jn.prototype.set=kf;function xn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var i=t[n];this.set(i[0],i[1])}}function Of(){this.__data__=[],this.size=0}function Df(t){var n=this.__data__,e=fr(n,t);if(e<0)return!1;var i=n.length-1;return e==i?n.pop():rr.call(n,e,1),--this.size,!0}function Nf(t){var n=this.__data__,e=fr(n,t);return e<0?r:n[e][1]}function Wf(t){return fr(this.__data__,t)>-1}function Bf(t,n){var e=this.__data__,i=fr(e,t);return i<0?(++this.size,e.push([t,n])):e[i][1]=n,this}xn.prototype.clear=Of,xn.prototype.delete=Df,xn.prototype.get=Nf,xn.prototype.has=Wf,xn.prototype.set=Bf;function An(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var i=t[n];this.set(i[0],i[1])}}function Uf(){this.size=0,this.__data__={hash:new Jn,map:new(xe||xn),string:new Jn}}function $f(t){var n=Cr(this,t).delete(t);return this.size-=n?1:0,n}function Gf(t){return Cr(this,t).get(t)}function zf(t){return Cr(this,t).has(t)}function Hf(t,n){var e=Cr(this,t),i=e.size;return e.set(t,n),this.size+=e.size==i?0:1,this}An.prototype.clear=Uf,An.prototype.delete=$f,An.prototype.get=Gf,An.prototype.has=zf,An.prototype.set=Hf;function Yn(t){var n=-1,e=t==null?0:t.length;for(this.__data__=new An;++n<e;)this.add(t[n])}function qf(t){return this.__data__.set(t,y),this}function Kf(t){return this.__data__.has(t)}Yn.prototype.add=Yn.prototype.push=qf,Yn.prototype.has=Kf;function pn(t){var n=this.__data__=new xn(t);this.size=n.size}function Vf(){this.__data__=new xn,this.size=0}function Zf(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e}function Jf(t){return this.__data__.get(t)}function Yf(t){return this.__data__.has(t)}function Xf(t,n){var e=this.__data__;if(e instanceof xn){var i=e.__data__;if(!xe||i.length<f-1)return i.push([t,n]),this.size=++e.size,this;e=this.__data__=new An(i)}return e.set(t,n),this.size=e.size,this}pn.prototype.clear=Vf,pn.prototype.delete=Zf,pn.prototype.get=Jf,pn.prototype.has=Yf,pn.prototype.set=Xf;function Sa(t,n){var e=H(t),i=!e&&ne(t),a=!e&&!i&&zn(t),l=!e&&!i&&!a&&de(t),c=e||i||a||l,g=c?gi(t.length,of):[],w=g.length;for(var A in t)(n||st.call(t,A))&&!(c&&(A=="length"||a&&(A=="offset"||A=="parent")||l&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||Tn(A,w)))&&g.push(A);return g}function ba(t){var n=t.length;return n?t[Ri(0,n-1)]:r}function Qf(t,n){return Sr(Ut(t),Xn(n,0,t.length))}function jf(t){return Sr(Ut(t))}function Mi(t,n,e){(e!==r&&!gn(t[n],e)||e===r&&!(n in t))&&In(t,n,e)}function Ee(t,n,e){var i=t[n];(!(st.call(t,n)&&gn(i,e))||e===r&&!(n in t))&&In(t,n,e)}function fr(t,n){for(var e=t.length;e--;)if(gn(t[e][0],n))return e;return-1}function th(t,n,e,i){return Bn(t,function(a,l,c){n(i,a,e(a),c)}),i}function xa(t,n){return t&&Mn(n,xt(n),t)}function nh(t,n){return t&&Mn(n,Gt(n),t)}function In(t,n,e){n=="__proto__"&&ir?ir(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e}function Ci(t,n){for(var e=-1,i=n.length,a=b(i),l=t==null;++e<i;)a[e]=l?r:es(t,n[e]);return a}function Xn(t,n,e){return t===t&&(e!==r&&(t=t<=e?t:e),n!==r&&(t=t>=n?t:n)),t}function an(t,n,e,i,a,l){var c,g=n&m,w=n&T,A=n&O;if(e&&(c=a?e(t,i,a,l):e(t)),c!==r)return c;if(!dt(t))return t;var I=H(t);if(I){if(c=zh(t),!g)return Ut(t,c)}else{var P=Rt(t),R=P==Wt||P==mn;if(zn(t))return Ja(t,g);if(P==Mt||P==nt||R&&!a){if(c=w||R?{}:go(t),!g)return w?Fh(t,nh(c,t)):Rh(t,xa(c,t))}else{if(!ut[P])return a?t:{};c=Hh(t,P,g)}}l||(l=new pn);var D=l.get(t);if(D)return D;l.set(t,c),Ho(t)?t.forEach(function(U){c.add(an(U,n,e,U,t,l))}):Go(t)&&t.forEach(function(U,Q){c.set(Q,an(U,n,e,Q,t,l))});var B=A?w?Gi:$i:w?Gt:xt,Z=I?r:B(t);return en(Z||t,function(U,Q){Z&&(Q=U,U=t[Q]),Ee(c,Q,an(U,n,e,Q,t,l))}),c}function eh(t){var n=xt(t);return function(e){return Aa(e,t,n)}}function Aa(t,n,e){var i=e.length;if(t==null)return!i;for(t=at(t);i--;){var a=e[i],l=n[a],c=t[a];if(c===r&&!(a in t)||!l(c))return!1}return!0}function Ia(t,n,e){if(typeof t!="function")throw new rn(d);return De(function(){t.apply(r,e)},n)}function Te(t,n,e,i){var a=-1,l=Ve,c=!0,g=t.length,w=[],A=n.length;if(!g)return w;e&&(n=gt(n,Zt(e))),i?(l=ui,c=!1):n.length>=f&&(l=Se,c=!1,n=new Yn(n));t:for(;++a<g;){var I=t[a],P=e==null?I:e(I);if(I=i||I!==0?I:0,c&&P===P){for(var R=A;R--;)if(n[R]===P)continue t;w.push(I)}else l(n,P,i)||w.push(I)}return w}var Bn=to(yn),Pa=to(bi,!0);function rh(t,n){var e=!0;return Bn(t,function(i,a,l){return e=!!n(i,a,l),e}),e}function hr(t,n,e){for(var i=-1,a=t.length;++i<a;){var l=t[i],c=n(l);if(c!=null&&(g===r?c===c&&!Yt(c):e(c,g)))var g=c,w=l}return w}function ih(t,n,e,i){var a=t.length;for(e=V(e),e<0&&(e=-e>a?0:a+e),i=i===r||i>a?a:V(i),i<0&&(i+=a),i=e>i?0:Ko(i);e<i;)t[e++]=n;return t}function Ea(t,n){var e=[];return Bn(t,function(i,a,l){n(i,a,l)&&e.push(i)}),e}function Et(t,n,e,i,a){var l=-1,c=t.length;for(e||(e=Kh),a||(a=[]);++l<c;){var g=t[l];n>0&&e(g)?n>1?Et(g,n-1,e,i,a):Dn(a,g):i||(a[a.length]=g)}return a}var Si=no(),Ta=no(!0);function yn(t,n){return t&&Si(t,n,xt)}function bi(t,n){return t&&Ta(t,n,xt)}function cr(t,n){return On(n,function(e){return Rn(t[e])})}function Qn(t,n){n=$n(n,t);for(var e=0,i=n.length;t!=null&&e<i;)t=t[Cn(n[e++])];return e&&e==i?t:r}function Ra(t,n,e){var i=n(t);return H(t)?i:Dn(i,e(t))}function kt(t){return t==null?t===r?Fu:kn:Zn&&Zn in at(t)?Uh(t):jh(t)}function xi(t,n){return t>n}function sh(t,n){return t!=null&&st.call(t,n)}function ah(t,n){return t!=null&&n in at(t)}function oh(t,n,e){return t>=Tt(n,e)&&t<St(n,e)}function Ai(t,n,e){for(var i=e?ui:Ve,a=t[0].length,l=t.length,c=l,g=b(l),w=1/0,A=[];c--;){var I=t[c];c&&n&&(I=gt(I,Zt(n))),w=Tt(I.length,w),g[c]=!e&&(n||a>=120&&I.length>=120)?new Yn(c&&I):r}I=t[0];var P=-1,R=g[0];t:for(;++P<a&&A.length<w;){var D=I[P],B=n?n(D):D;if(D=e||D!==0?D:0,!(R?Se(R,B):i(A,B,e))){for(c=l;--c;){var Z=g[c];if(!(Z?Se(Z,B):i(t[c],B,e)))continue t}R&&R.push(B),A.push(D)}}return A}function uh(t,n,e,i){return yn(t,function(a,l,c){n(i,e(a),l,c)}),i}function Re(t,n,e){n=$n(n,t),t=wo(t,n);var i=t==null?t:t[Cn(un(n))];return i==null?r:Vt(i,t,e)}function Fa(t){return vt(t)&&kt(t)==nt}function lh(t){return vt(t)&&kt(t)==Ce}function fh(t){return vt(t)&&kt(t)==yt}function Fe(t,n,e,i,a){return t===n?!0:t==null||n==null||!vt(t)&&!vt(n)?t!==t&&n!==n:hh(t,n,e,i,Fe,a)}function hh(t,n,e,i,a,l){var c=H(t),g=H(n),w=c?ct:Rt(t),A=g?ct:Rt(n);w=w==nt?Mt:w,A=A==nt?Mt:A;var I=w==Mt,P=A==Mt,R=w==A;if(R&&zn(t)){if(!zn(n))return!1;c=!0,I=!1}if(R&&!I)return l||(l=new pn),c||de(t)?ho(t,n,e,i,a,l):Wh(t,n,w,e,i,a,l);if(!(e&F)){var D=I&&st.call(t,"__wrapped__"),B=P&&st.call(n,"__wrapped__");if(D||B){var Z=D?t.value():t,U=B?n.value():n;return l||(l=new pn),a(Z,U,e,i,l)}}return R?(l||(l=new pn),Bh(t,n,e,i,a,l)):!1}function ch(t){return vt(t)&&Rt(t)==_t}function Ii(t,n,e,i){var a=e.length,l=a,c=!i;if(t==null)return!l;for(t=at(t);a--;){var g=e[a];if(c&&g[2]?g[1]!==t[g[0]]:!(g[0]in t))return!1}for(;++a<l;){g=e[a];var w=g[0],A=t[w],I=g[1];if(c&&g[2]){if(A===r&&!(w in t))return!1}else{var P=new pn;if(i)var R=i(A,I,w,t,n,P);if(!(R===r?Fe(I,A,F|E,i,P):R))return!1}}return!0}function La(t){if(!dt(t)||Zh(t))return!1;var n=Rn(t)?cf:nl;return n.test(te(t))}function ph(t){return vt(t)&&kt(t)==tn}function gh(t){return vt(t)&&Rt(t)==pt}function dh(t){return vt(t)&&Er(t.length)&&!!ft[kt(t)]}function ka(t){return typeof t=="function"?t:t==null?zt:typeof t=="object"?H(t)?Na(t[0],t[1]):Da(t):ru(t)}function Pi(t){if(!Oe(t))return mf(t);var n=[];for(var e in at(t))st.call(t,e)&&e!="constructor"&&n.push(e);return n}function _h(t){if(!dt(t))return Qh(t);var n=Oe(t),e=[];for(var i in t)i=="constructor"&&(n||!st.call(t,i))||e.push(i);return e}function Ei(t,n){return t<n}function Oa(t,n){var e=-1,i=$t(t)?b(t.length):[];return Bn(t,function(a,l,c){i[++e]=n(a,l,c)}),i}function Da(t){var n=Hi(t);return n.length==1&&n[0][2]?vo(n[0][0],n[0][1]):function(e){return e===t||Ii(e,t,n)}}function Na(t,n){return Ki(t)&&_o(n)?vo(Cn(t),n):function(e){var i=es(e,t);return i===r&&i===n?rs(e,t):Fe(n,i,F|E)}}function pr(t,n,e,i,a){t!==n&&Si(n,function(l,c){if(a||(a=new pn),dt(l))vh(t,n,c,e,pr,i,a);else{var g=i?i(Zi(t,c),l,c+"",t,n,a):r;g===r&&(g=l),Mi(t,c,g)}},Gt)}function vh(t,n,e,i,a,l,c){var g=Zi(t,e),w=Zi(n,e),A=c.get(w);if(A){Mi(t,e,A);return}var I=l?l(g,w,e+"",t,n,c):r,P=I===r;if(P){var R=H(w),D=!R&&zn(w),B=!R&&!D&&de(w);I=w,R||D||B?H(g)?I=g:mt(g)?I=Ut(g):D?(P=!1,I=Ja(w,!0)):B?(P=!1,I=Ya(w,!0)):I=[]:Ne(w)||ne(w)?(I=g,ne(g)?I=Vo(g):(!dt(g)||Rn(g))&&(I=go(w))):P=!1}P&&(c.set(w,I),a(I,w,i,l,c),c.delete(w)),Mi(t,e,I)}function Wa(t,n){var e=t.length;if(e)return n+=n<0?e:0,Tn(n,e)?t[n]:r}function Ba(t,n,e){n.length?n=gt(n,function(l){return H(l)?function(c){return Qn(c,l.length===1?l[0]:l)}:l}):n=[zt];var i=-1;n=gt(n,Zt(W()));var a=Oa(t,function(l,c,g){var w=gt(n,function(A){return A(l)});return{criteria:w,index:++i,value:l}});return zl(a,function(l,c){return Th(l,c,e)})}function mh(t,n){return Ua(t,n,function(e,i){return rs(t,i)})}function Ua(t,n,e){for(var i=-1,a=n.length,l={};++i<a;){var c=n[i],g=Qn(t,c);e(g,c)&&Le(l,$n(c,t),g)}return l}function wh(t){return function(n){return Qn(n,t)}}function Ti(t,n,e,i){var a=i?Gl:ie,l=-1,c=n.length,g=t;for(t===n&&(n=Ut(n)),e&&(g=gt(t,Zt(e)));++l<c;)for(var w=0,A=n[l],I=e?e(A):A;(w=a(g,I,w,i))>-1;)g!==t&&rr.call(g,w,1),rr.call(t,w,1);return t}function $a(t,n){for(var e=t?n.length:0,i=e-1;e--;){var a=n[e];if(e==i||a!==l){var l=a;Tn(a)?rr.call(t,a,1):ki(t,a)}}return t}function Ri(t,n){return t+ar(Ma()*(n-t+1))}function yh(t,n,e,i){for(var a=-1,l=St(sr((n-t)/(e||1)),0),c=b(l);l--;)c[i?l:++a]=t,t+=e;return c}function Fi(t,n){var e="";if(!t||n<1||n>vn)return e;do n%2&&(e+=t),n=ar(n/2),n&&(t+=t);while(n);return e}function J(t,n){return Ji(mo(t,n,zt),t+"")}function Mh(t){return ba(_e(t))}function Ch(t,n){var e=_e(t);return Sr(e,Xn(n,0,e.length))}function Le(t,n,e,i){if(!dt(t))return t;n=$n(n,t);for(var a=-1,l=n.length,c=l-1,g=t;g!=null&&++a<l;){var w=Cn(n[a]),A=e;if(w==="__proto__"||w==="constructor"||w==="prototype")return t;if(a!=c){var I=g[w];A=i?i(I,w,g):r,A===r&&(A=dt(I)?I:Tn(n[a+1])?[]:{})}Ee(g,w,A),g=g[w]}return t}var Ga=or?function(t,n){return or.set(t,n),t}:zt,Sh=ir?function(t,n){return ir(t,"toString",{configurable:!0,enumerable:!1,value:ss(n),writable:!0})}:zt;function bh(t){return Sr(_e(t))}function on(t,n,e){var i=-1,a=t.length;n<0&&(n=-n>a?0:a+n),e=e>a?a:e,e<0&&(e+=a),a=n>e?0:e-n>>>0,n>>>=0;for(var l=b(a);++i<a;)l[i]=t[i+n];return l}function xh(t,n){var e;return Bn(t,function(i,a,l){return e=n(i,a,l),!e}),!!e}function gr(t,n,e){var i=0,a=t==null?i:t.length;if(typeof n=="number"&&n===n&&a<=G){for(;i<a;){var l=i+a>>>1,c=t[l];c!==null&&!Yt(c)&&(e?c<=n:c<n)?i=l+1:a=l}return a}return Li(t,n,zt,e)}function Li(t,n,e,i){var a=0,l=t==null?0:t.length;if(l===0)return 0;n=e(n);for(var c=n!==n,g=n===null,w=Yt(n),A=n===r;a<l;){var I=ar((a+l)/2),P=e(t[I]),R=P!==r,D=P===null,B=P===P,Z=Yt(P);if(c)var U=i||B;else A?U=B&&(i||R):g?U=B&&R&&(i||!D):w?U=B&&R&&!D&&(i||!Z):D||Z?U=!1:U=i?P<=n:P<n;U?a=I+1:l=I}return Tt(l,$)}function za(t,n){for(var e=-1,i=t.length,a=0,l=[];++e<i;){var c=t[e],g=n?n(c):c;if(!e||!gn(g,w)){var w=g;l[a++]=c===0?0:c}}return l}function Ha(t){return typeof t=="number"?t:Yt(t)?bn:+t}function Jt(t){if(typeof t=="string")return t;if(H(t))return gt(t,Jt)+"";if(Yt(t))return Ca?Ca.call(t):"";var n=t+"";return n=="0"&&1/t==-Sn?"-0":n}function Un(t,n,e){var i=-1,a=Ve,l=t.length,c=!0,g=[],w=g;if(e)c=!1,a=ui;else if(l>=f){var A=n?null:Dh(t);if(A)return Je(A);c=!1,a=Se,w=new Yn}else w=n?[]:g;t:for(;++i<l;){var I=t[i],P=n?n(I):I;if(I=e||I!==0?I:0,c&&P===P){for(var R=w.length;R--;)if(w[R]===P)continue t;n&&w.push(P),g.push(I)}else a(w,P,e)||(w!==g&&w.push(P),g.push(I))}return g}function ki(t,n){return n=$n(n,t),t=wo(t,n),t==null||delete t[Cn(un(n))]}function qa(t,n,e,i){return Le(t,n,e(Qn(t,n)),i)}function dr(t,n,e,i){for(var a=t.length,l=i?a:-1;(i?l--:++l<a)&&n(t[l],l,t););return e?on(t,i?0:l,i?l+1:a):on(t,i?l+1:0,i?a:l)}function Ka(t,n){var e=t;return e instanceof j&&(e=e.value()),li(n,function(i,a){return a.func.apply(a.thisArg,Dn([i],a.args))},e)}function Oi(t,n,e){var i=t.length;if(i<2)return i?Un(t[0]):[];for(var a=-1,l=b(i);++a<i;)for(var c=t[a],g=-1;++g<i;)g!=a&&(l[a]=Te(l[a]||c,t[g],n,e));return Un(Et(l,1),n,e)}function Va(t,n,e){for(var i=-1,a=t.length,l=n.length,c={};++i<a;){var g=i<l?n[i]:r;e(c,t[i],g)}return c}function Di(t){return mt(t)?t:[]}function Ni(t){return typeof t=="function"?t:zt}function $n(t,n){return H(t)?t:Ki(t,n)?[t]:So(it(t))}var Ah=J;function Gn(t,n,e){var i=t.length;return e=e===r?i:e,!n&&e>=i?t:on(t,n,e)}var Za=pf||function(t){return Pt.clearTimeout(t)};function Ja(t,n){if(n)return t.slice();var e=t.length,i=_a?_a(e):new t.constructor(e);return t.copy(i),i}function Wi(t){var n=new t.constructor(t.byteLength);return new nr(n).set(new nr(t)),n}function Ih(t,n){var e=n?Wi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function Ph(t){var n=new t.constructor(t.source,Fs.exec(t));return n.lastIndex=t.lastIndex,n}function Eh(t){return Pe?at(Pe.call(t)):{}}function Ya(t,n){var e=n?Wi(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function Xa(t,n){if(t!==n){var e=t!==r,i=t===null,a=t===t,l=Yt(t),c=n!==r,g=n===null,w=n===n,A=Yt(n);if(!g&&!A&&!l&&t>n||l&&c&&w&&!g&&!A||i&&c&&w||!e&&w||!a)return 1;if(!i&&!l&&!A&&t<n||A&&e&&a&&!i&&!l||g&&e&&a||!c&&a||!w)return-1}return 0}function Th(t,n,e){for(var i=-1,a=t.criteria,l=n.criteria,c=a.length,g=e.length;++i<c;){var w=Xa(a[i],l[i]);if(w){if(i>=g)return w;var A=e[i];return w*(A=="desc"?-1:1)}}return t.index-n.index}function Qa(t,n,e,i){for(var a=-1,l=t.length,c=e.length,g=-1,w=n.length,A=St(l-c,0),I=b(w+A),P=!i;++g<w;)I[g]=n[g];for(;++a<c;)(P||a<l)&&(I[e[a]]=t[a]);for(;A--;)I[g++]=t[a++];return I}function ja(t,n,e,i){for(var a=-1,l=t.length,c=-1,g=e.length,w=-1,A=n.length,I=St(l-g,0),P=b(I+A),R=!i;++a<I;)P[a]=t[a];for(var D=a;++w<A;)P[D+w]=n[w];for(;++c<g;)(R||a<l)&&(P[D+e[c]]=t[a++]);return P}function Ut(t,n){var e=-1,i=t.length;for(n||(n=b(i));++e<i;)n[e]=t[e];return n}function Mn(t,n,e,i){var a=!e;e||(e={});for(var l=-1,c=n.length;++l<c;){var g=n[l],w=i?i(e[g],t[g],g,e,t):r;w===r&&(w=t[g]),a?In(e,g,w):Ee(e,g,w)}return e}function Rh(t,n){return Mn(t,qi(t),n)}function Fh(t,n){return Mn(t,co(t),n)}function _r(t,n){return function(e,i){var a=H(e)?Dl:th,l=n?n():{};return a(e,t,W(i,2),l)}}function ce(t){return J(function(n,e){var i=-1,a=e.length,l=a>1?e[a-1]:r,c=a>2?e[2]:r;for(l=t.length>3&&typeof l=="function"?(a--,l):r,c&&Ot(e[0],e[1],c)&&(l=a<3?r:l,a=1),n=at(n);++i<a;){var g=e[i];g&&t(n,g,i,l)}return n})}function to(t,n){return function(e,i){if(e==null)return e;if(!$t(e))return t(e,i);for(var a=e.length,l=n?a:-1,c=at(e);(n?l--:++l<a)&&i(c[l],l,c)!==!1;);return e}}function no(t){return function(n,e,i){for(var a=-1,l=at(n),c=i(n),g=c.length;g--;){var w=c[t?g:++a];if(e(l[w],w,l)===!1)break}return n}}function Lh(t,n,e){var i=n&N,a=ke(t);function l(){var c=this&&this!==Pt&&this instanceof l?a:t;return c.apply(i?e:this,arguments)}return l}function eo(t){return function(n){n=it(n);var e=se(n)?cn(n):r,i=e?e[0]:n.charAt(0),a=e?Gn(e,1).join(""):n.slice(1);return i[t]()+a}}function pe(t){return function(n){return li(nu(tu(n).replace(Cl,"")),t,"")}}function ke(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var e=he(t.prototype),i=t.apply(e,n);return dt(i)?i:e}}function kh(t,n,e){var i=ke(t);function a(){for(var l=arguments.length,c=b(l),g=l,w=ge(a);g--;)c[g]=arguments[g];var A=l<3&&c[0]!==w&&c[l-1]!==w?[]:Nn(c,w);if(l-=A.length,l<e)return oo(t,n,vr,a.placeholder,r,c,A,r,r,e-l);var I=this&&this!==Pt&&this instanceof a?i:t;return Vt(I,this,c)}return a}function ro(t){return function(n,e,i){var a=at(n);if(!$t(n)){var l=W(e,3);n=xt(n),e=function(g){return l(a[g],g,a)}}var c=t(n,e,i);return c>-1?a[l?n[c]:c]:r}}function io(t){return En(function(n){var e=n.length,i=e,a=sn.prototype.thru;for(t&&n.reverse();i--;){var l=n[i];if(typeof l!="function")throw new rn(d);if(a&&!c&&Mr(l)=="wrapper")var c=new sn([],!0)}for(i=c?i:e;++i<e;){l=n[i];var g=Mr(l),w=g=="wrapper"?zi(l):r;w&&Vi(w[0])&&w[1]==(It|X|bt|Ht)&&!w[4].length&&w[9]==1?c=c[Mr(w[0])].apply(c,w[3]):c=l.length==1&&Vi(l)?c[g]():c.thru(l)}return function(){var A=arguments,I=A[0];if(c&&A.length==1&&H(I))return c.plant(I).value();for(var P=0,R=e?n[P].apply(this,A):I;++P<e;)R=n[P].call(this,R);return R}})}function vr(t,n,e,i,a,l,c,g,w,A){var I=n&It,P=n&N,R=n&K,D=n&(X|et),B=n&jt,Z=R?r:ke(t);function U(){for(var Q=arguments.length,tt=b(Q),Xt=Q;Xt--;)tt[Xt]=arguments[Xt];if(D)var Dt=ge(U),Qt=ql(tt,Dt);if(i&&(tt=Qa(tt,i,a,D)),l&&(tt=ja(tt,l,c,D)),Q-=Qt,D&&Q<A){var wt=Nn(tt,Dt);return oo(t,n,vr,U.placeholder,e,tt,wt,g,w,A-Q)}var dn=P?e:this,Ln=R?dn[t]:t;return Q=tt.length,g?tt=tc(tt,g):B&&Q>1&&tt.reverse(),I&&w<Q&&(tt.length=w),this&&this!==Pt&&this instanceof U&&(Ln=Z||ke(Ln)),Ln.apply(dn,tt)}return U}function so(t,n){return function(e,i){return uh(e,t,n(i),{})}}function mr(t,n){return function(e,i){var a;if(e===r&&i===r)return n;if(e!==r&&(a=e),i!==r){if(a===r)return i;typeof e=="string"||typeof i=="string"?(e=Jt(e),i=Jt(i)):(e=Ha(e),i=Ha(i)),a=t(e,i)}return a}}function Bi(t){return En(function(n){return n=gt(n,Zt(W())),J(function(e){var i=this;return t(n,function(a){return Vt(a,i,e)})})})}function wr(t,n){n=n===r?" ":Jt(n);var e=n.length;if(e<2)return e?Fi(n,t):n;var i=Fi(n,sr(t/ae(n)));return se(n)?Gn(cn(i),0,t).join(""):i.slice(0,t)}function Oh(t,n,e,i){var a=n&N,l=ke(t);function c(){for(var g=-1,w=arguments.length,A=-1,I=i.length,P=b(I+w),R=this&&this!==Pt&&this instanceof c?l:t;++A<I;)P[A]=i[A];for(;w--;)P[A++]=arguments[++g];return Vt(R,a?e:this,P)}return c}function ao(t){return function(n,e,i){return i&&typeof i!="number"&&Ot(n,e,i)&&(e=i=r),n=Fn(n),e===r?(e=n,n=0):e=Fn(e),i=i===r?n<e?1:-1:Fn(i),yh(n,e,i,t)}}function yr(t){return function(n,e){return typeof n=="string"&&typeof e=="string"||(n=ln(n),e=ln(e)),t(n,e)}}function oo(t,n,e,i,a,l,c,g,w,A){var I=n&X,P=I?c:r,R=I?r:c,D=I?l:r,B=I?r:l;n|=I?bt:At,n&=~(I?At:bt),n&Y||(n&=~(N|K));var Z=[t,n,a,D,P,B,R,g,w,A],U=e.apply(r,Z);return Vi(t)&&yo(U,Z),U.placeholder=i,Mo(U,t,n)}function Ui(t){var n=Ct[t];return function(e,i){if(e=ln(e),i=i==null?0:Tt(V(i),292),i&&ya(e)){var a=(it(e)+"e").split("e"),l=n(a[0]+"e"+(+a[1]+i));return a=(it(l)+"e").split("e"),+(a[0]+"e"+(+a[1]-i))}return n(e)}}var Dh=le&&1/Je(new le([,-0]))[1]==Sn?function(t){return new le(t)}:us;function uo(t){return function(n){var e=Rt(n);return e==_t?_i(n):e==pt?Ql(n):Hl(n,t(n))}}function Pn(t,n,e,i,a,l,c,g){var w=n&K;if(!w&&typeof t!="function")throw new rn(d);var A=i?i.length:0;if(A||(n&=~(bt|At),i=a=r),c=c===r?c:St(V(c),0),g=g===r?g:V(g),A-=a?a.length:0,n&At){var I=i,P=a;i=a=r}var R=w?r:zi(t),D=[t,n,e,i,a,I,P,l,c,g];if(R&&Xh(D,R),t=D[0],n=D[1],e=D[2],i=D[3],a=D[4],g=D[9]=D[9]===r?w?0:t.length:St(D[9]-A,0),!g&&n&(X|et)&&(n&=~(X|et)),!n||n==N)var B=Lh(t,n,e);else n==X||n==et?B=kh(t,n,g):(n==bt||n==(N|bt))&&!a.length?B=Oh(t,n,e,i):B=vr.apply(r,D);var Z=R?Ga:yo;return Mo(Z(B,D),t,n)}function lo(t,n,e,i){return t===r||gn(t,ue[e])&&!st.call(i,e)?n:t}function fo(t,n,e,i,a,l){return dt(t)&&dt(n)&&(l.set(n,t),pr(t,n,r,fo,l),l.delete(n)),t}function Nh(t){return Ne(t)?r:t}function ho(t,n,e,i,a,l){var c=e&F,g=t.length,w=n.length;if(g!=w&&!(c&&w>g))return!1;var A=l.get(t),I=l.get(n);if(A&&I)return A==n&&I==t;var P=-1,R=!0,D=e&E?new Yn:r;for(l.set(t,n),l.set(n,t);++P<g;){var B=t[P],Z=n[P];if(i)var U=c?i(Z,B,P,n,t,l):i(B,Z,P,t,n,l);if(U!==r){if(U)continue;R=!1;break}if(D){if(!fi(n,function(Q,tt){if(!Se(D,tt)&&(B===Q||a(B,Q,e,i,l)))return D.push(tt)})){R=!1;break}}else if(!(B===Z||a(B,Z,e,i,l))){R=!1;break}}return l.delete(t),l.delete(n),R}function Wh(t,n,e,i,a,l,c){switch(e){case ee:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case Ce:return!(t.byteLength!=n.byteLength||!l(new nr(t),new nr(n)));case lt:case yt:case Lt:return gn(+t,+n);case Ft:return t.name==n.name&&t.message==n.message;case tn:case wn:return t==n+"";case _t:var g=_i;case pt:var w=i&F;if(g||(g=Je),t.size!=n.size&&!w)return!1;var A=c.get(t);if(A)return A==n;i|=E,c.set(t,n);var I=ho(g(t),g(n),i,a,l,c);return c.delete(t),I;case ze:if(Pe)return Pe.call(t)==Pe.call(n)}return!1}function Bh(t,n,e,i,a,l){var c=e&F,g=$i(t),w=g.length,A=$i(n),I=A.length;if(w!=I&&!c)return!1;for(var P=w;P--;){var R=g[P];if(!(c?R in n:st.call(n,R)))return!1}var D=l.get(t),B=l.get(n);if(D&&B)return D==n&&B==t;var Z=!0;l.set(t,n),l.set(n,t);for(var U=c;++P<w;){R=g[P];var Q=t[R],tt=n[R];if(i)var Xt=c?i(tt,Q,R,n,t,l):i(Q,tt,R,t,n,l);if(!(Xt===r?Q===tt||a(Q,tt,e,i,l):Xt)){Z=!1;break}U||(U=R=="constructor")}if(Z&&!U){var Dt=t.constructor,Qt=n.constructor;Dt!=Qt&&"constructor"in t&&"constructor"in n&&!(typeof Dt=="function"&&Dt instanceof Dt&&typeof Qt=="function"&&Qt instanceof Qt)&&(Z=!1)}return l.delete(t),l.delete(n),Z}function En(t){return Ji(mo(t,r,Io),t+"")}function $i(t){return Ra(t,xt,qi)}function Gi(t){return Ra(t,Gt,co)}var zi=or?function(t){return or.get(t)}:us;function Mr(t){for(var n=t.name+"",e=fe[n],i=st.call(fe,n)?e.length:0;i--;){var a=e[i],l=a.func;if(l==null||l==t)return a.name}return n}function ge(t){var n=st.call(u,"placeholder")?u:t;return n.placeholder}function W(){var t=u.iteratee||as;return t=t===as?ka:t,arguments.length?t(arguments[0],arguments[1]):t}function Cr(t,n){var e=t.__data__;return Vh(n)?e[typeof n=="string"?"string":"hash"]:e.map}function Hi(t){for(var n=xt(t),e=n.length;e--;){var i=n[e],a=t[i];n[e]=[i,a,_o(a)]}return n}function jn(t,n){var e=Jl(t,n);return La(e)?e:r}function Uh(t){var n=st.call(t,Zn),e=t[Zn];try{t[Zn]=r;var i=!0}catch{}var a=je.call(t);return i&&(n?t[Zn]=e:delete t[Zn]),a}var qi=mi?function(t){return t==null?[]:(t=at(t),On(mi(t),function(n){return ma.call(t,n)}))}:ls,co=mi?function(t){for(var n=[];t;)Dn(n,qi(t)),t=er(t);return n}:ls,Rt=kt;(wi&&Rt(new wi(new ArrayBuffer(1)))!=ee||xe&&Rt(new xe)!=_t||yi&&Rt(yi.resolve())!=Bt||le&&Rt(new le)!=pt||Ae&&Rt(new Ae)!=Me)&&(Rt=function(t){var n=kt(t),e=n==Mt?t.constructor:r,i=e?te(e):"";if(i)switch(i){case Cf:return ee;case Sf:return _t;case bf:return Bt;case xf:return pt;case Af:return Me}return n});function $h(t,n,e){for(var i=-1,a=e.length;++i<a;){var l=e[i],c=l.size;switch(l.type){case"drop":t+=c;break;case"dropRight":n-=c;break;case"take":n=Tt(n,t+c);break;case"takeRight":t=St(t,n-c);break}}return{start:t,end:n}}function Gh(t){var n=t.match(Vu);return n?n[1].split(Zu):[]}function po(t,n,e){n=$n(n,t);for(var i=-1,a=n.length,l=!1;++i<a;){var c=Cn(n[i]);if(!(l=t!=null&&e(t,c)))break;t=t[c]}return l||++i!=a?l:(a=t==null?0:t.length,!!a&&Er(a)&&Tn(c,a)&&(H(t)||ne(t)))}function zh(t){var n=t.length,e=new t.constructor(n);return n&&typeof t[0]=="string"&&st.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function go(t){return typeof t.constructor=="function"&&!Oe(t)?he(er(t)):{}}function Hh(t,n,e){var i=t.constructor;switch(n){case Ce:return Wi(t);case lt:case yt:return new i(+t);case ee:return Ih(t,e);case Hr:case qr:case Kr:case Vr:case Zr:case Jr:case Yr:case Xr:case Qr:return Ya(t,e);case _t:return new i;case Lt:case wn:return new i(t);case tn:return Ph(t);case pt:return new i;case ze:return Eh(t)}}function qh(t,n){var e=n.length;if(!e)return t;var i=e-1;return n[i]=(e>1?"& ":"")+n[i],n=n.join(e>2?", ":" "),t.replace(Ku,`{
/* [wrapped with `+n+`] */
`)}function Kh(t){return H(t)||ne(t)||!!(wa&&t&&t[wa])}function Tn(t,n){var e=typeof t;return n=n??vn,!!n&&(e=="number"||e!="symbol"&&rl.test(t))&&t>-1&&t%1==0&&t<n}function Ot(t,n,e){if(!dt(e))return!1;var i=typeof n;return(i=="number"?$t(e)&&Tn(n,e.length):i=="string"&&n in e)?gn(e[n],t):!1}function Ki(t,n){if(H(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||Yt(t)?!0:Gu.test(t)||!$u.test(t)||n!=null&&t in at(n)}function Vh(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Vi(t){var n=Mr(t),e=u[n];if(typeof e!="function"||!(n in j.prototype))return!1;if(t===e)return!0;var i=zi(e);return!!i&&t===i[0]}function Zh(t){return!!da&&da in t}var Jh=Xe?Rn:fs;function Oe(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||ue;return t===e}function _o(t){return t===t&&!dt(t)}function vo(t,n){return function(e){return e==null?!1:e[t]===n&&(n!==r||t in at(e))}}function Yh(t){var n=Ir(t,function(i){return e.size===M&&e.clear(),i}),e=n.cache;return n}function Xh(t,n){var e=t[1],i=n[1],a=e|i,l=a<(N|K|It),c=i==It&&e==X||i==It&&e==Ht&&t[7].length<=n[8]||i==(It|Ht)&&n[7].length<=n[8]&&e==X;if(!(l||c))return t;i&N&&(t[2]=n[2],a|=e&N?0:Y);var g=n[3];if(g){var w=t[3];t[3]=w?Qa(w,g,n[4]):g,t[4]=w?Nn(t[3],S):n[4]}return g=n[5],g&&(w=t[5],t[5]=w?ja(w,g,n[6]):g,t[6]=w?Nn(t[5],S):n[6]),g=n[7],g&&(t[7]=g),i&It&&(t[8]=t[8]==null?n[8]:Tt(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=a,t}function Qh(t){var n=[];if(t!=null)for(var e in at(t))n.push(e);return n}function jh(t){return je.call(t)}function mo(t,n,e){return n=St(n===r?t.length-1:n,0),function(){for(var i=arguments,a=-1,l=St(i.length-n,0),c=b(l);++a<l;)c[a]=i[n+a];a=-1;for(var g=b(n+1);++a<n;)g[a]=i[a];return g[n]=e(c),Vt(t,this,g)}}function wo(t,n){return n.length<2?t:Qn(t,on(n,0,-1))}function tc(t,n){for(var e=t.length,i=Tt(n.length,e),a=Ut(t);i--;){var l=n[i];t[i]=Tn(l,e)?a[l]:r}return t}function Zi(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var yo=Co(Ga),De=df||function(t,n){return Pt.setTimeout(t,n)},Ji=Co(Sh);function Mo(t,n,e){var i=n+"";return Ji(t,qh(i,nc(Gh(i),e)))}function Co(t){var n=0,e=0;return function(){var i=wf(),a=Gr-(i-e);if(e=i,a>0){if(++n>=Ue)return arguments[0]}else n=0;return t.apply(r,arguments)}}function Sr(t,n){var e=-1,i=t.length,a=i-1;for(n=n===r?i:n;++e<n;){var l=Ri(e,a),c=t[l];t[l]=t[e],t[e]=c}return t.length=n,t}var So=Yh(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(zu,function(e,i,a,l){n.push(a?l.replace(Xu,"$1"):i||e)}),n});function Cn(t){if(typeof t=="string"||Yt(t))return t;var n=t+"";return n=="0"&&1/t==-Sn?"-0":n}function te(t){if(t!=null){try{return Qe.call(t)}catch{}try{return t+""}catch{}}return""}function nc(t,n){return en(ht,function(e){var i="_."+e[0];n&e[1]&&!Ve(t,i)&&t.push(i)}),t.sort()}function bo(t){if(t instanceof j)return t.clone();var n=new sn(t.__wrapped__,t.__chain__);return n.__actions__=Ut(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function ec(t,n,e){(e?Ot(t,n,e):n===r)?n=1:n=St(V(n),0);var i=t==null?0:t.length;if(!i||n<1)return[];for(var a=0,l=0,c=b(sr(i/n));a<i;)c[l++]=on(t,a,a+=n);return c}function rc(t){for(var n=-1,e=t==null?0:t.length,i=0,a=[];++n<e;){var l=t[n];l&&(a[i++]=l)}return a}function ic(){var t=arguments.length;if(!t)return[];for(var n=b(t-1),e=arguments[0],i=t;i--;)n[i-1]=arguments[i];return Dn(H(e)?Ut(e):[e],Et(n,1))}var sc=J(function(t,n){return mt(t)?Te(t,Et(n,1,mt,!0)):[]}),ac=J(function(t,n){var e=un(n);return mt(e)&&(e=r),mt(t)?Te(t,Et(n,1,mt,!0),W(e,2)):[]}),oc=J(function(t,n){var e=un(n);return mt(e)&&(e=r),mt(t)?Te(t,Et(n,1,mt,!0),r,e):[]});function uc(t,n,e){var i=t==null?0:t.length;return i?(n=e||n===r?1:V(n),on(t,n<0?0:n,i)):[]}function lc(t,n,e){var i=t==null?0:t.length;return i?(n=e||n===r?1:V(n),n=i-n,on(t,0,n<0?0:n)):[]}function fc(t,n){return t&&t.length?dr(t,W(n,3),!0,!0):[]}function hc(t,n){return t&&t.length?dr(t,W(n,3),!0):[]}function cc(t,n,e,i){var a=t==null?0:t.length;return a?(e&&typeof e!="number"&&Ot(t,n,e)&&(e=0,i=a),ih(t,n,e,i)):[]}function xo(t,n,e){var i=t==null?0:t.length;if(!i)return-1;var a=e==null?0:V(e);return a<0&&(a=St(i+a,0)),Ze(t,W(n,3),a)}function Ao(t,n,e){var i=t==null?0:t.length;if(!i)return-1;var a=i-1;return e!==r&&(a=V(e),a=e<0?St(i+a,0):Tt(a,i-1)),Ze(t,W(n,3),a,!0)}function Io(t){var n=t==null?0:t.length;return n?Et(t,1):[]}function pc(t){var n=t==null?0:t.length;return n?Et(t,Sn):[]}function gc(t,n){var e=t==null?0:t.length;return e?(n=n===r?1:V(n),Et(t,n)):[]}function dc(t){for(var n=-1,e=t==null?0:t.length,i={};++n<e;){var a=t[n];i[a[0]]=a[1]}return i}function Po(t){return t&&t.length?t[0]:r}function _c(t,n,e){var i=t==null?0:t.length;if(!i)return-1;var a=e==null?0:V(e);return a<0&&(a=St(i+a,0)),ie(t,n,a)}function vc(t){var n=t==null?0:t.length;return n?on(t,0,-1):[]}var mc=J(function(t){var n=gt(t,Di);return n.length&&n[0]===t[0]?Ai(n):[]}),wc=J(function(t){var n=un(t),e=gt(t,Di);return n===un(e)?n=r:e.pop(),e.length&&e[0]===t[0]?Ai(e,W(n,2)):[]}),yc=J(function(t){var n=un(t),e=gt(t,Di);return n=typeof n=="function"?n:r,n&&e.pop(),e.length&&e[0]===t[0]?Ai(e,r,n):[]});function Mc(t,n){return t==null?"":vf.call(t,n)}function un(t){var n=t==null?0:t.length;return n?t[n-1]:r}function Cc(t,n,e){var i=t==null?0:t.length;if(!i)return-1;var a=i;return e!==r&&(a=V(e),a=a<0?St(i+a,0):Tt(a,i-1)),n===n?tf(t,n,a):Ze(t,oa,a,!0)}function Sc(t,n){return t&&t.length?Wa(t,V(n)):r}var bc=J(Eo);function Eo(t,n){return t&&t.length&&n&&n.length?Ti(t,n):t}function xc(t,n,e){return t&&t.length&&n&&n.length?Ti(t,n,W(e,2)):t}function Ac(t,n,e){return t&&t.length&&n&&n.length?Ti(t,n,r,e):t}var Ic=En(function(t,n){var e=t==null?0:t.length,i=Ci(t,n);return $a(t,gt(n,function(a){return Tn(a,e)?+a:a}).sort(Xa)),i});function Pc(t,n){var e=[];if(!(t&&t.length))return e;var i=-1,a=[],l=t.length;for(n=W(n,3);++i<l;){var c=t[i];n(c,i,t)&&(e.push(c),a.push(i))}return $a(t,a),e}function Yi(t){return t==null?t:Mf.call(t)}function Ec(t,n,e){var i=t==null?0:t.length;return i?(e&&typeof e!="number"&&Ot(t,n,e)?(n=0,e=i):(n=n==null?0:V(n),e=e===r?i:V(e)),on(t,n,e)):[]}function Tc(t,n){return gr(t,n)}function Rc(t,n,e){return Li(t,n,W(e,2))}function Fc(t,n){var e=t==null?0:t.length;if(e){var i=gr(t,n);if(i<e&&gn(t[i],n))return i}return-1}function Lc(t,n){return gr(t,n,!0)}function kc(t,n,e){return Li(t,n,W(e,2),!0)}function Oc(t,n){var e=t==null?0:t.length;if(e){var i=gr(t,n,!0)-1;if(gn(t[i],n))return i}return-1}function Dc(t){return t&&t.length?za(t):[]}function Nc(t,n){return t&&t.length?za(t,W(n,2)):[]}function Wc(t){var n=t==null?0:t.length;return n?on(t,1,n):[]}function Bc(t,n,e){return t&&t.length?(n=e||n===r?1:V(n),on(t,0,n<0?0:n)):[]}function Uc(t,n,e){var i=t==null?0:t.length;return i?(n=e||n===r?1:V(n),n=i-n,on(t,n<0?0:n,i)):[]}function $c(t,n){return t&&t.length?dr(t,W(n,3),!1,!0):[]}function Gc(t,n){return t&&t.length?dr(t,W(n,3)):[]}var zc=J(function(t){return Un(Et(t,1,mt,!0))}),Hc=J(function(t){var n=un(t);return mt(n)&&(n=r),Un(Et(t,1,mt,!0),W(n,2))}),qc=J(function(t){var n=un(t);return n=typeof n=="function"?n:r,Un(Et(t,1,mt,!0),r,n)});function Kc(t){return t&&t.length?Un(t):[]}function Vc(t,n){return t&&t.length?Un(t,W(n,2)):[]}function Zc(t,n){return n=typeof n=="function"?n:r,t&&t.length?Un(t,r,n):[]}function Xi(t){if(!(t&&t.length))return[];var n=0;return t=On(t,function(e){if(mt(e))return n=St(e.length,n),!0}),gi(n,function(e){return gt(t,hi(e))})}function To(t,n){if(!(t&&t.length))return[];var e=Xi(t);return n==null?e:gt(e,function(i){return Vt(n,r,i)})}var Jc=J(function(t,n){return mt(t)?Te(t,n):[]}),Yc=J(function(t){return Oi(On(t,mt))}),Xc=J(function(t){var n=un(t);return mt(n)&&(n=r),Oi(On(t,mt),W(n,2))}),Qc=J(function(t){var n=un(t);return n=typeof n=="function"?n:r,Oi(On(t,mt),r,n)}),jc=J(Xi);function tp(t,n){return Va(t||[],n||[],Ee)}function np(t,n){return Va(t||[],n||[],Le)}var ep=J(function(t){var n=t.length,e=n>1?t[n-1]:r;return e=typeof e=="function"?(t.pop(),e):r,To(t,e)});function Ro(t){var n=u(t);return n.__chain__=!0,n}function rp(t,n){return n(t),t}function br(t,n){return n(t)}var ip=En(function(t){var n=t.length,e=n?t[0]:0,i=this.__wrapped__,a=function(l){return Ci(l,t)};return n>1||this.__actions__.length||!(i instanceof j)||!Tn(e)?this.thru(a):(i=i.slice(e,+e+(n?1:0)),i.__actions__.push({func:br,args:[a],thisArg:r}),new sn(i,this.__chain__).thru(function(l){return n&&!l.length&&l.push(r),l}))});function sp(){return Ro(this)}function ap(){return new sn(this.value(),this.__chain__)}function op(){this.__values__===r&&(this.__values__=qo(this.value()));var t=this.__index__>=this.__values__.length,n=t?r:this.__values__[this.__index__++];return{done:t,value:n}}function up(){return this}function lp(t){for(var n,e=this;e instanceof lr;){var i=bo(e);i.__index__=0,i.__values__=r,n?a.__wrapped__=i:n=i;var a=i;e=e.__wrapped__}return a.__wrapped__=t,n}function fp(){var t=this.__wrapped__;if(t instanceof j){var n=t;return this.__actions__.length&&(n=new j(this)),n=n.reverse(),n.__actions__.push({func:br,args:[Yi],thisArg:r}),new sn(n,this.__chain__)}return this.thru(Yi)}function hp(){return Ka(this.__wrapped__,this.__actions__)}var cp=_r(function(t,n,e){st.call(t,e)?++t[e]:In(t,e,1)});function pp(t,n,e){var i=H(t)?sa:rh;return e&&Ot(t,n,e)&&(n=r),i(t,W(n,3))}function gp(t,n){var e=H(t)?On:Ea;return e(t,W(n,3))}var dp=ro(xo),_p=ro(Ao);function vp(t,n){return Et(xr(t,n),1)}function mp(t,n){return Et(xr(t,n),Sn)}function wp(t,n,e){return e=e===r?1:V(e),Et(xr(t,n),e)}function Fo(t,n){var e=H(t)?en:Bn;return e(t,W(n,3))}function Lo(t,n){var e=H(t)?Nl:Pa;return e(t,W(n,3))}var yp=_r(function(t,n,e){st.call(t,e)?t[e].push(n):In(t,e,[n])});function Mp(t,n,e,i){t=$t(t)?t:_e(t),e=e&&!i?V(e):0;var a=t.length;return e<0&&(e=St(a+e,0)),Tr(t)?e<=a&&t.indexOf(n,e)>-1:!!a&&ie(t,n,e)>-1}var Cp=J(function(t,n,e){var i=-1,a=typeof n=="function",l=$t(t)?b(t.length):[];return Bn(t,function(c){l[++i]=a?Vt(n,c,e):Re(c,n,e)}),l}),Sp=_r(function(t,n,e){In(t,e,n)});function xr(t,n){var e=H(t)?gt:Oa;return e(t,W(n,3))}function bp(t,n,e,i){return t==null?[]:(H(n)||(n=n==null?[]:[n]),e=i?r:e,H(e)||(e=e==null?[]:[e]),Ba(t,n,e))}var xp=_r(function(t,n,e){t[e?0:1].push(n)},function(){return[[],[]]});function Ap(t,n,e){var i=H(t)?li:la,a=arguments.length<3;return i(t,W(n,4),e,a,Bn)}function Ip(t,n,e){var i=H(t)?Wl:la,a=arguments.length<3;return i(t,W(n,4),e,a,Pa)}function Pp(t,n){var e=H(t)?On:Ea;return e(t,Pr(W(n,3)))}function Ep(t){var n=H(t)?ba:Mh;return n(t)}function Tp(t,n,e){(e?Ot(t,n,e):n===r)?n=1:n=V(n);var i=H(t)?Qf:Ch;return i(t,n)}function Rp(t){var n=H(t)?jf:bh;return n(t)}function Fp(t){if(t==null)return 0;if($t(t))return Tr(t)?ae(t):t.length;var n=Rt(t);return n==_t||n==pt?t.size:Pi(t).length}function Lp(t,n,e){var i=H(t)?fi:xh;return e&&Ot(t,n,e)&&(n=r),i(t,W(n,3))}var kp=J(function(t,n){if(t==null)return[];var e=n.length;return e>1&&Ot(t,n[0],n[1])?n=[]:e>2&&Ot(n[0],n[1],n[2])&&(n=[n[0]]),Ba(t,Et(n,1),[])}),Ar=gf||function(){return Pt.Date.now()};function Op(t,n){if(typeof n!="function")throw new rn(d);return t=V(t),function(){if(--t<1)return n.apply(this,arguments)}}function ko(t,n,e){return n=e?r:n,n=t&&n==null?t.length:n,Pn(t,It,r,r,r,r,n)}function Oo(t,n){var e;if(typeof n!="function")throw new rn(d);return t=V(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=r),e}}var Qi=J(function(t,n,e){var i=N;if(e.length){var a=Nn(e,ge(Qi));i|=bt}return Pn(t,i,n,e,a)}),Do=J(function(t,n,e){var i=N|K;if(e.length){var a=Nn(e,ge(Do));i|=bt}return Pn(n,i,t,e,a)});function No(t,n,e){n=e?r:n;var i=Pn(t,X,r,r,r,r,r,n);return i.placeholder=No.placeholder,i}function Wo(t,n,e){n=e?r:n;var i=Pn(t,et,r,r,r,r,r,n);return i.placeholder=Wo.placeholder,i}function Bo(t,n,e){var i,a,l,c,g,w,A=0,I=!1,P=!1,R=!0;if(typeof t!="function")throw new rn(d);n=ln(n)||0,dt(e)&&(I=!!e.leading,P="maxWait"in e,l=P?St(ln(e.maxWait)||0,n):l,R="trailing"in e?!!e.trailing:R);function D(wt){var dn=i,Ln=a;return i=a=r,A=wt,c=t.apply(Ln,dn),c}function B(wt){return A=wt,g=De(Q,n),I?D(wt):c}function Z(wt){var dn=wt-w,Ln=wt-A,iu=n-dn;return P?Tt(iu,l-Ln):iu}function U(wt){var dn=wt-w,Ln=wt-A;return w===r||dn>=n||dn<0||P&&Ln>=l}function Q(){var wt=Ar();if(U(wt))return tt(wt);g=De(Q,Z(wt))}function tt(wt){return g=r,R&&i?D(wt):(i=a=r,c)}function Xt(){g!==r&&Za(g),A=0,i=w=a=g=r}function Dt(){return g===r?c:tt(Ar())}function Qt(){var wt=Ar(),dn=U(wt);if(i=arguments,a=this,w=wt,dn){if(g===r)return B(w);if(P)return Za(g),g=De(Q,n),D(w)}return g===r&&(g=De(Q,n)),c}return Qt.cancel=Xt,Qt.flush=Dt,Qt}var Dp=J(function(t,n){return Ia(t,1,n)}),Np=J(function(t,n,e){return Ia(t,ln(n)||0,e)});function Wp(t){return Pn(t,jt)}function Ir(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new rn(d);var e=function(){var i=arguments,a=n?n.apply(this,i):i[0],l=e.cache;if(l.has(a))return l.get(a);var c=t.apply(this,i);return e.cache=l.set(a,c)||l,c};return e.cache=new(Ir.Cache||An),e}Ir.Cache=An;function Pr(t){if(typeof t!="function")throw new rn(d);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function Bp(t){return Oo(2,t)}var Up=Ah(function(t,n){n=n.length==1&&H(n[0])?gt(n[0],Zt(W())):gt(Et(n,1),Zt(W()));var e=n.length;return J(function(i){for(var a=-1,l=Tt(i.length,e);++a<l;)i[a]=n[a].call(this,i[a]);return Vt(t,this,i)})}),ji=J(function(t,n){var e=Nn(n,ge(ji));return Pn(t,bt,r,n,e)}),Uo=J(function(t,n){var e=Nn(n,ge(Uo));return Pn(t,At,r,n,e)}),$p=En(function(t,n){return Pn(t,Ht,r,r,r,n)});function Gp(t,n){if(typeof t!="function")throw new rn(d);return n=n===r?n:V(n),J(t,n)}function zp(t,n){if(typeof t!="function")throw new rn(d);return n=n==null?0:St(V(n),0),J(function(e){var i=e[n],a=Gn(e,0,n);return i&&Dn(a,i),Vt(t,this,a)})}function Hp(t,n,e){var i=!0,a=!0;if(typeof t!="function")throw new rn(d);return dt(e)&&(i="leading"in e?!!e.leading:i,a="trailing"in e?!!e.trailing:a),Bo(t,n,{leading:i,maxWait:n,trailing:a})}function qp(t){return ko(t,1)}function Kp(t,n){return ji(Ni(n),t)}function Vp(){if(!arguments.length)return[];var t=arguments[0];return H(t)?t:[t]}function Zp(t){return an(t,O)}function Jp(t,n){return n=typeof n=="function"?n:r,an(t,O,n)}function Yp(t){return an(t,m|O)}function Xp(t,n){return n=typeof n=="function"?n:r,an(t,m|O,n)}function Qp(t,n){return n==null||Aa(t,n,xt(n))}function gn(t,n){return t===n||t!==t&&n!==n}var jp=yr(xi),tg=yr(function(t,n){return t>=n}),ne=Fa(function(){return arguments}())?Fa:function(t){return vt(t)&&st.call(t,"callee")&&!ma.call(t,"callee")},H=b.isArray,ng=js?Zt(js):lh;function $t(t){return t!=null&&Er(t.length)&&!Rn(t)}function mt(t){return vt(t)&&$t(t)}function eg(t){return t===!0||t===!1||vt(t)&&kt(t)==lt}var zn=_f||fs,rg=ta?Zt(ta):fh;function ig(t){return vt(t)&&t.nodeType===1&&!Ne(t)}function sg(t){if(t==null)return!0;if($t(t)&&(H(t)||typeof t=="string"||typeof t.splice=="function"||zn(t)||de(t)||ne(t)))return!t.length;var n=Rt(t);if(n==_t||n==pt)return!t.size;if(Oe(t))return!Pi(t).length;for(var e in t)if(st.call(t,e))return!1;return!0}function ag(t,n){return Fe(t,n)}function og(t,n,e){e=typeof e=="function"?e:r;var i=e?e(t,n):r;return i===r?Fe(t,n,r,e):!!i}function ts(t){if(!vt(t))return!1;var n=kt(t);return n==Ft||n==Kt||typeof t.message=="string"&&typeof t.name=="string"&&!Ne(t)}function ug(t){return typeof t=="number"&&ya(t)}function Rn(t){if(!dt(t))return!1;var n=kt(t);return n==Wt||n==mn||n==ot||n==hn}function $o(t){return typeof t=="number"&&t==V(t)}function Er(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=vn}function dt(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function vt(t){return t!=null&&typeof t=="object"}var Go=na?Zt(na):ch;function lg(t,n){return t===n||Ii(t,n,Hi(n))}function fg(t,n,e){return e=typeof e=="function"?e:r,Ii(t,n,Hi(n),e)}function hg(t){return zo(t)&&t!=+t}function cg(t){if(Jh(t))throw new z(p);return La(t)}function pg(t){return t===null}function gg(t){return t==null}function zo(t){return typeof t=="number"||vt(t)&&kt(t)==Lt}function Ne(t){if(!vt(t)||kt(t)!=Mt)return!1;var n=er(t);if(n===null)return!0;var e=st.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&Qe.call(e)==ff}var ns=ea?Zt(ea):ph;function dg(t){return $o(t)&&t>=-vn&&t<=vn}var Ho=ra?Zt(ra):gh;function Tr(t){return typeof t=="string"||!H(t)&&vt(t)&&kt(t)==wn}function Yt(t){return typeof t=="symbol"||vt(t)&&kt(t)==ze}var de=ia?Zt(ia):dh;function _g(t){return t===r}function vg(t){return vt(t)&&Rt(t)==Me}function mg(t){return vt(t)&&kt(t)==Lu}var wg=yr(Ei),yg=yr(function(t,n){return t<=n});function qo(t){if(!t)return[];if($t(t))return Tr(t)?cn(t):Ut(t);if(be&&t[be])return Xl(t[be]());var n=Rt(t),e=n==_t?_i:n==pt?Je:_e;return e(t)}function Fn(t){if(!t)return t===0?t:0;if(t=ln(t),t===Sn||t===-Sn){var n=t<0?-1:1;return n*Ge}return t===t?t:0}function V(t){var n=Fn(t),e=n%1;return n===n?e?n-e:n:0}function Ko(t){return t?Xn(V(t),0,L):0}function ln(t){if(typeof t=="number")return t;if(Yt(t))return bn;if(dt(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=dt(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=fa(t);var e=tl.test(t);return e||el.test(t)?kl(t.slice(2),e?2:8):ju.test(t)?bn:+t}function Vo(t){return Mn(t,Gt(t))}function Mg(t){return t?Xn(V(t),-vn,vn):t===0?t:0}function it(t){return t==null?"":Jt(t)}var Cg=ce(function(t,n){if(Oe(n)||$t(n)){Mn(n,xt(n),t);return}for(var e in n)st.call(n,e)&&Ee(t,e,n[e])}),Zo=ce(function(t,n){Mn(n,Gt(n),t)}),Rr=ce(function(t,n,e,i){Mn(n,Gt(n),t,i)}),Sg=ce(function(t,n,e,i){Mn(n,xt(n),t,i)}),bg=En(Ci);function xg(t,n){var e=he(t);return n==null?e:xa(e,n)}var Ag=J(function(t,n){t=at(t);var e=-1,i=n.length,a=i>2?n[2]:r;for(a&&Ot(n[0],n[1],a)&&(i=1);++e<i;)for(var l=n[e],c=Gt(l),g=-1,w=c.length;++g<w;){var A=c[g],I=t[A];(I===r||gn(I,ue[A])&&!st.call(t,A))&&(t[A]=l[A])}return t}),Ig=J(function(t){return t.push(r,fo),Vt(Jo,r,t)});function Pg(t,n){return aa(t,W(n,3),yn)}function Eg(t,n){return aa(t,W(n,3),bi)}function Tg(t,n){return t==null?t:Si(t,W(n,3),Gt)}function Rg(t,n){return t==null?t:Ta(t,W(n,3),Gt)}function Fg(t,n){return t&&yn(t,W(n,3))}function Lg(t,n){return t&&bi(t,W(n,3))}function kg(t){return t==null?[]:cr(t,xt(t))}function Og(t){return t==null?[]:cr(t,Gt(t))}function es(t,n,e){var i=t==null?r:Qn(t,n);return i===r?e:i}function Dg(t,n){return t!=null&&po(t,n,sh)}function rs(t,n){return t!=null&&po(t,n,ah)}var Ng=so(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=je.call(n)),t[n]=e},ss(zt)),Wg=so(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=je.call(n)),st.call(t,n)?t[n].push(e):t[n]=[e]},W),Bg=J(Re);function xt(t){return $t(t)?Sa(t):Pi(t)}function Gt(t){return $t(t)?Sa(t,!0):_h(t)}function Ug(t,n){var e={};return n=W(n,3),yn(t,function(i,a,l){In(e,n(i,a,l),i)}),e}function $g(t,n){var e={};return n=W(n,3),yn(t,function(i,a,l){In(e,a,n(i,a,l))}),e}var Gg=ce(function(t,n,e){pr(t,n,e)}),Jo=ce(function(t,n,e,i){pr(t,n,e,i)}),zg=En(function(t,n){var e={};if(t==null)return e;var i=!1;n=gt(n,function(l){return l=$n(l,t),i||(i=l.length>1),l}),Mn(t,Gi(t),e),i&&(e=an(e,m|T|O,Nh));for(var a=n.length;a--;)ki(e,n[a]);return e});function Hg(t,n){return Yo(t,Pr(W(n)))}var qg=En(function(t,n){return t==null?{}:mh(t,n)});function Yo(t,n){if(t==null)return{};var e=gt(Gi(t),function(i){return[i]});return n=W(n),Ua(t,e,function(i,a){return n(i,a[0])})}function Kg(t,n,e){n=$n(n,t);var i=-1,a=n.length;for(a||(a=1,t=r);++i<a;){var l=t==null?r:t[Cn(n[i])];l===r&&(i=a,l=e),t=Rn(l)?l.call(t):l}return t}function Vg(t,n,e){return t==null?t:Le(t,n,e)}function Zg(t,n,e,i){return i=typeof i=="function"?i:r,t==null?t:Le(t,n,e,i)}var Xo=uo(xt),Qo=uo(Gt);function Jg(t,n,e){var i=H(t),a=i||zn(t)||de(t);if(n=W(n,4),e==null){var l=t&&t.constructor;a?e=i?new l:[]:dt(t)?e=Rn(l)?he(er(t)):{}:e={}}return(a?en:yn)(t,function(c,g,w){return n(e,c,g,w)}),e}function Yg(t,n){return t==null?!0:ki(t,n)}function Xg(t,n,e){return t==null?t:qa(t,n,Ni(e))}function Qg(t,n,e,i){return i=typeof i=="function"?i:r,t==null?t:qa(t,n,Ni(e),i)}function _e(t){return t==null?[]:di(t,xt(t))}function jg(t){return t==null?[]:di(t,Gt(t))}function td(t,n,e){return e===r&&(e=n,n=r),e!==r&&(e=ln(e),e=e===e?e:0),n!==r&&(n=ln(n),n=n===n?n:0),Xn(ln(t),n,e)}function nd(t,n,e){return n=Fn(n),e===r?(e=n,n=0):e=Fn(e),t=ln(t),oh(t,n,e)}function ed(t,n,e){if(e&&typeof e!="boolean"&&Ot(t,n,e)&&(n=e=r),e===r&&(typeof n=="boolean"?(e=n,n=r):typeof t=="boolean"&&(e=t,t=r)),t===r&&n===r?(t=0,n=1):(t=Fn(t),n===r?(n=t,t=0):n=Fn(n)),t>n){var i=t;t=n,n=i}if(e||t%1||n%1){var a=Ma();return Tt(t+a*(n-t+Ll("1e-"+((a+"").length-1))),n)}return Ri(t,n)}var rd=pe(function(t,n,e){return n=n.toLowerCase(),t+(e?jo(n):n)});function jo(t){return is(it(t).toLowerCase())}function tu(t){return t=it(t),t&&t.replace(il,Kl).replace(Sl,"")}function id(t,n,e){t=it(t),n=Jt(n);var i=t.length;e=e===r?i:Xn(V(e),0,i);var a=e;return e-=n.length,e>=0&&t.slice(e,a)==n}function sd(t){return t=it(t),t&&Wu.test(t)?t.replace(Ts,Vl):t}function ad(t){return t=it(t),t&&Hu.test(t)?t.replace(jr,"\\$&"):t}var od=pe(function(t,n,e){return t+(e?"-":"")+n.toLowerCase()}),ud=pe(function(t,n,e){return t+(e?" ":"")+n.toLowerCase()}),ld=eo("toLowerCase");function fd(t,n,e){t=it(t),n=V(n);var i=n?ae(t):0;if(!n||i>=n)return t;var a=(n-i)/2;return wr(ar(a),e)+t+wr(sr(a),e)}function hd(t,n,e){t=it(t),n=V(n);var i=n?ae(t):0;return n&&i<n?t+wr(n-i,e):t}function cd(t,n,e){t=it(t),n=V(n);var i=n?ae(t):0;return n&&i<n?wr(n-i,e)+t:t}function pd(t,n,e){return e||n==null?n=0:n&&(n=+n),yf(it(t).replace(ti,""),n||0)}function gd(t,n,e){return(e?Ot(t,n,e):n===r)?n=1:n=V(n),Fi(it(t),n)}function dd(){var t=arguments,n=it(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var _d=pe(function(t,n,e){return t+(e?"_":"")+n.toLowerCase()});function vd(t,n,e){return e&&typeof e!="number"&&Ot(t,n,e)&&(n=e=r),e=e===r?L:e>>>0,e?(t=it(t),t&&(typeof n=="string"||n!=null&&!ns(n))&&(n=Jt(n),!n&&se(t))?Gn(cn(t),0,e):t.split(n,e)):[]}var md=pe(function(t,n,e){return t+(e?" ":"")+is(n)});function wd(t,n,e){return t=it(t),e=e==null?0:Xn(V(e),0,t.length),n=Jt(n),t.slice(e,e+n.length)==n}function yd(t,n,e){var i=u.templateSettings;e&&Ot(t,n,e)&&(n=r),t=it(t),n=Rr({},n,i,lo);var a=Rr({},n.imports,i.imports,lo),l=xt(a),c=di(a,l),g,w,A=0,I=n.interpolate||He,P="__p += '",R=vi((n.escape||He).source+"|"+I.source+"|"+(I===Rs?Qu:He).source+"|"+(n.evaluate||He).source+"|$","g"),D="//# sourceURL="+(st.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Pl+"]")+`
`;t.replace(R,function(U,Q,tt,Xt,Dt,Qt){return tt||(tt=Xt),P+=t.slice(A,Qt).replace(sl,Zl),Q&&(g=!0,P+=`' +
__e(`+Q+`) +
'`),Dt&&(w=!0,P+=`';
`+Dt+`;
__p += '`),tt&&(P+=`' +
((__t = (`+tt+`)) == null ? '' : __t) +
'`),A=Qt+U.length,U}),P+=`';
`;var B=st.call(n,"variable")&&n.variable;if(!B)P=`with (obj) {
`+P+`
}
`;else if(Yu.test(B))throw new z(_);P=(w?P.replace(ku,""):P).replace(Ou,"$1").replace(Du,"$1;"),P="function("+(B||"obj")+`) {
`+(B?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(g?", __e = _.escape":"")+(w?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+P+`return __p
}`;var Z=eu(function(){return rt(l,D+"return "+P).apply(r,c)});if(Z.source=P,ts(Z))throw Z;return Z}function Md(t){return it(t).toLowerCase()}function Cd(t){return it(t).toUpperCase()}function Sd(t,n,e){if(t=it(t),t&&(e||n===r))return fa(t);if(!t||!(n=Jt(n)))return t;var i=cn(t),a=cn(n),l=ha(i,a),c=ca(i,a)+1;return Gn(i,l,c).join("")}function bd(t,n,e){if(t=it(t),t&&(e||n===r))return t.slice(0,ga(t)+1);if(!t||!(n=Jt(n)))return t;var i=cn(t),a=ca(i,cn(n))+1;return Gn(i,0,a).join("")}function xd(t,n,e){if(t=it(t),t&&(e||n===r))return t.replace(ti,"");if(!t||!(n=Jt(n)))return t;var i=cn(t),a=ha(i,cn(n));return Gn(i,a).join("")}function Ad(t,n){var e=qt,i=we;if(dt(n)){var a="separator"in n?n.separator:a;e="length"in n?V(n.length):e,i="omission"in n?Jt(n.omission):i}t=it(t);var l=t.length;if(se(t)){var c=cn(t);l=c.length}if(e>=l)return t;var g=e-ae(i);if(g<1)return i;var w=c?Gn(c,0,g).join(""):t.slice(0,g);if(a===r)return w+i;if(c&&(g+=w.length-g),ns(a)){if(t.slice(g).search(a)){var A,I=w;for(a.global||(a=vi(a.source,it(Fs.exec(a))+"g")),a.lastIndex=0;A=a.exec(I);)var P=A.index;w=w.slice(0,P===r?g:P)}}else if(t.indexOf(Jt(a),g)!=g){var R=w.lastIndexOf(a);R>-1&&(w=w.slice(0,R))}return w+i}function Id(t){return t=it(t),t&&Nu.test(t)?t.replace(Es,nf):t}var Pd=pe(function(t,n,e){return t+(e?" ":"")+n.toUpperCase()}),is=eo("toUpperCase");function nu(t,n,e){return t=it(t),n=e?r:n,n===r?Yl(t)?sf(t):$l(t):t.match(n)||[]}var eu=J(function(t,n){try{return Vt(t,r,n)}catch(e){return ts(e)?e:new z(e)}}),Ed=En(function(t,n){return en(n,function(e){e=Cn(e),In(t,e,Qi(t[e],t))}),t});function Td(t){var n=t==null?0:t.length,e=W();return t=n?gt(t,function(i){if(typeof i[1]!="function")throw new rn(d);return[e(i[0]),i[1]]}):[],J(function(i){for(var a=-1;++a<n;){var l=t[a];if(Vt(l[0],this,i))return Vt(l[1],this,i)}})}function Rd(t){return eh(an(t,m))}function ss(t){return function(){return t}}function Fd(t,n){return t==null||t!==t?n:t}var Ld=io(),kd=io(!0);function zt(t){return t}function as(t){return ka(typeof t=="function"?t:an(t,m))}function Od(t){return Da(an(t,m))}function Dd(t,n){return Na(t,an(n,m))}var Nd=J(function(t,n){return function(e){return Re(e,t,n)}}),Wd=J(function(t,n){return function(e){return Re(t,e,n)}});function os(t,n,e){var i=xt(n),a=cr(n,i);e==null&&!(dt(n)&&(a.length||!i.length))&&(e=n,n=t,t=this,a=cr(n,xt(n)));var l=!(dt(e)&&"chain"in e)||!!e.chain,c=Rn(t);return en(a,function(g){var w=n[g];t[g]=w,c&&(t.prototype[g]=function(){var A=this.__chain__;if(l||A){var I=t(this.__wrapped__),P=I.__actions__=Ut(this.__actions__);return P.push({func:w,args:arguments,thisArg:t}),I.__chain__=A,I}return w.apply(t,Dn([this.value()],arguments))})}),t}function Bd(){return Pt._===this&&(Pt._=hf),this}function us(){}function Ud(t){return t=V(t),J(function(n){return Wa(n,t)})}var $d=Bi(gt),Gd=Bi(sa),zd=Bi(fi);function ru(t){return Ki(t)?hi(Cn(t)):wh(t)}function Hd(t){return function(n){return t==null?r:Qn(t,n)}}var qd=ao(),Kd=ao(!0);function ls(){return[]}function fs(){return!1}function Vd(){return{}}function Zd(){return""}function Jd(){return!0}function Yd(t,n){if(t=V(t),t<1||t>vn)return[];var e=L,i=Tt(t,L);n=W(n),t-=L;for(var a=gi(i,n);++e<t;)n(e);return a}function Xd(t){return H(t)?gt(t,Cn):Yt(t)?[t]:Ut(So(it(t)))}function Qd(t){var n=++lf;return it(t)+n}var jd=mr(function(t,n){return t+n},0),t0=Ui("ceil"),n0=mr(function(t,n){return t/n},1),e0=Ui("floor");function r0(t){return t&&t.length?hr(t,zt,xi):r}function i0(t,n){return t&&t.length?hr(t,W(n,2),xi):r}function s0(t){return ua(t,zt)}function a0(t,n){return ua(t,W(n,2))}function o0(t){return t&&t.length?hr(t,zt,Ei):r}function u0(t,n){return t&&t.length?hr(t,W(n,2),Ei):r}var l0=mr(function(t,n){return t*n},1),f0=Ui("round"),h0=mr(function(t,n){return t-n},0);function c0(t){return t&&t.length?pi(t,zt):0}function p0(t,n){return t&&t.length?pi(t,W(n,2)):0}return u.after=Op,u.ary=ko,u.assign=Cg,u.assignIn=Zo,u.assignInWith=Rr,u.assignWith=Sg,u.at=bg,u.before=Oo,u.bind=Qi,u.bindAll=Ed,u.bindKey=Do,u.castArray=Vp,u.chain=Ro,u.chunk=ec,u.compact=rc,u.concat=ic,u.cond=Td,u.conforms=Rd,u.constant=ss,u.countBy=cp,u.create=xg,u.curry=No,u.curryRight=Wo,u.debounce=Bo,u.defaults=Ag,u.defaultsDeep=Ig,u.defer=Dp,u.delay=Np,u.difference=sc,u.differenceBy=ac,u.differenceWith=oc,u.drop=uc,u.dropRight=lc,u.dropRightWhile=fc,u.dropWhile=hc,u.fill=cc,u.filter=gp,u.flatMap=vp,u.flatMapDeep=mp,u.flatMapDepth=wp,u.flatten=Io,u.flattenDeep=pc,u.flattenDepth=gc,u.flip=Wp,u.flow=Ld,u.flowRight=kd,u.fromPairs=dc,u.functions=kg,u.functionsIn=Og,u.groupBy=yp,u.initial=vc,u.intersection=mc,u.intersectionBy=wc,u.intersectionWith=yc,u.invert=Ng,u.invertBy=Wg,u.invokeMap=Cp,u.iteratee=as,u.keyBy=Sp,u.keys=xt,u.keysIn=Gt,u.map=xr,u.mapKeys=Ug,u.mapValues=$g,u.matches=Od,u.matchesProperty=Dd,u.memoize=Ir,u.merge=Gg,u.mergeWith=Jo,u.method=Nd,u.methodOf=Wd,u.mixin=os,u.negate=Pr,u.nthArg=Ud,u.omit=zg,u.omitBy=Hg,u.once=Bp,u.orderBy=bp,u.over=$d,u.overArgs=Up,u.overEvery=Gd,u.overSome=zd,u.partial=ji,u.partialRight=Uo,u.partition=xp,u.pick=qg,u.pickBy=Yo,u.property=ru,u.propertyOf=Hd,u.pull=bc,u.pullAll=Eo,u.pullAllBy=xc,u.pullAllWith=Ac,u.pullAt=Ic,u.range=qd,u.rangeRight=Kd,u.rearg=$p,u.reject=Pp,u.remove=Pc,u.rest=Gp,u.reverse=Yi,u.sampleSize=Tp,u.set=Vg,u.setWith=Zg,u.shuffle=Rp,u.slice=Ec,u.sortBy=kp,u.sortedUniq=Dc,u.sortedUniqBy=Nc,u.split=vd,u.spread=zp,u.tail=Wc,u.take=Bc,u.takeRight=Uc,u.takeRightWhile=$c,u.takeWhile=Gc,u.tap=rp,u.throttle=Hp,u.thru=br,u.toArray=qo,u.toPairs=Xo,u.toPairsIn=Qo,u.toPath=Xd,u.toPlainObject=Vo,u.transform=Jg,u.unary=qp,u.union=zc,u.unionBy=Hc,u.unionWith=qc,u.uniq=Kc,u.uniqBy=Vc,u.uniqWith=Zc,u.unset=Yg,u.unzip=Xi,u.unzipWith=To,u.update=Xg,u.updateWith=Qg,u.values=_e,u.valuesIn=jg,u.without=Jc,u.words=nu,u.wrap=Kp,u.xor=Yc,u.xorBy=Xc,u.xorWith=Qc,u.zip=jc,u.zipObject=tp,u.zipObjectDeep=np,u.zipWith=ep,u.entries=Xo,u.entriesIn=Qo,u.extend=Zo,u.extendWith=Rr,os(u,u),u.add=jd,u.attempt=eu,u.camelCase=rd,u.capitalize=jo,u.ceil=t0,u.clamp=td,u.clone=Zp,u.cloneDeep=Yp,u.cloneDeepWith=Xp,u.cloneWith=Jp,u.conformsTo=Qp,u.deburr=tu,u.defaultTo=Fd,u.divide=n0,u.endsWith=id,u.eq=gn,u.escape=sd,u.escapeRegExp=ad,u.every=pp,u.find=dp,u.findIndex=xo,u.findKey=Pg,u.findLast=_p,u.findLastIndex=Ao,u.findLastKey=Eg,u.floor=e0,u.forEach=Fo,u.forEachRight=Lo,u.forIn=Tg,u.forInRight=Rg,u.forOwn=Fg,u.forOwnRight=Lg,u.get=es,u.gt=jp,u.gte=tg,u.has=Dg,u.hasIn=rs,u.head=Po,u.identity=zt,u.includes=Mp,u.indexOf=_c,u.inRange=nd,u.invoke=Bg,u.isArguments=ne,u.isArray=H,u.isArrayBuffer=ng,u.isArrayLike=$t,u.isArrayLikeObject=mt,u.isBoolean=eg,u.isBuffer=zn,u.isDate=rg,u.isElement=ig,u.isEmpty=sg,u.isEqual=ag,u.isEqualWith=og,u.isError=ts,u.isFinite=ug,u.isFunction=Rn,u.isInteger=$o,u.isLength=Er,u.isMap=Go,u.isMatch=lg,u.isMatchWith=fg,u.isNaN=hg,u.isNative=cg,u.isNil=gg,u.isNull=pg,u.isNumber=zo,u.isObject=dt,u.isObjectLike=vt,u.isPlainObject=Ne,u.isRegExp=ns,u.isSafeInteger=dg,u.isSet=Ho,u.isString=Tr,u.isSymbol=Yt,u.isTypedArray=de,u.isUndefined=_g,u.isWeakMap=vg,u.isWeakSet=mg,u.join=Mc,u.kebabCase=od,u.last=un,u.lastIndexOf=Cc,u.lowerCase=ud,u.lowerFirst=ld,u.lt=wg,u.lte=yg,u.max=r0,u.maxBy=i0,u.mean=s0,u.meanBy=a0,u.min=o0,u.minBy=u0,u.stubArray=ls,u.stubFalse=fs,u.stubObject=Vd,u.stubString=Zd,u.stubTrue=Jd,u.multiply=l0,u.nth=Sc,u.noConflict=Bd,u.noop=us,u.now=Ar,u.pad=fd,u.padEnd=hd,u.padStart=cd,u.parseInt=pd,u.random=ed,u.reduce=Ap,u.reduceRight=Ip,u.repeat=gd,u.replace=dd,u.result=Kg,u.round=f0,u.runInContext=v,u.sample=Ep,u.size=Fp,u.snakeCase=_d,u.some=Lp,u.sortedIndex=Tc,u.sortedIndexBy=Rc,u.sortedIndexOf=Fc,u.sortedLastIndex=Lc,u.sortedLastIndexBy=kc,u.sortedLastIndexOf=Oc,u.startCase=md,u.startsWith=wd,u.subtract=h0,u.sum=c0,u.sumBy=p0,u.template=yd,u.times=Yd,u.toFinite=Fn,u.toInteger=V,u.toLength=Ko,u.toLower=Md,u.toNumber=ln,u.toSafeInteger=Mg,u.toString=it,u.toUpper=Cd,u.trim=Sd,u.trimEnd=bd,u.trimStart=xd,u.truncate=Ad,u.unescape=Id,u.uniqueId=Qd,u.upperCase=Pd,u.upperFirst=is,u.each=Fo,u.eachRight=Lo,u.first=Po,os(u,function(){var t={};return yn(u,function(n,e){st.call(u.prototype,e)||(t[e]=n)}),t}(),{chain:!1}),u.VERSION=o,en(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){u[t].placeholder=u}),en(["drop","take"],function(t,n){j.prototype[t]=function(e){e=e===r?1:St(V(e),0);var i=this.__filtered__&&!n?new j(this):this.clone();return i.__filtered__?i.__takeCount__=Tt(e,i.__takeCount__):i.__views__.push({size:Tt(e,L),type:t+(i.__dir__<0?"Right":"")}),i},j.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),en(["filter","map","takeWhile"],function(t,n){var e=n+1,i=e==ye||e==zr;j.prototype[t]=function(a){var l=this.clone();return l.__iteratees__.push({iteratee:W(a,3),type:e}),l.__filtered__=l.__filtered__||i,l}}),en(["head","last"],function(t,n){var e="take"+(n?"Right":"");j.prototype[t]=function(){return this[e](1).value()[0]}}),en(["initial","tail"],function(t,n){var e="drop"+(n?"":"Right");j.prototype[t]=function(){return this.__filtered__?new j(this):this[e](1)}}),j.prototype.compact=function(){return this.filter(zt)},j.prototype.find=function(t){return this.filter(t).head()},j.prototype.findLast=function(t){return this.reverse().find(t)},j.prototype.invokeMap=J(function(t,n){return typeof t=="function"?new j(this):this.map(function(e){return Re(e,t,n)})}),j.prototype.reject=function(t){return this.filter(Pr(W(t)))},j.prototype.slice=function(t,n){t=V(t);var e=this;return e.__filtered__&&(t>0||n<0)?new j(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==r&&(n=V(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},j.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},j.prototype.toArray=function(){return this.take(L)},yn(j.prototype,function(t,n){var e=/^(?:filter|find|map|reject)|While$/.test(n),i=/^(?:head|last)$/.test(n),a=u[i?"take"+(n=="last"?"Right":""):n],l=i||/^find/.test(n);a&&(u.prototype[n]=function(){var c=this.__wrapped__,g=i?[1]:arguments,w=c instanceof j,A=g[0],I=w||H(c),P=function(Q){var tt=a.apply(u,Dn([Q],g));return i&&R?tt[0]:tt};I&&e&&typeof A=="function"&&A.length!=1&&(w=I=!1);var R=this.__chain__,D=!!this.__actions__.length,B=l&&!R,Z=w&&!D;if(!l&&I){c=Z?c:new j(this);var U=t.apply(c,g);return U.__actions__.push({func:br,args:[P],thisArg:r}),new sn(U,R)}return B&&Z?t.apply(this,g):(U=this.thru(P),B?i?U.value()[0]:U.value():U)})}),en(["pop","push","shift","sort","splice","unshift"],function(t){var n=Ye[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);u.prototype[t]=function(){var a=arguments;if(i&&!this.__chain__){var l=this.value();return n.apply(H(l)?l:[],a)}return this[e](function(c){return n.apply(H(c)?c:[],a)})}}),yn(j.prototype,function(t,n){var e=u[n];if(e){var i=e.name+"";st.call(fe,i)||(fe[i]=[]),fe[i].push({name:n,func:e})}}),fe[vr(r,K).name]=[{name:"wrapper",func:r}],j.prototype.clone=If,j.prototype.reverse=Pf,j.prototype.value=Ef,u.prototype.at=ip,u.prototype.chain=sp,u.prototype.commit=ap,u.prototype.next=op,u.prototype.plant=lp,u.prototype.reverse=fp,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=hp,u.prototype.first=u.prototype.head,be&&(u.prototype[be]=up),u},oe=af();Vn?((Vn.exports=oe)._=oe,ai._=oe):Pt._=oe}).call(We)})(Nr,Nr.exports);var fu=Nr.exports;const q=lu(fu);var ds={exports:{}},hs,su;function _0(){if(su)return hs;su=1;var h=1e3,s=h*60,r=s*60,o=r*24,f=o*7,p=o*365.25;hs=function(S,m){m=m||{};var T=typeof S;if(T==="string"&&S.length>0)return d(S);if(T==="number"&&isFinite(S))return m.long?y(S):_(S);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(S))};function d(S){if(S=String(S),!(S.length>100)){var m=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(S);if(m){var T=parseFloat(m[1]),O=(m[2]||"ms").toLowerCase();switch(O){case"years":case"year":case"yrs":case"yr":case"y":return T*p;case"weeks":case"week":case"w":return T*f;case"days":case"day":case"d":return T*o;case"hours":case"hour":case"hrs":case"hr":case"h":return T*r;case"minutes":case"minute":case"mins":case"min":case"m":return T*s;case"seconds":case"second":case"secs":case"sec":case"s":return T*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return T;default:return}}}}function _(S){var m=Math.abs(S);return m>=o?Math.round(S/o)+"d":m>=r?Math.round(S/r)+"h":m>=s?Math.round(S/s)+"m":m>=h?Math.round(S/h)+"s":S+"ms"}function y(S){var m=Math.abs(S);return m>=o?M(S,m,o,"day"):m>=r?M(S,m,r,"hour"):m>=s?M(S,m,s,"minute"):m>=h?M(S,m,h,"second"):S+" ms"}function M(S,m,T,O){var F=m>=T*1.5;return Math.round(S/T)+" "+O+(F?"s":"")}return hs}function v0(h){r.debug=r,r.default=r,r.coerce=y,r.disable=p,r.enable=f,r.enabled=d,r.humanize=_0(),r.destroy=M,Object.keys(h).forEach(S=>{r[S]=h[S]}),r.names=[],r.skips=[],r.formatters={};function s(S){let m=0;for(let T=0;T<S.length;T++)m=(m<<5)-m+S.charCodeAt(T),m|=0;return r.colors[Math.abs(m)%r.colors.length]}r.selectColor=s;function r(S){let m,T=null,O,F;function E(...N){if(!E.enabled)return;const K=E,Y=Number(new Date),X=Y-(m||Y);K.diff=X,K.prev=m,K.curr=Y,m=Y,N[0]=r.coerce(N[0]),typeof N[0]!="string"&&N.unshift("%O");let et=0;N[0]=N[0].replace(/%([a-zA-Z%])/g,(At,It)=>{if(At==="%%")return"%";et++;const Ht=r.formatters[It];if(typeof Ht=="function"){const jt=N[et];At=Ht.call(K,jt),N.splice(et,1),et--}return At}),r.formatArgs.call(K,N),(K.log||r.log).apply(K,N)}return E.namespace=S,E.useColors=r.useColors(),E.color=r.selectColor(S),E.extend=o,E.destroy=r.destroy,Object.defineProperty(E,"enabled",{enumerable:!0,configurable:!1,get:()=>T!==null?T:(O!==r.namespaces&&(O=r.namespaces,F=r.enabled(S)),F),set:N=>{T=N}}),typeof r.init=="function"&&r.init(E),E}function o(S,m){const T=r(this.namespace+(typeof m>"u"?":":m)+S);return T.log=this.log,T}function f(S){r.save(S),r.namespaces=S,r.names=[],r.skips=[];let m;const T=(typeof S=="string"?S:"").split(/[\s,]+/),O=T.length;for(m=0;m<O;m++)T[m]&&(S=T[m].replace(/\*/g,".*?"),S[0]==="-"?r.skips.push(new RegExp("^"+S.slice(1)+"$")):r.names.push(new RegExp("^"+S+"$")))}function p(){const S=[...r.names.map(_),...r.skips.map(_).map(m=>"-"+m)].join(",");return r.enable(""),S}function d(S){if(S[S.length-1]==="*")return!0;let m,T;for(m=0,T=r.skips.length;m<T;m++)if(r.skips[m].test(S))return!1;for(m=0,T=r.names.length;m<T;m++)if(r.names[m].test(S))return!0;return!1}function _(S){return S.toString().substring(2,S.toString().length-2).replace(/\.\*\?$/,"*")}function y(S){return S instanceof Error?S.stack||S.message:S}function M(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var m0=v0;(function(h,s){s.formatArgs=o,s.save=f,s.load=p,s.useColors=r,s.storage=d(),s.destroy=(()=>{let y=!1;return()=>{y||(y=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),s.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let y;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(y=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(y[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(y){if(y[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+y[0]+(this.useColors?"%c ":" ")+"+"+h.exports.humanize(this.diff),!this.useColors)return;const M="color: "+this.color;y.splice(1,0,M,"color: inherit");let S=0,m=0;y[0].replace(/%[a-zA-Z%]/g,T=>{T!=="%%"&&(S++,T==="%c"&&(m=S))}),y.splice(m,0,M)}s.log=console.debug||console.log||(()=>{});function f(y){try{y?s.storage.setItem("debug",y):s.storage.removeItem("debug")}catch{}}function p(){let y;try{y=s.storage.getItem("debug")}catch{}return!y&&typeof process<"u"&&"env"in process&&(y=process.env.DEBUG),y}function d(){try{return localStorage}catch{}}h.exports=m0(s);const{formatters:_}=h.exports;_.j=function(y){try{return JSON.stringify(y)}catch(M){return"[UnexpectedJSONParseError]: "+M.message}}})(ds,ds.exports);var w0=ds.exports;const y0=lu(w0),cs={};function Kn(h){if(!cs[h]){const s=y0("ultraPacer:core");s(`loading debug for namespace "${h}"`),cs[h]=s.extend(h)}return cs[h]}function Nt(h,s=0){return Math.round(h*10**s)/10**s}function ve(h,s,r,o,f){return r+(f-h)/(s-h)*(o-r)}function hu(h,s,r){let o=0,f=0;const p=[];for(o=0;o<r.length;o++)if(r[o]<h[f])p.push(s[f]);else{for(;f<h.length-1&&h[f+1]<=r[o];)f++;f===h.length-1||r[o]===h[f]?p.push(s[f]):p.push(ve(h[f],h[f+1],s[f],s[f+1],r[o]))}return p}function cu(h){let s,r,o,f,p=0,d=0,_=0,y=0,M=0;for(s=0;s<h.length;s++)r=h[s][0],o=h[s][1],f=h[s][2],M+=f,p+=f*r,_+=f*(r*r),d+=f*o,y+=f*(r*o);const S=(d*_-p*y)/(M*_-p*p);return[(M*y-p*d)/(M*_-p*p),S]}function pu(h,s,r,o){let f=0,p=0;const d=[];return r.forEach(_=>{for(;h[f]<_-o;)f++;for(f>0&&h[f]>=_&&f--;p<h.length-1&&h[p+1]<=_+o;)p++;p<h.length-1&&h[p]<=_&&p++;const y=Math.max(o,Math.abs(_-h[f])+.001,Math.abs(_-h[p])+.001),M=[];let S=0;for(let m=f;m<=p;m++)S=(1-(Math.abs(_-h[m])/y)**3)**3,M.push([h[m],s[m],S]);d.push(cu(M))}),d}function Ms(h,s,r){return Nt(h,r)<Nt(s,r)}function M0(h,s,r){return Nt(h,r)>Nt(s,r)}function me(h,s,r){return Nt(h,r)<=Nt(s,r)}function Ur(h,s,r){return Nt(h,r)>=Nt(s,r)}function Be(h,s,r){return Nt(h,r)===Nt(s,r)}const C0=Object.freeze(Object.defineProperty({__proto__:null,interp:ve,interpArray:hu,linearRegression:cu,req:Be,rgt:M0,rgte:Ur,rlt:Ms,rlte:me,round:Nt,wlslr:pu},Symbol.toStringTag,{value:"Module"}));class _n{constructor(s){C(this,"_altitude",1);C(this,"_grade",1);C(this,"_terrain",1);C(this,"_heat",1);C(this,"_dark",1);C(this,"_fatigue",1);C(this,"_strategy",1);C(this,"_combined");Object.assign(this,s)}init(s){return this._altitude=s,this._grade=s,this._terrain=s,this._heat=s,this._dark=s,this._fatigue=s,this._strategy=s,this}get altitude(){return this._altitude}set altitude(s){this._altitude=s,delete this._combined}get grade(){return this._grade}set grade(s){this._grade=s,delete this._combined}get terrain(){return this._terrain}set terrain(s){this._terrain=s,delete this._combined}get heat(){return this._heat}set heat(s){this._heat=s,delete this._combined}get dark(){return this._dark}set dark(s){this._dark=s,delete this._combined}get fatigue(){return this._fatigue}set fatigue(s){this._fatigue=s,delete this._combined}get strategy(){return this._strategy}set strategy(s){this._strategy=s,delete this._combined}get combined(){return this._combined===void 0&&(this._combined=this._altitude*this._grade*this._terrain*this._heat*this._dark*this._fatigue*this._strategy),this._combined}get(s){switch(s){case"altitude":return this.altitude;case"grade":return this.grade;case"terrain":return this.terrain;case"heat":return this.heat;case"dark":return this.dark;case"fatigue":return this.fatigue;case"strategy":return this.strategy;default:throw new Error(`${s} is not a valid factor`)}}applyEach(s,r){this._altitude=s(this._altitude,r.altitude),this._grade=s(this._grade,r.grade),this._terrain=s(this._terrain,r.terrain),this._heat=s(this._heat,r.heat),this._dark=s(this._dark,r.dark),this._fatigue=s(this._fatigue,r.fatigue),this._strategy=s(this._strategy,r.strategy)}scaleEach(s){return this._altitude*=s,this._grade*=s,this._terrain*=s,this._heat*=s,this._dark*=s,this._fatigue*=s,this._strategy*=s,delete this._combined,this}}class _s{constructor(s,r,o){C(this,"factors",new _n);C(this,"point");C(this,"course");C(this,"loop");Object.defineProperty(this,"course",{writable:!0}),this.point=r,this.course=s,this.loop=o}get lat(){return this.point.lat}get lon(){return this.point.lon}get alt(){return this.point.alt}get latlon(){return this.point.latlon}get grade(){return this.point.grade*(this.point.grade>0?this.course.gainScale:this.course.lossScale)}get loc(){let s=this.point.loc*this.course.distScale;return this.loop&&(s+=this.course.loopDist*this.loop),s}}const S0={rate:6,span:1e3,th:750};function gu(h,s){(s===null||typeof s>"u")&&(s=S0);let r=0;return Array.isArray(h)?r=(h[0]+h[1])/2:r=h,r<=s.th?1:(1+s.rate/s.span/100)**(r-s.th)}const au={baseline:0,terrainScale:1};function du(h,s){function r(o){return o<h.noon?o+86400:o}return s>=h.sunrise&&s<=h.sunset?0:!isNaN(h.dawn)&&!isNaN(h.dusk)&&(s<=h.dawn||s>=h.dusk)?1:r(s)>=r(h.nadir)?ve(r(isNaN(h.dawn)?h.nadir:h.dawn),r(h.sunrise),1,0,r(s)):ve(r(h.sunset),r(isNaN(h.dusk)?h.nadir:h.dusk),0,1,r(s))}function _u(h,s,r,o=au){if(s===1||h>=r.sunrise&&h<=r.sunset)return 1;(o===null||typeof o>"u")&&(o=au);const f=r.nadirAltitude<-6?1:-(r.nadirAltitude/6),p=(o.terrainScale*(s-1)+o.baseline)*f,d=du(r,h);return 1+p*d}const b0={a:.0021,b:.034,lower:{lim:-22,m:-.0584,b:-.0164},upper:{lim:16,m:.1012,b:.4624}};function vu(h,s){return(s===null||typeof s>"u")&&(s=b0),h<s.lower.lim?s.lower.m*h+s.lower.b:h>s.upper.lim?s.upper.m*h+s.upper.b:s.a*h**2+s.b*h+1}function mu(h,s){if(!s)return 1;const r=h.tod;let o=1;if(r>s.start&&r<s.stop){const f=(r-s.start)/(s.stop-s.start)*Math.PI;o+=(s.max-s.baseline)*Math.sin(f)/100}return o+=s.baseline/100,o}function wu(h,s){const r=q.findLast(s.terrain,o=>me(o.percents[0]*s.dist,h.loc,4));return r?r.value/100+1:1}const yu=["altitude","grade","terrain","heat","dark","fatigue","strategy"];function Cs(h){const s=new _n().init(0);return h.forEach(({factors:r,dist:o})=>{s.applyEach((f,p)=>f+o*p,r)}),s.scaleEach(1/fu.sumBy(h,"dist")),s}function Mu(h,s){let r=0,o=0;return h.forEach((f,p)=>{const d=p===h.length-1?s:h[p+1].onset,_=f.type==="linear"?f.value/2:f.value;o+=(r+_)*(d-f.onset),r+=f.value}),o/s}function x0(h){return h<30?2:h<60?5:h<90?10:h<120?15:20}function A0(h,s,r){let o=-Mu(s,r);return s.forEach((f,p)=>{if(h>=f.onset){if(f.type==="step")o+=f.value;else if(f.type==="linear"){const d=p===s.length-1?r:s[p+1].onset;h>d?o+=f.value:o+=f.value*(h-f.onset)/(d-f.onset)}}}),o}class Ss{constructor(s,r){C(this,"plan");C(this,"values");this.plan=s,this.values=r?q.cloneDeep(r):[{onset:0,value:x0(this.plan.course.dist),type:"linear"}]}at(s){return 1+A0(s,this.values,this.plan.course.dist)/100}addValue(s){const r=this.values.findIndex(o=>o.onset>=s.onset);r>=0?this.values.splice(r,0,s):this.values.push(s)}}function vs(h,s){return s===void 0?h:(h-1)*s+1}function bs(h,s){h.factors||(h.factors=new _n),Object.assign(h.factors,{grade:vu(h.grade),altitude:gu(h.alt),terrain:wu(h,s)})}function Wr(h,s){var r,o;if(h.factors||(h.factors=new _n),bs(h,s.course),s){if(h.factors===void 0)throw new Error("no factors");h.factors.strategy=s.strategy.at(h.loc),Object.assign(h.factors,{heat:s.heatModel?mu(h,s.heatModel):1,dark:s.event.sun?_u(h.tod,h.factors.terrain,s.event.sun):1})}h.factors.altitude=vs(h.factors.altitude,(r=s.scales)==null?void 0:r.altitude),h.factors.dark=vs(h.factors.dark,(o=s.scales)==null?void 0:o.dark)}const I0=Object.freeze(Object.defineProperty({__proto__:null,Factors:_n,Strategy:Ss,applyScale:vs,generateCourseFactors:bs,generatePlanFactors:Wr,getAltitudeFactor:gu,getDarkFactor:_u,getGradeFactor:vu,getHeatFactor:mu,getTerrainFactor:wu,list:yu,rollup:Cs},Symbol.toStringTag,{value:"Module"}));function Cu(h){switch(h){case"kilometers":return 1;case"miles":return .621371;default:throw new Error("Invalid distance unit")}}function Fr(h){return typeof h=="number"&&!isNaN(h)}function P0(h,s,r){const o=h.filter((p,d)=>d>=h.findIndex(_=>_===s)&&d<=h.findIndex(_=>_===r)),f=o.map((p,d)=>({factors:p.factors,dist:d===o.length-1?0:o[d+1].loc-o[d].loc}));return f.pop(),Cs(f)}class Su{constructor(s){C(this,"point1");C(this,"point2");C(this,"gain");C(this,"loss");C(this,"grade");C(this,"waypoint");C(this,"_name");this.point1=s.point1,this.point2=s.point2,this.gain=s.gain,this.loss=s.loss,this.grade=s.grade,s.name&&(this._name=s.name)}get name(){var s;return this._name||((s=this.waypoint)==null?void 0:s.name)||void 0}get start(){return this.point1.loc}get dist(){return this.point2.loc-this.point1.loc}get end(){return this.point2.loc}get alt(){return this.point2.alt}}class bu extends Su{constructor(r,o){super(o);C(this,"_course");C(this,"point1");C(this,"point2");this._course=r,this.point1=o.point1,this.point2=o.point2}}class xu extends Su{constructor(r,o){super(o);C(this,"_plan");C(this,"point1");C(this,"point2");C(this,"_factors");this._plan=r,this.point1=o.point1,this.point2=o.point2}get pace(){return this.time?this.time/this.dist:0}get delay(){if(!(!Fr(this.point1.elapsed)||!Fr(this.point2.elapsed)||!Fr(this.point1.time)||!Fr(this.point2.time)))return this.point2.elapsed-this.point1.elapsed-(this.point2.time-this.point1.time)}get elapsed(){return this.point2.elapsed}get time(){if(!(!q.isNumber(this.point1.time)||!q.isNumber(this.point2.time)))return this.point2.time-this.point1.time}get tod(){return this.point2.tod}set delay(r){}set pace(r){}set elapsed(r){}set time(r){}set tod(r){}get factors(){return this._factors||(this._factors=P0(this._plan.points,this.point1,this.point2))}}const ps=Kn("CourseSplits");class E0{constructor(s){C(this,"_segments");C(this,"_miles");C(this,"_kilometers");C(this,"course");this.course=s}get segments(){return this._segments||(this._segments=this.createSegments()),this._segments}set segments(s){this._segments=s}get miles(){var s;return(s=this._miles)!=null&&s.length||(this._miles=this.createSplits("miles")),this._miles}set miles(s){this._miles=s}get kilometers(){var s;return(s=this._kilometers)!=null&&s.length||(this._kilometers=this.createSplits("kilometers")),this._kilometers}set kilometers(s){this._kilometers=s}createSegments(){ps("createSegments");const s=this.course.waypoints.filter(o=>o.tier<3).sort((o,f)=>o.loc-f.loc),r=this.calcSegments(this.course.locationsToBreaks(s.map(o=>o.loc)));if(!r.length)throw new Error("createSegments result is empty");return r.forEach((o,f)=>{o.waypoint=s[f+1]}),r}createSplits(s){ps(`createSplits:${s}`);const r=Cu(s),o=q.range(this.course.dist*r).map(p=>p/r);this.course.dist-o[o.length-1]>1e-4&&o.push(this.course.dist);const f=this.calcSegments(this.course.locationsToBreaks(o));if(!f.length)throw new Error("createSplits result is empty");return f}calcSegments(s){var T;ps.extend("calcSegments")("exec");const o=this.course,f=o.points,p=[],d=[];let _,y,M=o.points[0],S;for(_=0,y=s.length;_<y;_++){const O=s[_];S&&Be((T=s[_-1])==null?void 0:T.end,O.start,4)?M=S:M=o.getPoint(O.start),S=o.getPoint(O.end);const F=O.end-O.start,E=new bu(this.course,{gain:0,loss:0,grade:F>0?(S.alt-M.alt)/F/10*(S.alt-M.alt>0?o.gainScale:o.lossScale):0,point1:M,point2:S}),N=new _n().init(0);p.push(E),d.push(N)}const m=(O,F,E,N)=>{const K=E.alt-F.alt;O[K>0?"gain":"loss"]+=K*(K>0?o.gainScale:o.lossScale),bs(F,o);const Y=E.loc-F.loc;N.applyEach((X,et)=>X+et*Y,F.factors)};_=1;for(let O=0;O<p.length;O++){const F=p[O],E=d[O];for(;me(f[_].loc,F.point1.loc,4);)_++;let N=F.point1;for(;_<f.length&&me(f[_].loc,F.point2.loc,4);){const K=f[_];m(F,N,K,E),N=K,_++}m(F,N,F.point2,E)}return p}}var Au={};(function(h){h.parseDMS=function(r){if(typeof f=="object")throw new TypeError("geo.parseDMS - dmsStr is [DOM?] object");if(typeof r=="number"&&isFinite(r))return Number(r);var o=String(r).trim().replace(/^-/,"").replace(/[NSEW]$/i,"").split(/[^0-9.,]+/);if(o[o.length-1]==""&&o.splice(o.length-1),o=="")return NaN;switch(o.length){case 3:var f=o[0]/1+o[1]/60+o[2]/3600;break;case 2:var f=o[0]/1+o[1]/60;break;case 1:var f=o[0];break;default:return NaN}return/^-|[WS]$/i.test(r.trim())&&(f=-f),Number(f)},h.toDMS=function(r,o,f){if(typeof r=="object")throw new TypeError("geo.toDMS - deg is [DOM?] object");if(isNaN(r))return null;if(typeof o>"u"&&(o="dms"),typeof f>"u")switch(o){case"d":f=4;break;case"dm":f=2;break;case"dms":f=0;break;default:o="dms",f=0}switch(r=Math.abs(r),o){case"d":_=r.toFixed(f),_<100&&(_="0"+_),_<10&&(_="0"+_),dms=_+"°";break;case"dm":var p=(r*60).toFixed(f),_=Math.floor(p/60),y=(p%60).toFixed(f);_<100&&(_="0"+_),_<10&&(_="0"+_),y<10&&(y="0"+y),dms=_+"°"+y+"′";break;case"dms":var d=(r*3600).toFixed(f),_=Math.floor(d/3600),y=Math.floor(d/60)%60,M=(d%60).toFixed(f);_<100&&(_="0"+_),_<10&&(_="0"+_),y<10&&(y="0"+y),M<10&&(M="0"+M),dms=_+"°"+y+"′"+M+"″";break}return dms},h.toLat=function(r,o,f){var p=h.toDMS(r,o,f);return p==null?".":p.slice(1)+(r<0?"S":"N")},h.toLon=function(r,o,f){var p=h.toDMS(r,o,f);return p==null?".":p+(r<0?"W":"E")},h.toBrng=function(r,o,f){r=(Number(r)+360)%360;var p=h.toDMS(r,o,f);return p==null?".":p.replace("360","0")};var s=6371;h.latlon=function(r,o){this.lat=typeof r=="number"?r:typeof r=="string"&&r.trim()!=""?+r:NaN,this.lng=typeof o=="number"?o:typeof o=="string"&&o.trim()!=""?+o:NaN},h.latlon.prototype.distanceTo=function(r,o){typeof o>"u"&&(o=4);var f=this.distanceRadTo(r),p=s*f;return p.toPrecisionFixed(o)},h.latlon.prototype.distanceRadTo=function(r){var o=this.lat.toRad(),f=this.lng.toRad(),p=r.lat.toRad(),d=r.lng.toRad(),_=p-o,y=d-f,M=Math.sin(_/2)*Math.sin(_/2)+Math.cos(o)*Math.cos(p)*Math.sin(y/2)*Math.sin(y/2),S=2*Math.atan2(Math.sqrt(M),Math.sqrt(1-M));return S},h.latlon.prototype.bearingTo=function(r){var o=this.bearingRadTo(r);return(o.toDeg()+360)%360},h.latlon.prototype.bearingRadTo=function(r){var o=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),d=Math.cos(o)*Math.sin(f)-Math.sin(o)*Math.cos(f)*Math.cos(p),_=Math.cos(f)*Math.sin(p),y=Math.atan2(_,d);return y},h.latlon.prototype.finalBearingTo=function(r){var o=r.lat.toRad(),f=this.lat.toRad(),p=(this.lng-r.lng).toRad(),d=Math.sin(p)*Math.cos(f),_=Math.cos(o)*Math.sin(f)-Math.sin(o)*Math.cos(f)*Math.cos(p),y=Math.atan2(d,_);return(y.toDeg()+180)%360},h.latlon.prototype.midpointTo=function(r){var o=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),d=Math.cos(f)*Math.cos(p),_=Math.cos(f)*Math.sin(p),y=this.lng.toRad(),M=Math.atan2(Math.sin(o)+Math.sin(f),Math.sqrt((Math.cos(o)+d)*(Math.cos(o)+d)+_*_)),S=y+Math.atan2(_,Math.cos(o)+d);return S=(S+3*Math.PI)%(2*Math.PI)-Math.PI,new h.latlon(M.toDeg(),S.toDeg())},h.midpoint=function(r){var o=0,f=0,p=0;for(var d in r){var _=r[d],y=_.lat*Math.PI/180,M=_.lng*Math.PI/180,S=Math.cos(y)*Math.cos(M),m=Math.cos(y)*Math.sin(M),T=Math.sin(y);o+=S,f+=m,p+=T}o=o/r.length,f=f/r.length,p=p/r.length;var O=Math.atan2(f,o),F=Math.sqrt(o*o+f*f),E=Math.atan2(p,F);return new h.latlon(E*180/Math.PI,O*180/Math.PI)},h.latlon.prototype.interpolate=function(r,o){var f=this.distanceRadTo(r),p=this.bearingRadTo(r),d=this.lat.toRad(),_=this.lng.toRad();r.lat.toRad(),r.lng.toRad();for(var y=Math.sin(d),M=Math.cos(d),S=[],m=0;m<o;m++){var T=1/(o-1)*m,O=f*T,F=Math.sin(O),E=Math.cos(O),N=Math.asin(y*E+M*F*Math.cos(p)),K=_+Math.atan2(Math.sin(p)*F*M,E-y*Math.sin(N)),Y=N.toDeg(),X=K.toDeg();for(Y>90&&(Y=90),Y<-90&&(Y=-90);X>180;)X-=360;for(;X<=-180;)X+=360;S.push(new h.latlon(Y,X))}return S},h.latlon.prototype.destinationPoint=function(r,o){o=typeof o=="number"?o:typeof o=="string"&&o.trim()!=""?+o:NaN,o=o/s,r=r.toRad();var f=this.lat.toRad(),p=this.lng.toRad(),d=Math.asin(Math.sin(f)*Math.cos(o)+Math.cos(f)*Math.sin(o)*Math.cos(r)),_=p+Math.atan2(Math.sin(r)*Math.sin(o)*Math.cos(f),Math.cos(o)-Math.sin(f)*Math.sin(d));return _=(_+3*Math.PI)%(2*Math.PI)-Math.PI,new h.latlon(d.toDeg(),_.toDeg())},h.latlon.intersection=function(r,o,f,p){o=typeof o=="number"?o:typeof o=="string"&&trim(o)!=""?+o:NaN,p=typeof p=="number"?p:typeof p=="string"&&trim(p)!=""?+p:NaN;var d=r.lat.toRad(),_=r.lng.toRad(),y=f.lat.toRad(),M=f.lng.toRad(),S=o.toRad(),m=p.toRad(),T=y-d,O=M-_,F=2*Math.asin(Math.sqrt(Math.sin(T/2)*Math.sin(T/2)+Math.cos(d)*Math.cos(y)*Math.sin(O/2)*Math.sin(O/2)));if(F==0)return null;var E=Math.acos((Math.sin(y)-Math.sin(d)*Math.cos(F))/(Math.sin(F)*Math.cos(d)));isNaN(E)&&(E=0);var N=Math.acos((Math.sin(d)-Math.sin(y)*Math.cos(F))/(Math.sin(F)*Math.cos(y)));if(Math.sin(M-_)>0)var K=E,Y=2*Math.PI-N;else K=2*Math.PI-E,Y=N;var X=(S-K+Math.PI)%(2*Math.PI)-Math.PI,et=(Y-m+Math.PI)%(2*Math.PI)-Math.PI;if(Math.sin(X)==0&&Math.sin(et)==0||Math.sin(X)*Math.sin(et)<0)return null;var bt=Math.acos(-Math.cos(X)*Math.cos(et)+Math.sin(X)*Math.sin(et)*Math.cos(F)),At=Math.atan2(Math.sin(F)*Math.sin(X)*Math.sin(et),Math.cos(et)+Math.cos(X)*Math.cos(bt)),It=Math.asin(Math.sin(d)*Math.cos(At)+Math.cos(d)*Math.sin(At)*Math.cos(S)),Ht=Math.atan2(Math.sin(S)*Math.sin(At)*Math.cos(d),Math.cos(At)-Math.sin(d)*Math.sin(It)),jt=_+Ht;return jt=(jt+3*Math.PI)%(2*Math.PI)-Math.PI,new h.latlon(It.toDeg(),jt.toDeg())},h.latlon.prototype.rhumbDistanceTo=function(r){var o=s,f=this.lat.toRad(),p=r.lat.toRad(),d=(r.lat-this.lat).toRad(),_=Math.abs(r.lng-this.lng).toRad(),y=Math.log(Math.tan(p/2+Math.PI/4)/Math.tan(f/2+Math.PI/4)),M=isFinite(d/y)?d/y:Math.cos(f);Math.abs(_)>Math.PI&&(_=_>0?-(2*Math.PI-_):2*Math.PI+_);var S=Math.sqrt(d*d+M*M*_*_)*o;return S.toPrecisionFixed(4)},h.latlon.prototype.rhumbBearingTo=function(r){var o=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),d=Math.log(Math.tan(f/2+Math.PI/4)/Math.tan(o/2+Math.PI/4));Math.abs(p)>Math.PI&&(p=p>0?-(2*Math.PI-p):2*Math.PI+p);var _=Math.atan2(p,d);return(_.toDeg()+360)%360},h.latlon.prototype.rhumbDestinationPoint=function(r,o){var f=s,p=parseFloat(o)/f,d=this.lat.toRad(),_=this.lng.toRad();r=r.toRad();var y=p*Math.cos(r);Math.abs(y)<1e-10&&(y=0);var M=d+y,S=Math.log(Math.tan(M/2+Math.PI/4)/Math.tan(d/2+Math.PI/4)),m=isFinite(y/S)?y/S:Math.cos(d),T=p*Math.sin(r)/m;Math.abs(M)>Math.PI/2&&(M=M>0?Math.PI-M:-Math.PI-M);var O=(_+T+3*Math.PI)%(2*Math.PI)-Math.PI;return new h.latlon(M.toDeg(),O.toDeg())},h.latlon.prototype.rhumbMidpointTo=function(r){var o=this.lat.toRad(),f=this.lng.toRad(),p=r.lat.toRad(),d=r.lng.toRad();Math.abs(d-f)>Math.PI&&(f+=2*Math.PI);var _=(o+p)/2,y=Math.tan(Math.PI/4+o/2),M=Math.tan(Math.PI/4+p/2),S=Math.tan(Math.PI/4+_/2),m=((d-f)*Math.log(S)+f*Math.log(M)-d*Math.log(y))/Math.log(M/y);return isFinite(m)||(m=(f+d)/2),m=(m+3*Math.PI)%(2*Math.PI)-Math.PI,new h.latlon(_.toDeg(),m.toDeg())},h.latlon.prototype.lat=function(r,o){return typeof r>"u"?this.lat:h.toLat(this.lat,r,o)},h.latlon.prototype.lon=function(r,o){return typeof r>"u"?this.lng:h.toLon(this.lng,r,o)},h.latlon.prototype.toString=function(r,o){return typeof r>"u"&&(r="dms"),h.toLat(this.lat,r,o)+", "+h.toLon(this.lng,r,o)},typeof Number.prototype.toRad>"u"&&(Number.prototype.toRad=function(){return this*Math.PI/180}),typeof Number.prototype.toDeg>"u"&&(Number.prototype.toDeg=function(){return this*180/Math.PI}),typeof Number.prototype.toPrecisionFixed>"u"&&(Number.prototype.toPrecisionFixed=function(r){var o=this.toPrecision(r);return o=o.replace(/(.+)e\+(.+)/,function(f,p,d){p=p.replace(/\./,"");for(var _=p.length-1;d-- >_;)p=p+"0";return p}),o=o.replace(/(.+)e-(.+)/,function(f,p,d){for(p=p.replace(/\./,"");d-- >1;)p="0"+p;return"0."+p}),o}),typeof String.prototype.trim>"u"&&(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")})})(Au);class xs{constructor(s,r,o){C(this,"alt");C(this,"lat");C(this,"lon");this.lat=s,this.lon=r,this.alt=o}get latlon(){return new Au.latlon(this.lat,this.lon)}}class As extends xs{constructor(r,o,f,p,d){super(r,o,f);C(this,"loc");C(this,"grade");this.loc=p,this.grade=d}}function Is(h,s,r){if(h.loc>s.loc&&r>h.loc||s.loc>h.loc&&r>s.loc)throw new Error("Input location must be between points");const o=Math.abs(h.loc-r),f=h.latlon.bearingTo(s.latlon),{lat:p,lng:d}=h.latlon.destinationPoint(f,o),_=h.grade,y=ve(h.loc,s.loc,h.alt,s.alt,r);return new As(p,d,y,r,_)}function T0(h,s){return(typeof h=="object"?String(h.id):h)===(typeof s=="object"?String(s.id):s)}function ms(h,s){return!!(h&&s&&T0(h.site,s.site)&&h.loop===s.loop)}class ws{constructor(s,r=1){C(this,"_data");C(this,"loop");C(this,"site");this._data={},this.site=s,this.loop=r}get course(){return this.site.course}get name(){return this.loop>=2&&this.type!=="finish"?`${this.site.name} ${this.loop}`:this.site.name}get description(){return this.site.description}get loc(){return(this.site.percent+this.loop-1)*this.course.loopDist}set loc(s){if(!q.isNumber(s))throw new Error("Wrong format for Waypoint.loc");this.type==="start"?this.site.percent=0:this.type==="finish"?this.site.percent=1:this.site.percent=s/this.course.loopDist%1}get lat(){return this.site.lat}get lon(){return this.site.lon}get alt(){return this.site.alt}get tier(){return this.site.tier||1}get type(){return this.site.type}get hasTypicalDelay(){return this.type==="aid"||this.type==="water"||this.loop>=2&&this.type==="start"}get cutoff(){var s;if(this.tier===1){const r=(s=this.site.cutoffs)==null?void 0:s.find(o=>o.loop===this.loop);if(r)return r.time}return null}set cutoff(s){var o;const r=(o=this.site.cutoffs)==null?void 0:o.findIndex(f=>f.loop===this.loop);r>=0?s?this.site.cutoffs[r].time=s:this.site.cutoffs.splice(r,1):s&&(this.site.cutoffs||(this.site.cutoffs=[]),this.site.cutoffs.push({time:s,loop:this.loop}))}matchingSegment(s){return s.find(r=>r.waypoint&&ms(this,r.waypoint))}}const Lr=Kn("models:Waypoint");class Dr{constructor(s,r){C(this,"_waypoints");C(this,"_lat",NaN);C(this,"_lon",NaN);C(this,"_alt",NaN);C(this,"_data");C(this,"course");C(this,"cutoffs",[]);C(this,"id");C(this,"name");C(this,"tier",1);C(this,"type");C(this,"description");this._data={percent:r.percent},this.course=s,this.id=r.id,this.type=r.type,this.name=r.name,r.cutoffs&&(this.cutoffs=r.cutoffs),r.tier!==void 0&&(this.tier=r.tier),r.description&&(this.description=r.description),Lr(`constructor: ${this.name}`)}clearCache(){Lr(`clearCache: ${this.name}`),delete this._waypoints,this._lat=NaN,this._lon=NaN,this._alt=NaN}get percent(){switch(this.type){case"start":return 0;case"finish":return 1;default:return this._data.percent}}set percent(s){this._data.percent=s}get waypoints(){return this._waypoints?this._waypoints:(Lr(`generating waypoints array: ${this.name}`),this.type==="finish"?this._waypoints=[new ws(this,this.course.loops)]:this._waypoints=q.range(this.course.loops).map(s=>new ws(this,s+1)),this._waypoints)}get lat(){return q.isNaN(this._lat)&&this.refreshLLA(),this._lat}get lon(){return q.isNaN(this._lon)&&this.refreshLLA(),this._lon}get alt(){return q.isNaN(this._alt)&&this.refreshLLA(),this._alt}refreshLLA(){Lr("refreshLLA");let s,r,o;this.type==="start"?{lat:s,lon:r,alt:o}=this.course.track.points[0]:this.type==="finish"?{lat:s,lon:r,alt:o}=this.course.track.points[this.course.track.points.length-1]:{lat:s,lon:r,alt:o}=this.course.track.getLLA(this.percent*this.course.track.dist),this._lat=s,this._lon=r,this._alt=o,this.course.clearCache(1)}}var Iu={exports:{}};(function(h,s){(function(){var r=Math.PI,o=Math.sin,f=Math.cos,p=Math.tan,d=Math.asin,_=Math.atan2,y=Math.acos,M=r/180,S=1e3*60*60*24,m=2440588,T=2451545;function O(L){return L.valueOf()/S-.5+m}function F(L){return new Date((L+.5-m)*S)}function E(L){return O(L)-T}var N=M*23.4397;function K(L,$){return _(o(L)*f(N)-p($)*o(N),f(L))}function Y(L,$){return d(o($)*f(N)+f($)*o(N)*o(L))}function X(L,$,G){return _(o(L),f(L)*o($)-p(G)*f($))}function et(L,$,G){return d(o($)*o(G)+f($)*f(G)*f(L))}function bt(L,$){return M*(280.16+360.9856235*L)-$}function At(L){return L<0&&(L=0),2967e-7/Math.tan(L+.00312536/(L+.08901179))}function It(L){return M*(357.5291+.98560028*L)}function Ht(L){var $=M*(1.9148*o(L)+.02*o(2*L)+3e-4*o(3*L)),G=M*102.9372;return L+$+G+r}function jt(L){var $=It(L),G=Ht($);return{dec:Y(G,0),ra:K(G,0)}}var qt={};qt.getPosition=function(L,$,G){var ht=M*-G,nt=M*$,ct=E(L),ot=jt(ct),lt=bt(ct,ht)-ot.ra;return{azimuth:X(lt,nt,ot.dec),altitude:et(lt,nt,ot.dec)}};var we=qt.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];qt.addTime=function(L,$,G){we.push([L,$,G])};var Ue=9e-4;function Gr(L,$){return Math.round(L-Ue-$/(2*r))}function ye(L,$,G){return Ue+(L+$)/(2*r)+G}function $e(L,$,G){return T+L+.0053*o($)-.0069*o(2*G)}function zr(L,$,G){return y((o(L)-o($)*o(G))/(f($)*f(G)))}function Sn(L){return-2.076*Math.sqrt(L)/60}function vn(L,$,G,ht,nt,ct,ot){var lt=zr(L,G,ht),yt=ye(lt,$,nt);return $e(yt,ct,ot)}qt.getTimes=function(L,$,G,ht){ht=ht||0;var nt=M*-G,ct=M*$,ot=Sn(ht),lt=E(L),yt=Gr(lt,nt),Kt=ye(0,nt,yt),Ft=It(Kt),Wt=Ht(Ft),mn=Y(Wt,0),_t=$e(Kt,Ft,Wt),Lt,kn,Mt,Bt,hn,tn,pt={solarNoon:F(_t),nadir:F(_t-.5)};for(Lt=0,kn=we.length;Lt<kn;Lt+=1)Mt=we[Lt],Bt=(Mt[0]+ot)*M,hn=vn(Bt,nt,ct,mn,yt,Ft,Wt),tn=_t-(hn-_t),pt[Mt[1]]=F(tn),pt[Mt[2]]=F(hn);return pt};function Ge(L){var $=M*(218.316+13.176396*L),G=M*(134.963+13.064993*L),ht=M*(93.272+13.22935*L),nt=$+M*6.289*o(G),ct=M*5.128*o(ht),ot=385001-20905*f(G);return{ra:K(nt,ct),dec:Y(nt,ct),dist:ot}}qt.getMoonPosition=function(L,$,G){var ht=M*-G,nt=M*$,ct=E(L),ot=Ge(ct),lt=bt(ct,ht)-ot.ra,yt=et(lt,nt,ot.dec),Kt=_(o(lt),p(nt)*f(ot.dec)-o(ot.dec)*f(lt));return yt=yt+At(yt),{azimuth:X(lt,nt,ot.dec),altitude:yt,distance:ot.dist,parallacticAngle:Kt}},qt.getMoonIllumination=function(L){var $=E(L||new Date),G=jt($),ht=Ge($),nt=149598e3,ct=y(o(G.dec)*o(ht.dec)+f(G.dec)*f(ht.dec)*f(G.ra-ht.ra)),ot=_(nt*o(ct),ht.dist-nt*f(ct)),lt=_(f(G.dec)*o(G.ra-ht.ra),o(G.dec)*f(ht.dec)-f(G.dec)*o(ht.dec)*f(G.ra-ht.ra));return{fraction:(1+f(ot))/2,phase:.5+.5*ot*(lt<0?-1:1)/Math.PI,angle:lt}};function bn(L,$){return new Date(L.valueOf()+$*S/24)}qt.getMoonTimes=function(L,$,G,ht){var nt=new Date(L);ht?nt.setUTCHours(0,0,0,0):nt.setHours(0,0,0,0);for(var ct=.133*M,ot=qt.getMoonPosition(nt,$,G).altitude-ct,lt,yt,Kt,Ft,Wt,mn,_t,Lt,kn,Mt,Bt,hn,tn,pt=1;pt<=24&&(lt=qt.getMoonPosition(bn(nt,pt),$,G).altitude-ct,yt=qt.getMoonPosition(bn(nt,pt+1),$,G).altitude-ct,Wt=(ot+yt)/2-lt,mn=(yt-ot)/2,_t=-mn/(2*Wt),Lt=(Wt*_t+mn)*_t+lt,kn=mn*mn-4*Wt*lt,Mt=0,kn>=0&&(tn=Math.sqrt(kn)/(Math.abs(Wt)*2),Bt=_t-tn,hn=_t+tn,Math.abs(Bt)<=1&&Mt++,Math.abs(hn)<=1&&Mt++,Bt<-1&&(Bt=hn)),Mt===1?ot<0?Kt=pt+Bt:Ft=pt+Bt:Mt===2&&(Kt=pt+(Lt<0?hn:Bt),Ft=pt+(Lt<0?Bt:hn)),!(Kt&&Ft));pt+=2)ot=yt;var wn={};return Kt&&(wn.rise=bn(nt,Kt)),Ft&&(wn.set=bn(nt,Ft)),!Kt&&!Ft&&(wn[Lt>0?"alwaysUp":"alwaysDown"]=!0),wn},h.exports=qt})()})(Iu);var ou=Iu.exports;function qn(h,s){const r=h.toLocaleString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:s}).split(":").map(o=>Number(o));return r[0]*60*60+r[1]*60+r[2]}class R0{constructor(s){C(this,"nadir",0);C(this,"dawn",0);C(this,"sunrise",0);C(this,"dusk",0);C(this,"sunset",0);C(this,"noon",0);C(this,"nadirAltitude",0);Object.assign(this,s)}}class Ps{constructor(s,r,o,f){C(this,"start");C(this,"lat");C(this,"lon");C(this,"timezone");C(this,"sun");C(this,"startTime");this.start=s,this.lat=o,this.lon=f,this.timezone=r;const p=ou.getTimes(this.start,this.lat,this.lon),d=ou.getPosition(p.nadir,this.lat,this.lon);this.sun=new R0({nadir:qn(p.nadir,this.timezone),dawn:qn(p.dawn,this.timezone),sunrise:qn(p.sunrise,this.timezone),dusk:qn(p.dusk,this.timezone),sunset:qn(p.sunset,this.timezone),noon:qn(p.solarNoon,this.timezone),nadirAltitude:d.altitude*180/Math.PI}),this.startTime=qn(this.start,this.timezone)}dateAtElapsed(s){const r=new Date(this.start);return r.setTime(r.getTime()+s*1e3),r}elapsedToTimeOfDay(s){return(this.startTime+s)%86400}}const kr=Kn("models:Course"),Pu=[{type:"paved",value:0},{type:"dirt road",value:4},{type:"doubletrack",value:8},{type:"singletrack",value:15},{type:"technical",value:30}];class F0{constructor(s,r){C(this,"_data");C(this,"_cutoffs");C(this,"_cutoffsVersion");C(this,"_dist");C(this,"_distVersion");C(this,"_event");C(this,"_eventVersion");C(this,"_gain");C(this,"_gainVersion");C(this,"_loss");C(this,"_lossVersion");C(this,"name");C(this,"_sites",[new Dr(this,{id:String(q.random(1e4,2e4)),name:"Start",type:"start",percent:0}),new Dr(this,{id:String(q.random(3e4,4e4)),name:"Finish",type:"finish",percent:1})]);C(this,"version",0);C(this,"_waypoints");C(this,"_track");C(this,"_points");C(this,"_terrain");C(this,"_splits");C(this,"_stats");this._track=s,this._data=r,this.version=1}get cutoffs(){return this._cutoffsVersion===this.version&&this._cutoffs?this._cutoffs:(this._cutoffs=this.waypoints.filter(s=>s.cutoff).map(s=>new Eu(s)),this._cutoffsVersion=this.version,this._cutoffs)}get dist(){return this._distVersion==this.version&&this._dist?this._dist:(this._dist=this._data.dist||this.track.dist*this.loops,this._distVersion=this.version,this._dist)}get distScale(){return this._data.dist?this._data.dist/(this.track.dist*this.loops):1}get event(){if(this._event&&this._eventVersion===this.version)return this._event;if(this._eventVersion=this.version,this._data.start)return this._event=new Ps(this._data.start.date,this._data.start.timezone,this.points[0].lat,this.points[0].lon)}get gain(){return this._gainVersion==this.version&&this._gain?this._gain:(this._gain=this._data.gain||this.track.gain*this.loops,this._gainVersion=this.version,this._gain)}get gainScale(){return this._data.gain?this._data.gain/(this.track.gain*this.loops):1}get loopDist(){return this.dist/this.loops}get loopGain(){return this.gain/this.loops}get loopLoss(){return this.loss/this.loops}get loops(){return this._data.loops||1}get loss(){return this._lossVersion==this.version&&this._loss?this._loss:(this._loss=this._data.loss||this.track.loss*this.loops,this._lossVersion=this.version,this._loss)}get lossScale(){return this._data.loss?this._data.loss/(this.track.loss*this.loops):1}get sites(){return this._sites}set sites(s){this._sites=s.map(r=>new Dr(this,r)),this.clearCache(1)}update(s){Object.assign(this._data,s),this.version++}clearCache(s=1){kr(`clearCache-${s}`),delete this._splits,delete this._stats,delete this._terrain,delete this._waypoints,s===2&&(delete this._dist,delete this._gain,delete this._loss,delete this._points,this.sites.forEach(r=>{r.clearCache()}))}get waypoints(){var r;if(this._waypoints)return this._waypoints;if(!((r=this.track)!=null&&r.dist))return[];let s=[];return this.sites.forEach(o=>{s.push(...o.waypoints)}),s=s.sort((o,f)=>o.loc-f.loc),this._waypoints=s,this._waypoints}set track(s){this._track=s,this.clearCache(2)}get track(){return this._track}get points(){if(this._points)return this._points;kr("generating points array"),this._points=new Array(this.track.points.length*this.loops);for(let s=0;s<this.loops;s++)for(let r=0;r<this.track.points.length;r++)this.points[r+s*this.track.points.length]=new _s(this,this.track.points[r],s);return this._points}set points(s){throw new Error("cannot set points directly")}getPoint(s,r=!1){const o=this.points.findIndex(M=>Ur(M.loc,s,4)),f=this.points[o];if(Be(f.loc,s,4))return f;kr(`getPoint: ${r?"inserting":"creating"} new CoursePoint at ${s}`);const p=o-1,d=this.points[p],_=Is(d.point,f.point,s%this.loopDist/this.distScale),y=new _s(this,_,Math.floor(s/this.loopDist));return r&&this.points.splice(o,0,y),y}get terrain(){return this._terrain||[]}set terrain(s){if(!s){this._terrain=[];return}s=[...s],s.sort((r,o)=>r.percent-o.percent),this._terrain=s.map((r,o)=>{var _,y;const f=q.isNumber(r.value)?r.value:q.isString(r.value)?((_=Pu.find(M=>M.type===r.value))==null?void 0:_.value)||0:r.value.value,p=typeof r=="string"?r:q.isObject(r.value)?r.value.type:void 0;return{value:f,type:p,percents:[r.percent,((y=s[o+1])==null?void 0:y.percent)||1]}})}get splits(){return this._splits?this._splits:(this._splits=new E0(this),this._splits)}get stats(){if(this._stats)return this._stats;kr("stats:calculate");const s=this.track.points.map(d=>d.alt),r=this.track.points.map(d=>d.grade),o=this.terrain.map(d=>d.value/100+1),f={altitude:{avg:q.sum(this.track.points.map((d,_)=>{var y;return d.alt*(d.loc-(((y=this.track.points[_-1])==null?void 0:y.loc)||0))}))/this.track.dist,max:q.max(s)||0,min:q.min(s)||0},grade:{avg:(this.track.points[this.track.points.length-1].alt-this.track.points[0].alt)/this.track.dist/10,max:q.max(r)||0,min:q.min(r)||0},terrain:{avg:(q.sumBy(this.terrain,d=>(d.percents[1]-d.percents[0])*this.dist*d.value)/this.dist+100)/100,max:q.max(o)||0,min:q.min(o)||0,maxDist:0,minDist:0}},p=d=>this.terrain.reduce((_,y)=>y.value/100+1===d?_+(y.percents[1]-y.percents[0])*this.dist:_,0);return Object.assign(f.terrain,{maxDist:p(f.terrain.max),minDist:p(f.terrain.min)}),this._stats=f,f}locationsToBreaks(s){const r=s.filter(f=>f>0&&Ms(f,this.dist,4));return r.unshift(0),r.map((f,p)=>({start:f,end:r[p+1]||this.dist}))}}class Eu{constructor(s){C(this,"waypoint");this.waypoint=s}get loc(){return this.waypoint.loc}get time(){if(!this.waypoint.cutoff)throw new Error("Invalid cutoff");return this.waypoint.cutoff}}var Br={};(function(h){(function(){var s={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(_){return f(d(_),arguments)}function o(_,y){return r.apply(null,[_].concat(y||[]))}function f(_,y){var M=1,S=_.length,m,T="",O,F,E,N,K,Y,X,et;for(O=0;O<S;O++)if(typeof _[O]=="string")T+=_[O];else if(typeof _[O]=="object"){if(E=_[O],E.keys)for(m=y[M],F=0;F<E.keys.length;F++){if(m==null)throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',E.keys[F],E.keys[F-1]));m=m[E.keys[F]]}else E.param_no?m=y[E.param_no]:m=y[M++];if(s.not_type.test(E.type)&&s.not_primitive.test(E.type)&&m instanceof Function&&(m=m()),s.numeric_arg.test(E.type)&&typeof m!="number"&&isNaN(m))throw new TypeError(r("[sprintf] expecting number but found %T",m));switch(s.number.test(E.type)&&(X=m>=0),E.type){case"b":m=parseInt(m,10).toString(2);break;case"c":m=String.fromCharCode(parseInt(m,10));break;case"d":case"i":m=parseInt(m,10);break;case"j":m=JSON.stringify(m,null,E.width?parseInt(E.width):0);break;case"e":m=E.precision?parseFloat(m).toExponential(E.precision):parseFloat(m).toExponential();break;case"f":m=E.precision?parseFloat(m).toFixed(E.precision):parseFloat(m);break;case"g":m=E.precision?String(Number(m.toPrecision(E.precision))):parseFloat(m);break;case"o":m=(parseInt(m,10)>>>0).toString(8);break;case"s":m=String(m),m=E.precision?m.substring(0,E.precision):m;break;case"t":m=String(!!m),m=E.precision?m.substring(0,E.precision):m;break;case"T":m=Object.prototype.toString.call(m).slice(8,-1).toLowerCase(),m=E.precision?m.substring(0,E.precision):m;break;case"u":m=parseInt(m,10)>>>0;break;case"v":m=m.valueOf(),m=E.precision?m.substring(0,E.precision):m;break;case"x":m=(parseInt(m,10)>>>0).toString(16);break;case"X":m=(parseInt(m,10)>>>0).toString(16).toUpperCase();break}s.json.test(E.type)?T+=m:(s.number.test(E.type)&&(!X||E.sign)?(et=X?"+":"-",m=m.toString().replace(s.sign,"")):et="",K=E.pad_char?E.pad_char==="0"?"0":E.pad_char.charAt(1):" ",Y=E.width-(et+m).length,N=E.width&&Y>0?K.repeat(Y):"",T+=E.align?et+m+N:K==="0"?et+N+m:N+et+m)}return T}var p=Object.create(null);function d(_){if(p[_])return p[_];for(var y=_,M,S=[],m=0;y;){if((M=s.text.exec(y))!==null)S.push(M[0]);else if((M=s.modulo.exec(y))!==null)S.push("%");else if((M=s.placeholder.exec(y))!==null){if(M[2]){m|=1;var T=[],O=M[2],F=[];if((F=s.key.exec(O))!==null)for(T.push(F[1]);(O=O.substring(F[0].length))!=="";)if((F=s.key_access.exec(O))!==null)T.push(F[1]);else if((F=s.index_access.exec(O))!==null)T.push(F[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");M[2]=T}else m|=2;if(m===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");S.push({placeholder:M[0],param_no:M[1],keys:M[2],sign:M[3],pad_char:M[4],align:M[5],width:M[6],precision:M[7],type:M[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");y=y.substring(M[0].length)}return p[_]=S}h.sprintf=r,h.vsprintf=o,typeof window<"u"&&(window.sprintf=r,window.vsprintf=o)})()})(Br);const L0=Kn("PaceChunk");class k0{constructor(){C(this,"iterations",!1);C(this,"factor",!1);C(this,"target",!1)}get passing(){return this.iterations&&this.factor&&this.target}get statusString(){return[`iterations=${this.iterations?"P":"F"}`,`factor=${this.factor?"P":"F"}`,`target=${this.target?"P":"F"}`].join("|")}}class uu{constructor(s,r,o,f){C(this,"constraints");C(this,"points");C(this,"plan");C(this,"delay");C(this,"factor");C(this,"factors",new _n);C(this,"status");this.constraints=o,this.points=r,this.plan=s,this.delay=f,this.factor=1}get elapsed(){const s=q.isFunction(this.constraints[0])?this.constraints[0]():this.constraints[0];return(q.isFunction(this.constraints[1])?this.constraints[1]():this.constraints[1])-s}get dist(){return this.points[this.points.length-1].loc-this.points[0].loc}get pace(){return(this.elapsed-this.delay)/this.dist}get np(){return this.pace/this.factor}get moving(){return this.elapsed-this.delay}applyPacing(){this.plan.pacing.clearFactor();const s=this.points;s[0].elapsed=q.isFunction(this.constraints[0])?this.constraints[0]():this.constraints[0],s[0].time=s[0].elapsed-q.sum(this.plan.pacing.chunks.filter(M=>M.points[0].loc<s[0].loc).map(M=>M.delay)),this.plan.event.start&&(s[0].tod=this.plan.event.elapsedToTimeOfDay(s[0].elapsed));let r=s[0].elapsed,o=s[0].delay||0,f=0,p=0,d=0;const _=this.factor?this.np:this.plan.pacing.pace,y=new _n().init(0);for(let M=1,S=s.length;M<S;M++){f=s[M].loc-s[M-1].loc,Wr(s[M-1],this.plan),y.applyEach((T,O)=>T+O*f,s[M-1].factors);const m=s[M-1].factors.combined;d+=m*f,p=_*m*f,s[M].time=s[M-1].time+p,o=s[M-1].delay||0,r+=p+o,s[M].elapsed=r,this.plan.event.start&&(s[M].tod=this.plan.event.elapsedToTimeOfDay(r))}Wr(s[s.length-1],this.plan),this.factors=y.scaleEach(1/this.dist),this.factor=d/this.dist}calculate(){const o=L0.extend(Br.vsprintf("calculate:%.2f-%.2f",[this.points[0].loc,this.points[this.points.length-1].loc]));let f=this.factor||0,p;const d=new k0;for(p=0;p<20&&(this.applyPacing(),d.iterations=p>=2,d.factor=!q.round(f-this.factor,10),f=this.factor,d.target=Math.abs((q.isFunction(this.constraints[1])?this.constraints[1]():this.constraints[1])-this.points[this.points.length-1].elapsed)<.1,o(Br.vsprintf("%i|%s",[p,d.statusString])),!d.passing);p++);o("iteration complete"),this.status={tests:d,success:d.passing,iterations:p+1}}}const fn=Kn("Pacing");class Tu{constructor(s){C(this,"chunks",[]);C(this,"plan");C(this,"_factor");C(this,"_factors");C(this,"version");this.plan=s}clearCache(){fn("clearCache"),delete this._factor,delete this._factors}get elapsed(){return fn("elapsed:get"),this.plan.points[this.plan.points.length-1].elapsed}get pace(){return fn("pace:get"),(this.elapsed-this.plan.delay)/this.plan.course.dist}get factor(){return this._factor?this._factor:(fn("factor:update"),this.chunks&&(this._factor=q.sum(this.chunks.map(s=>s.factor*s.dist))/this.plan.course.dist),this._factor||1)}clearFactor(){delete this._factor}get factors(){return fn("factors:get"),this._factors||(fn("factors:update"),this._factors=Cs(this.chunks)),this._factors}get isCurrent(){return this.version===this.plan.version}get np(){return fn("np:get"),this.pace/this.factor}get moving(){return this.elapsed-this.plan.delay}get status(){var s,r,o;return{complete:((s=this.chunks)==null?void 0:s.length)>0,success:((r=this.chunks)==null?void 0:r.filter(f=>{var p;return!((p=f.status)!=null&&p.success)}).length)===0,chunks:((o=this.chunks)==null?void 0:o.length)||0}}calculate(){var o,f;const s=fn.extend("calculate");s("exec"),s("clearing cache"),this.clearCache(),s("adding points at each terrain factor break"),(o=this.plan.course.terrain)==null||o.forEach(p=>this.plan.getPoint(p.percents[0]*this.plan.course.dist,!0)),s("adding points at each cutoff"),this.plan.cutoffMargin&&this.plan.cutoffs.forEach(p=>{p.point=this.plan.getPoint(p.loc,!0)}),this.plan.points.filter(p=>p.delay).forEach(p=>{p.delay=0}),(f=this.plan.delays)==null||f.forEach(p=>{const d=this.plan.getPoint(p.loc,!0);d.delay=p.delay}),s("creating pace chunks"),this.initChunks(),[null,...q.reverse([...this.plan.cutoffs]),null].forEach(p=>{for(;this.chunks.find(d=>!d.status);)this.calcChunks(),this.validateChunks();if(!p)return!0;if(p.point.elapsed-p.time>.5){s(`cutoff at ${p.loc} missed`);const d=this.chunks[0];q.last(d.points)===p.point?(s(`setting cutoff at ${p.loc}`),d.constraints=[0,p.time],delete d.status):this.splitChunk(d,p.point,p.time)}}),q.isFunction(this.chunks[this.chunks.length-1].constraints[1])&&this.chunks.length>2&&(s("rerunning last chunk"),this.chunks[this.chunks.length-1].calculate()),fn(`pacing status=${this.status.success?"PASS":"FAIL"}.`),this.version=this.plan.version}initChunks(){let s;switch(this.plan.method){case"time":s=this.plan.target;break;case"pace":s=this.plan.target*this.plan.course.dist+this.plan.delay;break;case"np":s=()=>this.plan.target*(this.factor||1)*this.plan.course.dist+this.plan.delay;break;default:throw new Error(`Incorrect pacing method ${this.plan.method}`)}this.chunks=[new uu(this.plan,this.plan.points,[0,s],this.plan.delay)],this.plan.points.forEach(r=>{r._chunk=this.chunks[0]})}calcChunks(){fn("calcChunks"),this.clearCache(),this.chunks.filter(s=>!s.status).forEach(s=>s.calculate())}validateChunks(){let s=1;for(;s<=this.chunks.length-1;)this.chunks[s].np<this.chunks[s-1].np?this.mergeChunks(this.chunks[s-1],this.chunks[s]):s++}splitChunk(s,r,o){fn.extend("split")(`breaking chunks at ${r.loc} km`);const p=s.points.findIndex(y=>y===r),d=q.round(r.elapsed-r.time),_=new uu(this.plan,s.points.slice(0,p+1),[0,o],d);_.points.filter((y,M)=>M<_.points.length-1).forEach(y=>{y._chunk=_}),this.chunks.unshift(_),s.constraints[0]=o,s.delay-=d,s.points=s.points.slice(p),delete s.status}mergeChunks(s,r){const o=this.chunks.findIndex(p=>p===s),f=this.chunks.findIndex(p=>p===r);if(f-o!==1)throw new Error("chunks must be sequential");fn(Br.sprintf("calcChunks: merging %i&%i (%.2f&%.2f)",o,f,s.np,r.np)),s.points.pop(),s.points.push(...r.points),s.delay+=r.delay,delete s.status,s.points.forEach(p=>{p._chunk=s}),s.constraints=[s.constraints[0],r.constraints[1]],this.chunks.splice(f,1)}}class ys{constructor(s,r){C(this,"factors",new _n);C(this,"_chunk");C(this,"_plan");C(this,"_point");C(this,"elapsed");C(this,"time");C(this,"tod");C(this,"delay");this._plan=s,this._point=r,this.time=0,this.elapsed=0,this.tod=0,this.delay=0}get lat(){return this._point.lat}get lon(){return this._point.lon}get alt(){return this._point.alt}get latlon(){return this._point.latlon}get grade(){return this._point.grade}get loc(){return this._point.loc}get np(){var s;if(!this._chunk)throw new Error("PlanPoint._chunk not defined");return(s=this._chunk)==null?void 0:s.np}get factor(){var s;return(s=this.factors)==null?void 0:s.combined}get pace(){return this.np*this.factor}}const gs=Kn("PlanSplits");class O0{constructor(s){C(this,"plan");C(this,"_segments");C(this,"_segmentsVersion");C(this,"_miles");C(this,"_milesVersion");C(this,"_kilometers");C(this,"_kilometersVersion");this.plan=s}get segments(){return this._segments&&this._segmentsVersion===this.plan.version?this._segments:(this._segments=this.createSegments(),this._segmentsVersion=this.plan.version,this._segments)}set segments(s){this._segments=s}get miles(){return this._miles&&this._milesVersion===this.plan.version?this._miles:(this._miles=this.createSplits("miles"),this._milesVersion=this.plan.version,this._miles)}set miles(s){this._miles=s}get kilometers(){return this._kilometers&&this._kilometersVersion===this.plan.version?this._kilometers:(this._kilometers=this.createSplits("kilometers"),this._kilometersVersion=this.plan.version,this._kilometers)}set kilometers(s){this._kilometers=s}createSegments(){gs("createSegments");const s=this.plan.course.waypoints.filter(o=>o.tier<3).sort((o,f)=>o.loc-f.loc),r=this.calcSegments(this.plan.course.locationsToBreaks(s.map(o=>o.loc)));if(!r.length)throw new Error("createSegments result is empty");return r.forEach((o,f)=>{o.waypoint=s[f+1]}),r}createSplits(s){gs(`createSplits:${s}`);const r=Cu(s),o=q.range(this.plan.course.dist*r).map(p=>p/r);this.plan.course.dist-o[o.length-1]>1e-4&&o.push(this.plan.course.dist);const f=this.calcSegments(this.plan.course.locationsToBreaks(o));if(!f.length)throw new Error("createSplits result is empty");return f}calcSegments(s){var O;gs.extend("calcSegments")("exec"),this.plan.checkPacing();const o=this.plan,f=o.course,p=o.points,d=[],_=[];let y,M,S=o.points[0],m;for(y=0,M=s.length;y<M;y++){const F=s[y];m&&Be((O=s[y-1])==null?void 0:O.end,F.start,4)?S=m:S=o.getPoint(F.start),m=o.getPoint(F.end);const E=F.end-F.start,N=new xu(this.plan,{gain:0,loss:0,grade:E>0?(m.alt-S.alt)/E/10*(m.alt-S.alt>0?f.gainScale:f.lossScale):0,point1:S,point2:m}),K=new _n().init(0);d.push(N),_.push(K)}const T=(F,E,N,K)=>{const Y=N.alt-E.alt;F[Y>0?"gain":"loss"]+=Y*(Y>0?f.gainScale:f.lossScale),Wr(E,o);const X=N.loc-E.loc;K.applyEach((et,bt)=>et+bt*X,E.factors)};y=1;for(let F=0;F<d.length;F++){const E=d[F],N=_[F];for(;me(p[y].loc,E.point1.loc,4);)y++;let K=E.point1;for(;y<p.length&&me(p[y].loc,E.point2.loc,4);){const Y=p[y];T(E,K,Y,N),K=Y,y++}T(E,K,E.point2,N),o&&(E.delay=o.delays.filter(Y=>Ur(E.point1.loc,Y.loc,4)&&Ms(E.point2.loc,Y.loc,4)).reduce((Y,X)=>Y+X.delay,0))}return d}}const Hn=Kn("models:Plan");class D0{constructor(s,r){C(this,"_data");C(this,"course");C(this,"_cutoffs");C(this,"_cutoffsVersion");C(this,"_delays");C(this,"_delaysVersion");C(this,"_event");C(this,"_eventVersion");C(this,"_events");C(this,"_eventsVersion");C(this,"_heatModel");C(this,"_heatModelVersion");C(this,"pacing",new Tu(this));C(this,"points");C(this,"_scales");C(this,"_scalesVersion");C(this,"splits",new O0(this));C(this,"_stats");C(this,"_statsVersion");C(this,"_strategy");C(this,"_strategyVersion");C(this,"_version",0);this.course=s,this._data=r,this.points=this.course.points.map(o=>new ys(this,o)),this._version=1}get cutoffMargin(){return this._data.cutoffMargin}get cutoffs(){if(this._cutoffs&&this._cutoffsVersion===this.version)return this._cutoffs;this._cutoffs=this.cutoffMargin?this.course.cutoffs.map(r=>new W0(this,r,this.getPoint(r.loc,!0))):[];let s=0;for(;this._cutoffs.length-1>=s;){const r=this._cutoffs[s];this._cutoffs.find((o,f)=>f>s&&o.time<=r.time)?(Hn(`get cutoffs: deleting extraneous cutoff at ${r.loc} km`),this._cutoffs.splice(s,1)):s++}return this._cutoffsVersion=this.version,this._cutoffs}get delay(){return q.sumBy(this.delays,"delay")}get delays(){if(this._delays&&this._delaysVersion===this.version)return this._delays;const s=this.course.waypoints.map(o=>{var d;const f=(d=this._data.delays)==null?void 0:d.find(_=>ms(_.waypoint,o)),p=f?f.delay:o.hasTypicalDelay?this.typicalDelay:0;return new N0(o,p)}).filter(o=>o.delay>0).sort((o,f)=>o.loc-f.loc);let r=0;for(;s.length-1>=r;)r>0&&s[r].loc===s[r-1].loc?(Hn(`get delays: merging delay at ${s[r].loc} km`),s[r-1].delay+=s[r].delay,s.splice(r,1)):r++;return this._delays=s,this._delaysVersion=this.version,this._delays}get event(){if(this._event&&this._eventVersion===this.version)return this._event;if(this._eventVersion=this.version,this._data.start)return this._event=new Ps(this._data.start.date,this._data.start.timezone,this.points[0].lat,this.points[0].lon);if(this.course.event)return this._event=this.course.event;throw new Error("Start date/timezone is required for either the plan or the course")}get events(){if(this._events&&this._eventsVersion===this.version)return this._events;Hn("calculating events.sun");const s=[],r=this.event.elapsedToTimeOfDay(0),o=Math.ceil((r+this.points[this.points.length-1].elapsed)/86400);for(let d=0;d<o;d++)[{event:"dawn",time:this.event.sun.dawn},{event:"sunrise",time:this.event.sun.sunrise},{event:"sunset",time:this.event.sun.sunset},{event:"dusk",time:this.event.sun.dusk}].forEach(y=>{const M=y.time-r+86400*d;M>=0&&M<=this.points[this.points.length-1].elapsed&&s.push({event:y.event,elapsed:M})});s.sort((d,_)=>d.elapsed-_.elapsed);const f=hu(this.points.map(d=>d.elapsed),this.points.map(d=>d.loc),s.map(d=>d.elapsed)),p=s.map((d,_)=>({...d,loc:f[_]}));return this._events={sun:p},this._eventsVersion=this.version,this._events}get heatModel(){return this._heatModelVersion===this.version?this._heatModel:(this._heatModelVersion=this.version,this._data.heatModel?this._heatModel={start:this.event.sun.sunrise+1800,stop:this.event.sun.sunset+7200,baseline:this._data.heatModel.baseline,max:this._data.heatModel.max}:this._heatModel=void 0)}get id(){return this._data.id}get method(){return this._data.method}get name(){return this._data.name}get scales(){var s,r;return this._scales&&this._scalesVersion===this._version?this._scales:(this._scales={altitude:((s=this._data.scales)==null?void 0:s.altitude)||1,dark:((r=this._data.scales)==null?void 0:r.dark)||1},this._scalesVersion=this._version,this._scales)}get stats(){if(this._stats&&this._statsVersion===this.version)return this._stats;Hn("calculating stats.factors");const s=q.fromPairs(yu.map(p=>{const d=this.points.map(_=>_.factors.get(p));return[p,{min:Number(q.min(d)),max:Number(q.max(d))}]}));Hn("calculating stats.sun");const r={day:{time:0,dist:0},twilight:{time:0,dist:0},dark:{time:0,dist:0}};let o=0,f=0;return this.points.forEach((p,d)=>{var _,y;o=p.loc-(((_=this.points[d-1])==null?void 0:_.loc)||0),f=p.elapsed-(((y=this.points[d-1])==null?void 0:y.elapsed)||0),!isNaN(this.event.sun.dawn)&&!isNaN(this.event.sun.dusk)&&(p.tod<=this.event.sun.dawn||p.tod>=this.event.sun.dusk)?(r.dark.time+=f,r.dark.dist+=o):p.tod<this.event.sun.sunrise||p.tod>this.event.sun.sunset?(r.twilight.time+=f,r.twilight.dist+=o):(r.day.time+=f,r.day.dist+=o)}),this._stats={factors:s,sun:r},this._statsVersion=this.version,this._stats}get strategy(){return this._strategy&&this._strategyVersion===this.version?this._strategy:(this._strategyVersion=this.version,this._strategy=new Ss(this,this._data.strategy))}get target(){return this._data.target}get typicalDelay(){return this._data.typicalDelay??180}get version(){return this._version+this.course.version}checkPacing(){var s,r;if(Hn("checkPacing"),(!((s=this.pacing.status)!=null&&s.complete)||!this.pacing.isCurrent)&&(Hn("checkPacing: calculate"),this.pacing.calculate()),!((r=this.points)!=null&&r.length))throw new Error("No plan points");return!0}getDelayAtWaypoint(s){var r;return((r=this.delays.find(o=>ms(o.waypoint,s)))==null?void 0:r.delay)||0}getTypicalDelayAtWaypoint(s){return s.hasTypicalDelay?this.typicalDelay:0}getPoint(s,r=!1){const o=this.points.findIndex(y=>Ur(y.loc,s,4)),f=this.points[o];if(Be(f.loc,s,4))return f;Hn(`getPoint: ${r?"inserting":"creating"} new PlanPoint at ${s}`);const p=o-1,d=this.points[p],_=new ys(this,this.course.getPoint(s,r));if(!isNaN(d.time)&&!isNaN(f.time)){const y=f.elapsed-f.time-(d.elapsed-d.time);_.time=ve(d.loc,f.loc,d.time+y,f.time,f.loc),_.elapsed=f.elapsed-(f.time-_.time),this.event.start&&(_.tod=this.event.elapsedToTimeOfDay(_.elapsed))}return r&&this.points.splice(o,0,_),_}update(s){const o=["target","method"].find(f=>f in s&&q.isNil(s[f]));if(o)throw new Error(`Plan.${o} cannot be set to null or undefined`);Object.assign(this._data,s),this._version++}}class N0{constructor(s,r){C(this,"delay");C(this,"waypoint");this.waypoint=s,this.delay=r}get loc(){return this.waypoint.loc}}class W0{constructor(s,r,o){C(this,"plan");C(this,"courseCutoff");C(this,"point");this.plan=s,this.courseCutoff=r,this.point=o}get waypoint(){return this.courseCutoff.waypoint}get loc(){return this.courseCutoff.loc}get time(){return this.courseCutoff.time-Math.max(this.plan.cutoffMargin||0,this.plan.getDelayAtWaypoint(this.waypoint))}}const Ru=(h,s,r,o)=>{const f=pu(h,s,r,o),p=[];return r.forEach((d,_)=>{let y=f[_][0]/10;y>50?y=50:y<-50&&(y=-50);const M=d*f[_][0]+f[_][1];p.push({grade:y,alt:M})}),p};function B0(h,s){return Ru(s,h.map(o=>o.alt),s,.05).map(o=>o.grade)}const U0=h=>{let s=0,r=0;const o=[0];for(let f=1,p=h.length;f<p;f++)s=Number(h[f-1].latlon.distanceTo(h[f].latlon)),r+=s,o.push(r);return o},Or=Kn("models:Track");class $r{constructor(s){C(this,"dist");C(this,"gain");C(this,"loss");C(this,"points");Or("Creating new Track object");const r=s.map(M=>new xs(M.lat,M.lon,M.alt)),o=U0(r),f=B0(r,o);this.points=r.map((M,S)=>new As(M.lat,M.lon,M.alt,o[S],f[S])),Or(`set-points - ${r.length} points`),Or("Calculating"),this.dist=this.points[this.points.length-1].loc;let p=0,d=0,_=0,y=this.points[0].alt;this.points.forEach(M=>{_=M.alt-y,_<0?d+=_:p+=_,y=M.alt}),this.gain=p,this.loss=d}get start(){return q.pick(this.points[0],["lat","lon"])}get finish(){return q.pick(this.points[this.points.length-1],["lat","lon"])}getLLA(s){s>this.dist&&(s=s%this.dist);let r;if(s===0)r=this.points[0];else{const o=this.points.findIndex(f=>f.loc>=s);r=Is(this.points[o-1],this.points[o],s)}return q.pick(r,["lat","lon","alt"])}getNearestPoint(s,r,o){let p=this.points.findIndex(y=>y===r),d=this.points[p],_=0;for(;o>.025;){const y=o/5,M=[d];for(let T=1;T<=5;T++){const O=d.loc+y*T;if(O<=this.dist){for(;this.points[p+1].loc<O&&p<this.points.length-1;)p++;M.push(this.points[p])}}const S=M.map(T=>Number(s.distanceTo(T.latlon)));_=Math.min(...S);const m=S.findIndex(T=>T===_);d=M[m],o=o/5}return{point:d,delta:_}}reduceDensity(s=.025,r=this.points.length/2){const o=Or.extend("reduceDensity");if(this.dist/s>r/2)return o("Does not meet criteria"),this;const f=this.dist,p=Math.floor(f/s)+1,d=Array(p).fill(0).map((S,m)=>Nt(m++*s,3));d[d.length-1]<f&&d.push(f);const _=Ru(this.points.map(S=>S.loc),this.points.map(S=>S.alt),d,2*s),y=d.map(S=>this.getLLA(S)).map((S,m)=>({lat:Nt(S.lat,6),lon:Nt(S.lon,6),alt:Nt(_[m].alt,2)})),M=new $r(y);return o(`Reduced from ${this.points.length} to ${M.points.length} points.`),M}}function $0(h,s,r){const o=h.map((f,p)=>({lat:h[p],lon:s[p],alt:r[p]}));return new $r(o)}const G0=Object.freeze(Object.defineProperty({__proto__:null,dateToTODSeconds:qn},Symbol.toStringTag,{value:"Module"}));exports.Course=F0;exports.CourseCutoff=Eu;exports.CoursePoint=_s;exports.CourseSegment=bu;exports.Event=Ps;exports.Factors=_n;exports.Pacing=Tu;exports.Plan=D0;exports.PlanPoint=ys;exports.PlanSegment=xu;exports.Point=xs;exports.Site=Dr;exports.Strategy=Ss;exports.Track=$r;exports.TrackPoint=As;exports.Waypoint=ws;exports.adjustStrategy=Mu;exports.createTrackFromArrays=$0;exports.factors=I0;exports.interpolatePoint=Is;exports.math=C0;exports.scaleDark=du;exports.terrainTypes=Pu;exports.util=G0;
