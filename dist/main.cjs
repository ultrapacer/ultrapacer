"use strict";var C0=Object.defineProperty;var b0=(c,i,r)=>i in c?C0(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r;var M=(c,i,r)=>b0(c,typeof i!="symbol"?i+"":i,r);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var kr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yu(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Be={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var S0=Be.exports,lu;function x0(){return lu||(lu=1,function(c,i){(function(){var r,a="4.17.21",f=200,p="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",m="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",C=500,I="__lodash_placeholder__",v=1,F=2,R=4,E=1,T=2,N=1,q=2,Z=4,J=8,it=16,_t=32,Wt=64,bt=128,tn=256,Ht=512,Et=30,we="...",$e=800,Gr=16,Me=1,qe=2,Hr=3,Sn=1/0,mn=9007199254740991,ze=17976931348623157e292,xn=NaN,L=4294967295,$=L-1,G=L>>>1,ct=[["ary",bt],["bind",N],["bindKey",q],["curry",J],["curryRight",it],["flip",Ht],["partial",_t],["partialRight",Wt],["rearg",tn]],nt="[object Arguments]",ht="[object Array]",ot="[object AsyncFunction]",lt="[object Boolean]",Mt="[object Date]",Kt="[object DOMException]",Rt="[object Error]",Bt="[object Function]",yn="[object GeneratorFunction]",vt="[object Map]",kt="[object Number]",Dn="[object Null]",Ct="[object Object]",Ut="[object Promise]",cn="[object Proxy]",nn="[object RegExp]",pt="[object Set]",wn="[object String]",Ge="[object Symbol]",Uu="[object Undefined]",Ce="[object WeakMap]",$u="[object WeakSet]",be="[object ArrayBuffer]",re="[object DataView]",Kr="[object Float32Array]",Zr="[object Float64Array]",Jr="[object Int8Array]",Yr="[object Int16Array]",Xr="[object Int32Array]",Qr="[object Uint8Array]",Vr="[object Uint8ClampedArray]",jr="[object Uint16Array]",ti="[object Uint32Array]",qu=/\b__p \+= '';/g,zu=/\b(__p \+=) '' \+/g,Gu=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ks=/&(?:amp|lt|gt|quot|#39);/g,Ls=/[&<>"']/g,Hu=RegExp(ks.source),Ku=RegExp(Ls.source),Zu=/<%-([\s\S]+?)%>/g,Ju=/<%([\s\S]+?)%>/g,Os=/<%=([\s\S]+?)%>/g,Yu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Xu=/^\w*$/,Qu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ni=/[\\^$.*+?()[\]{}|]/g,Vu=RegExp(ni.source),ei=/^\s+/,ju=/\s/,tl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,nl=/\{\n\/\* \[wrapped with (.+)\] \*/,el=/,? & /,rl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,il=/[()=,{}\[\]\/\s]/,sl=/\\(\\)?/g,al=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ds=/\w*$/,ol=/^[-+]0x[0-9a-f]+$/i,ul=/^0b[01]+$/i,ll=/^\[object .+?Constructor\]$/,fl=/^0o[0-7]+$/i,cl=/^(?:0|[1-9]\d*)$/,hl=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,He=/($^)/,pl=/['\n\r\u2028\u2029\\]/g,Ke="\\ud800-\\udfff",gl="\\u0300-\\u036f",dl="\\ufe20-\\ufe2f",_l="\\u20d0-\\u20ff",Ns=gl+dl+_l,Ws="\\u2700-\\u27bf",Bs="a-z\\xdf-\\xf6\\xf8-\\xff",vl="\\xac\\xb1\\xd7\\xf7",ml="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",yl="\\u2000-\\u206f",wl=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Us="A-Z\\xc0-\\xd6\\xd8-\\xde",$s="\\ufe0e\\ufe0f",qs=vl+ml+yl+wl,ri="['’]",Ml="["+Ke+"]",zs="["+qs+"]",Ze="["+Ns+"]",Gs="\\d+",Cl="["+Ws+"]",Hs="["+Bs+"]",Ks="[^"+Ke+qs+Gs+Ws+Bs+Us+"]",ii="\\ud83c[\\udffb-\\udfff]",bl="(?:"+Ze+"|"+ii+")",Zs="[^"+Ke+"]",si="(?:\\ud83c[\\udde6-\\uddff]){2}",ai="[\\ud800-\\udbff][\\udc00-\\udfff]",ie="["+Us+"]",Js="\\u200d",Ys="(?:"+Hs+"|"+Ks+")",Sl="(?:"+ie+"|"+Ks+")",Xs="(?:"+ri+"(?:d|ll|m|re|s|t|ve))?",Qs="(?:"+ri+"(?:D|LL|M|RE|S|T|VE))?",Vs=bl+"?",js="["+$s+"]?",xl="(?:"+Js+"(?:"+[Zs,si,ai].join("|")+")"+js+Vs+")*",Al="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Il="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ta=js+Vs+xl,Pl="(?:"+[Cl,si,ai].join("|")+")"+ta,Tl="(?:"+[Zs+Ze+"?",Ze,si,ai,Ml].join("|")+")",Fl=RegExp(ri,"g"),El=RegExp(Ze,"g"),oi=RegExp(ii+"(?="+ii+")|"+Tl+ta,"g"),Rl=RegExp([ie+"?"+Hs+"+"+Xs+"(?="+[zs,ie,"$"].join("|")+")",Sl+"+"+Qs+"(?="+[zs,ie+Ys,"$"].join("|")+")",ie+"?"+Ys+"+"+Xs,ie+"+"+Qs,Il,Al,Gs,Pl].join("|"),"g"),kl=RegExp("["+Js+Ke+Ns+$s+"]"),Ll=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ol=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Dl=-1,ft={};ft[Kr]=ft[Zr]=ft[Jr]=ft[Yr]=ft[Xr]=ft[Qr]=ft[Vr]=ft[jr]=ft[ti]=!0,ft[nt]=ft[ht]=ft[be]=ft[lt]=ft[re]=ft[Mt]=ft[Rt]=ft[Bt]=ft[vt]=ft[kt]=ft[Ct]=ft[nn]=ft[pt]=ft[wn]=ft[Ce]=!1;var ut={};ut[nt]=ut[ht]=ut[be]=ut[re]=ut[lt]=ut[Mt]=ut[Kr]=ut[Zr]=ut[Jr]=ut[Yr]=ut[Xr]=ut[vt]=ut[kt]=ut[Ct]=ut[nn]=ut[pt]=ut[wn]=ut[Ge]=ut[Qr]=ut[Vr]=ut[jr]=ut[ti]=!0,ut[Rt]=ut[Bt]=ut[Ce]=!1;var Nl={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Wl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Bl={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ul={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$l=parseFloat,ql=parseInt,na=typeof kr=="object"&&kr&&kr.Object===Object&&kr,zl=typeof self=="object"&&self&&self.Object===Object&&self,It=na||zl||Function("return this")(),ui=i&&!i.nodeType&&i,Jn=ui&&!0&&c&&!c.nodeType&&c,ea=Jn&&Jn.exports===ui,li=ea&&na.process,en=function(){try{var _=Jn&&Jn.require&&Jn.require("util").types;return _||li&&li.binding&&li.binding("util")}catch{}}(),ra=en&&en.isArrayBuffer,ia=en&&en.isDate,sa=en&&en.isMap,aa=en&&en.isRegExp,oa=en&&en.isSet,ua=en&&en.isTypedArray;function Zt(_,S,b){switch(b.length){case 0:return _.call(S);case 1:return _.call(S,b[0]);case 2:return _.call(S,b[0],b[1]);case 3:return _.call(S,b[0],b[1],b[2])}return _.apply(S,b)}function Gl(_,S,b,O){for(var H=-1,et=_==null?0:_.length;++H<et;){var St=_[H];S(O,St,b(St),_)}return O}function rn(_,S){for(var b=-1,O=_==null?0:_.length;++b<O&&S(_[b],b,_)!==!1;);return _}function Hl(_,S){for(var b=_==null?0:_.length;b--&&S(_[b],b,_)!==!1;);return _}function la(_,S){for(var b=-1,O=_==null?0:_.length;++b<O;)if(!S(_[b],b,_))return!1;return!0}function Nn(_,S){for(var b=-1,O=_==null?0:_.length,H=0,et=[];++b<O;){var St=_[b];S(St,b,_)&&(et[H++]=St)}return et}function Je(_,S){var b=_==null?0:_.length;return!!b&&se(_,S,0)>-1}function fi(_,S,b){for(var O=-1,H=_==null?0:_.length;++O<H;)if(b(S,_[O]))return!0;return!1}function gt(_,S){for(var b=-1,O=_==null?0:_.length,H=Array(O);++b<O;)H[b]=S(_[b],b,_);return H}function Wn(_,S){for(var b=-1,O=S.length,H=_.length;++b<O;)_[H+b]=S[b];return _}function ci(_,S,b,O){var H=-1,et=_==null?0:_.length;for(O&&et&&(b=_[++H]);++H<et;)b=S(b,_[H],H,_);return b}function Kl(_,S,b,O){var H=_==null?0:_.length;for(O&&H&&(b=_[--H]);H--;)b=S(b,_[H],H,_);return b}function hi(_,S){for(var b=-1,O=_==null?0:_.length;++b<O;)if(S(_[b],b,_))return!0;return!1}var Zl=pi("length");function Jl(_){return _.split("")}function Yl(_){return _.match(rl)||[]}function fa(_,S,b){var O;return b(_,function(H,et,St){if(S(H,et,St))return O=et,!1}),O}function Ye(_,S,b,O){for(var H=_.length,et=b+(O?1:-1);O?et--:++et<H;)if(S(_[et],et,_))return et;return-1}function se(_,S,b){return S===S?uf(_,S,b):Ye(_,ca,b)}function Xl(_,S,b,O){for(var H=b-1,et=_.length;++H<et;)if(O(_[H],S))return H;return-1}function ca(_){return _!==_}function ha(_,S){var b=_==null?0:_.length;return b?di(_,S)/b:xn}function pi(_){return function(S){return S==null?r:S[_]}}function gi(_){return function(S){return _==null?r:_[S]}}function pa(_,S,b,O,H){return H(_,function(et,St,at){b=O?(O=!1,et):S(b,et,St,at)}),b}function Ql(_,S){var b=_.length;for(_.sort(S);b--;)_[b]=_[b].value;return _}function di(_,S){for(var b,O=-1,H=_.length;++O<H;){var et=S(_[O]);et!==r&&(b=b===r?et:b+et)}return b}function _i(_,S){for(var b=-1,O=Array(_);++b<_;)O[b]=S(b);return O}function Vl(_,S){return gt(S,function(b){return[b,_[b]]})}function ga(_){return _&&_.slice(0,ma(_)+1).replace(ei,"")}function Jt(_){return function(S){return _(S)}}function vi(_,S){return gt(S,function(b){return _[b]})}function Se(_,S){return _.has(S)}function da(_,S){for(var b=-1,O=_.length;++b<O&&se(S,_[b],0)>-1;);return b}function _a(_,S){for(var b=_.length;b--&&se(S,_[b],0)>-1;);return b}function jl(_,S){for(var b=_.length,O=0;b--;)_[b]===S&&++O;return O}var tf=gi(Nl),nf=gi(Wl);function ef(_){return"\\"+Ul[_]}function rf(_,S){return _==null?r:_[S]}function ae(_){return kl.test(_)}function sf(_){return Ll.test(_)}function af(_){for(var S,b=[];!(S=_.next()).done;)b.push(S.value);return b}function mi(_){var S=-1,b=Array(_.size);return _.forEach(function(O,H){b[++S]=[H,O]}),b}function va(_,S){return function(b){return _(S(b))}}function Bn(_,S){for(var b=-1,O=_.length,H=0,et=[];++b<O;){var St=_[b];(St===S||St===I)&&(_[b]=I,et[H++]=b)}return et}function Xe(_){var S=-1,b=Array(_.size);return _.forEach(function(O){b[++S]=O}),b}function of(_){var S=-1,b=Array(_.size);return _.forEach(function(O){b[++S]=[O,O]}),b}function uf(_,S,b){for(var O=b-1,H=_.length;++O<H;)if(_[O]===S)return O;return-1}function lf(_,S,b){for(var O=b+1;O--;)if(_[O]===S)return O;return O}function oe(_){return ae(_)?cf(_):Zl(_)}function hn(_){return ae(_)?hf(_):Jl(_)}function ma(_){for(var S=_.length;S--&&ju.test(_.charAt(S)););return S}var ff=gi(Bl);function cf(_){for(var S=oi.lastIndex=0;oi.test(_);)++S;return S}function hf(_){return _.match(oi)||[]}function pf(_){return _.match(Rl)||[]}var gf=function _(S){S=S==null?It:ue.defaults(It.Object(),S,ue.pick(It,Ol));var b=S.Array,O=S.Date,H=S.Error,et=S.Function,St=S.Math,at=S.Object,yi=S.RegExp,df=S.String,sn=S.TypeError,Qe=b.prototype,_f=et.prototype,le=at.prototype,Ve=S["__core-js_shared__"],je=_f.toString,st=le.hasOwnProperty,vf=0,ya=function(){var t=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),tr=le.toString,mf=je.call(at),yf=It._,wf=yi("^"+je.call(st).replace(ni,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nr=ea?S.Buffer:r,Un=S.Symbol,er=S.Uint8Array,wa=nr?nr.allocUnsafe:r,rr=va(at.getPrototypeOf,at),Ma=at.create,Ca=le.propertyIsEnumerable,ir=Qe.splice,ba=Un?Un.isConcatSpreadable:r,xe=Un?Un.iterator:r,Yn=Un?Un.toStringTag:r,sr=function(){try{var t=te(at,"defineProperty");return t({},"",{}),t}catch{}}(),Mf=S.clearTimeout!==It.clearTimeout&&S.clearTimeout,Cf=O&&O.now!==It.Date.now&&O.now,bf=S.setTimeout!==It.setTimeout&&S.setTimeout,ar=St.ceil,or=St.floor,wi=at.getOwnPropertySymbols,Sf=nr?nr.isBuffer:r,Sa=S.isFinite,xf=Qe.join,Af=va(at.keys,at),xt=St.max,Tt=St.min,If=O.now,Pf=S.parseInt,xa=St.random,Tf=Qe.reverse,Mi=te(S,"DataView"),Ae=te(S,"Map"),Ci=te(S,"Promise"),fe=te(S,"Set"),Ie=te(S,"WeakMap"),Pe=te(at,"create"),ur=Ie&&new Ie,ce={},Ff=ne(Mi),Ef=ne(Ae),Rf=ne(Ci),kf=ne(fe),Lf=ne(Ie),lr=Un?Un.prototype:r,Te=lr?lr.valueOf:r,Aa=lr?lr.toString:r;function u(t){if(mt(t)&&!K(t)&&!(t instanceof j)){if(t instanceof an)return t;if(st.call(t,"__wrapped__"))return Po(t)}return new an(t)}var he=function(){function t(){}return function(n){if(!dt(n))return{};if(Ma)return Ma(n);t.prototype=n;var e=new t;return t.prototype=r,e}}();function fr(){}function an(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}u.templateSettings={escape:Zu,evaluate:Ju,interpolate:Os,variable:"",imports:{_:u}},u.prototype=fr.prototype,u.prototype.constructor=u,an.prototype=he(fr.prototype),an.prototype.constructor=an;function j(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=L,this.__views__=[]}function Of(){var t=new j(this.__wrapped__);return t.__actions__=$t(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=$t(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=$t(this.__views__),t}function Df(){if(this.__filtered__){var t=new j(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Nf(){var t=this.__wrapped__.value(),n=this.__dir__,e=K(t),s=n<0,o=e?t.length:0,l=Yc(0,o,this.__views__),h=l.start,g=l.end,y=g-h,x=s?g:h-1,A=this.__iteratees__,P=A.length,k=0,D=Tt(y,this.__takeCount__);if(!e||!s&&o==y&&D==y)return Xa(t,this.__actions__);var B=[];t:for(;y--&&k<D;){x+=n;for(var X=-1,U=t[x];++X<P;){var V=A[X],tt=V.iteratee,Qt=V.type,Dt=tt(U);if(Qt==qe)U=Dt;else if(!Dt){if(Qt==Me)continue t;break t}}B[k++]=U}return B}j.prototype=he(fr.prototype),j.prototype.constructor=j;function Xn(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var s=t[n];this.set(s[0],s[1])}}function Wf(){this.__data__=Pe?Pe(null):{},this.size=0}function Bf(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function Uf(t){var n=this.__data__;if(Pe){var e=n[t];return e===w?r:e}return st.call(n,t)?n[t]:r}function $f(t){var n=this.__data__;return Pe?n[t]!==r:st.call(n,t)}function qf(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=Pe&&n===r?w:n,this}Xn.prototype.clear=Wf,Xn.prototype.delete=Bf,Xn.prototype.get=Uf,Xn.prototype.has=$f,Xn.prototype.set=qf;function An(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var s=t[n];this.set(s[0],s[1])}}function zf(){this.__data__=[],this.size=0}function Gf(t){var n=this.__data__,e=cr(n,t);if(e<0)return!1;var s=n.length-1;return e==s?n.pop():ir.call(n,e,1),--this.size,!0}function Hf(t){var n=this.__data__,e=cr(n,t);return e<0?r:n[e][1]}function Kf(t){return cr(this.__data__,t)>-1}function Zf(t,n){var e=this.__data__,s=cr(e,t);return s<0?(++this.size,e.push([t,n])):e[s][1]=n,this}An.prototype.clear=zf,An.prototype.delete=Gf,An.prototype.get=Hf,An.prototype.has=Kf,An.prototype.set=Zf;function In(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var s=t[n];this.set(s[0],s[1])}}function Jf(){this.size=0,this.__data__={hash:new Xn,map:new(Ae||An),string:new Xn}}function Yf(t){var n=br(this,t).delete(t);return this.size-=n?1:0,n}function Xf(t){return br(this,t).get(t)}function Qf(t){return br(this,t).has(t)}function Vf(t,n){var e=br(this,t),s=e.size;return e.set(t,n),this.size+=e.size==s?0:1,this}In.prototype.clear=Jf,In.prototype.delete=Yf,In.prototype.get=Xf,In.prototype.has=Qf,In.prototype.set=Vf;function Qn(t){var n=-1,e=t==null?0:t.length;for(this.__data__=new In;++n<e;)this.add(t[n])}function jf(t){return this.__data__.set(t,w),this}function tc(t){return this.__data__.has(t)}Qn.prototype.add=Qn.prototype.push=jf,Qn.prototype.has=tc;function pn(t){var n=this.__data__=new An(t);this.size=n.size}function nc(){this.__data__=new An,this.size=0}function ec(t){var n=this.__data__,e=n.delete(t);return this.size=n.size,e}function rc(t){return this.__data__.get(t)}function ic(t){return this.__data__.has(t)}function sc(t,n){var e=this.__data__;if(e instanceof An){var s=e.__data__;if(!Ae||s.length<f-1)return s.push([t,n]),this.size=++e.size,this;e=this.__data__=new In(s)}return e.set(t,n),this.size=e.size,this}pn.prototype.clear=nc,pn.prototype.delete=ec,pn.prototype.get=rc,pn.prototype.has=ic,pn.prototype.set=sc;function Ia(t,n){var e=K(t),s=!e&&ee(t),o=!e&&!s&&Hn(t),l=!e&&!s&&!o&&_e(t),h=e||s||o||l,g=h?_i(t.length,df):[],y=g.length;for(var x in t)(n||st.call(t,x))&&!(h&&(x=="length"||o&&(x=="offset"||x=="parent")||l&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||En(x,y)))&&g.push(x);return g}function Pa(t){var n=t.length;return n?t[ki(0,n-1)]:r}function ac(t,n){return Sr($t(t),Vn(n,0,t.length))}function oc(t){return Sr($t(t))}function bi(t,n,e){(e!==r&&!gn(t[n],e)||e===r&&!(n in t))&&Pn(t,n,e)}function Fe(t,n,e){var s=t[n];(!(st.call(t,n)&&gn(s,e))||e===r&&!(n in t))&&Pn(t,n,e)}function cr(t,n){for(var e=t.length;e--;)if(gn(t[e][0],n))return e;return-1}function uc(t,n,e,s){return $n(t,function(o,l,h){n(s,o,e(o),h)}),s}function Ta(t,n){return t&&Cn(n,At(n),t)}function lc(t,n){return t&&Cn(n,zt(n),t)}function Pn(t,n,e){n=="__proto__"&&sr?sr(t,n,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[n]=e}function Si(t,n){for(var e=-1,s=n.length,o=b(s),l=t==null;++e<s;)o[e]=l?r:is(t,n[e]);return o}function Vn(t,n,e){return t===t&&(e!==r&&(t=t<=e?t:e),n!==r&&(t=t>=n?t:n)),t}function on(t,n,e,s,o,l){var h,g=n&v,y=n&F,x=n&R;if(e&&(h=o?e(t,s,o,l):e(t)),h!==r)return h;if(!dt(t))return t;var A=K(t);if(A){if(h=Qc(t),!g)return $t(t,h)}else{var P=Ft(t),k=P==Bt||P==yn;if(Hn(t))return ja(t,g);if(P==Ct||P==nt||k&&!o){if(h=y||k?{}:yo(t),!g)return y?Uc(t,lc(h,t)):Bc(t,Ta(h,t))}else{if(!ut[P])return o?t:{};h=Vc(t,P,g)}}l||(l=new pn);var D=l.get(t);if(D)return D;l.set(t,h),Jo(t)?t.forEach(function(U){h.add(on(U,n,e,U,t,l))}):Ko(t)&&t.forEach(function(U,V){h.set(V,on(U,n,e,V,t,l))});var B=x?y?Gi:zi:y?zt:At,X=A?r:B(t);return rn(X||t,function(U,V){X&&(V=U,U=t[V]),Fe(h,V,on(U,n,e,V,t,l))}),h}function fc(t){var n=At(t);return function(e){return Fa(e,t,n)}}function Fa(t,n,e){var s=e.length;if(t==null)return!s;for(t=at(t);s--;){var o=e[s],l=n[o],h=t[o];if(h===r&&!(o in t)||!l(h))return!1}return!0}function Ea(t,n,e){if(typeof t!="function")throw new sn(d);return Ne(function(){t.apply(r,e)},n)}function Ee(t,n,e,s){var o=-1,l=Je,h=!0,g=t.length,y=[],x=n.length;if(!g)return y;e&&(n=gt(n,Jt(e))),s?(l=fi,h=!1):n.length>=f&&(l=Se,h=!1,n=new Qn(n));t:for(;++o<g;){var A=t[o],P=e==null?A:e(A);if(A=s||A!==0?A:0,h&&P===P){for(var k=x;k--;)if(n[k]===P)continue t;y.push(A)}else l(n,P,s)||y.push(A)}return y}var $n=io(Mn),Ra=io(Ai,!0);function cc(t,n){var e=!0;return $n(t,function(s,o,l){return e=!!n(s,o,l),e}),e}function hr(t,n,e){for(var s=-1,o=t.length;++s<o;){var l=t[s],h=n(l);if(h!=null&&(g===r?h===h&&!Xt(h):e(h,g)))var g=h,y=l}return y}function hc(t,n,e,s){var o=t.length;for(e=Y(e),e<0&&(e=-e>o?0:o+e),s=s===r||s>o?o:Y(s),s<0&&(s+=o),s=e>s?0:Xo(s);e<s;)t[e++]=n;return t}function ka(t,n){var e=[];return $n(t,function(s,o,l){n(s,o,l)&&e.push(s)}),e}function Pt(t,n,e,s,o){var l=-1,h=t.length;for(e||(e=th),o||(o=[]);++l<h;){var g=t[l];n>0&&e(g)?n>1?Pt(g,n-1,e,s,o):Wn(o,g):s||(o[o.length]=g)}return o}var xi=so(),La=so(!0);function Mn(t,n){return t&&xi(t,n,At)}function Ai(t,n){return t&&La(t,n,At)}function pr(t,n){return Nn(n,function(e){return Rn(t[e])})}function jn(t,n){n=zn(n,t);for(var e=0,s=n.length;t!=null&&e<s;)t=t[bn(n[e++])];return e&&e==s?t:r}function Oa(t,n,e){var s=n(t);return K(t)?s:Wn(s,e(t))}function Lt(t){return t==null?t===r?Uu:Dn:Yn&&Yn in at(t)?Jc(t):oh(t)}function Ii(t,n){return t>n}function pc(t,n){return t!=null&&st.call(t,n)}function gc(t,n){return t!=null&&n in at(t)}function dc(t,n,e){return t>=Tt(n,e)&&t<xt(n,e)}function Pi(t,n,e){for(var s=e?fi:Je,o=t[0].length,l=t.length,h=l,g=b(l),y=1/0,x=[];h--;){var A=t[h];h&&n&&(A=gt(A,Jt(n))),y=Tt(A.length,y),g[h]=!e&&(n||o>=120&&A.length>=120)?new Qn(h&&A):r}A=t[0];var P=-1,k=g[0];t:for(;++P<o&&x.length<y;){var D=A[P],B=n?n(D):D;if(D=e||D!==0?D:0,!(k?Se(k,B):s(x,B,e))){for(h=l;--h;){var X=g[h];if(!(X?Se(X,B):s(t[h],B,e)))continue t}k&&k.push(B),x.push(D)}}return x}function _c(t,n,e,s){return Mn(t,function(o,l,h){n(s,e(o),l,h)}),s}function Re(t,n,e){n=zn(n,t),t=bo(t,n);var s=t==null?t:t[bn(ln(n))];return s==null?r:Zt(s,t,e)}function Da(t){return mt(t)&&Lt(t)==nt}function vc(t){return mt(t)&&Lt(t)==be}function mc(t){return mt(t)&&Lt(t)==Mt}function ke(t,n,e,s,o){return t===n?!0:t==null||n==null||!mt(t)&&!mt(n)?t!==t&&n!==n:yc(t,n,e,s,ke,o)}function yc(t,n,e,s,o,l){var h=K(t),g=K(n),y=h?ht:Ft(t),x=g?ht:Ft(n);y=y==nt?Ct:y,x=x==nt?Ct:x;var A=y==Ct,P=x==Ct,k=y==x;if(k&&Hn(t)){if(!Hn(n))return!1;h=!0,A=!1}if(k&&!A)return l||(l=new pn),h||_e(t)?_o(t,n,e,s,o,l):Kc(t,n,y,e,s,o,l);if(!(e&E)){var D=A&&st.call(t,"__wrapped__"),B=P&&st.call(n,"__wrapped__");if(D||B){var X=D?t.value():t,U=B?n.value():n;return l||(l=new pn),o(X,U,e,s,l)}}return k?(l||(l=new pn),Zc(t,n,e,s,o,l)):!1}function wc(t){return mt(t)&&Ft(t)==vt}function Ti(t,n,e,s){var o=e.length,l=o,h=!s;if(t==null)return!l;for(t=at(t);o--;){var g=e[o];if(h&&g[2]?g[1]!==t[g[0]]:!(g[0]in t))return!1}for(;++o<l;){g=e[o];var y=g[0],x=t[y],A=g[1];if(h&&g[2]){if(x===r&&!(y in t))return!1}else{var P=new pn;if(s)var k=s(x,A,y,t,n,P);if(!(k===r?ke(A,x,E|T,s,P):k))return!1}}return!0}function Na(t){if(!dt(t)||eh(t))return!1;var n=Rn(t)?wf:ll;return n.test(ne(t))}function Mc(t){return mt(t)&&Lt(t)==nn}function Cc(t){return mt(t)&&Ft(t)==pt}function bc(t){return mt(t)&&Fr(t.length)&&!!ft[Lt(t)]}function Wa(t){return typeof t=="function"?t:t==null?Gt:typeof t=="object"?K(t)?$a(t[0],t[1]):Ua(t):ou(t)}function Fi(t){if(!De(t))return Af(t);var n=[];for(var e in at(t))st.call(t,e)&&e!="constructor"&&n.push(e);return n}function Sc(t){if(!dt(t))return ah(t);var n=De(t),e=[];for(var s in t)s=="constructor"&&(n||!st.call(t,s))||e.push(s);return e}function Ei(t,n){return t<n}function Ba(t,n){var e=-1,s=qt(t)?b(t.length):[];return $n(t,function(o,l,h){s[++e]=n(o,l,h)}),s}function Ua(t){var n=Ki(t);return n.length==1&&n[0][2]?Mo(n[0][0],n[0][1]):function(e){return e===t||Ti(e,t,n)}}function $a(t,n){return Ji(t)&&wo(n)?Mo(bn(t),n):function(e){var s=is(e,t);return s===r&&s===n?ss(e,t):ke(n,s,E|T)}}function gr(t,n,e,s,o){t!==n&&xi(n,function(l,h){if(o||(o=new pn),dt(l))xc(t,n,h,e,gr,s,o);else{var g=s?s(Xi(t,h),l,h+"",t,n,o):r;g===r&&(g=l),bi(t,h,g)}},zt)}function xc(t,n,e,s,o,l,h){var g=Xi(t,e),y=Xi(n,e),x=h.get(y);if(x){bi(t,e,x);return}var A=l?l(g,y,e+"",t,n,h):r,P=A===r;if(P){var k=K(y),D=!k&&Hn(y),B=!k&&!D&&_e(y);A=y,k||D||B?K(g)?A=g:yt(g)?A=$t(g):D?(P=!1,A=ja(y,!0)):B?(P=!1,A=to(y,!0)):A=[]:We(y)||ee(y)?(A=g,ee(g)?A=Qo(g):(!dt(g)||Rn(g))&&(A=yo(y))):P=!1}P&&(h.set(y,A),o(A,y,s,l,h),h.delete(y)),bi(t,e,A)}function qa(t,n){var e=t.length;if(e)return n+=n<0?e:0,En(n,e)?t[n]:r}function za(t,n,e){n.length?n=gt(n,function(l){return K(l)?function(h){return jn(h,l.length===1?l[0]:l)}:l}):n=[Gt];var s=-1;n=gt(n,Jt(W()));var o=Ba(t,function(l,h,g){var y=gt(n,function(x){return x(l)});return{criteria:y,index:++s,value:l}});return Ql(o,function(l,h){return Wc(l,h,e)})}function Ac(t,n){return Ga(t,n,function(e,s){return ss(t,s)})}function Ga(t,n,e){for(var s=-1,o=n.length,l={};++s<o;){var h=n[s],g=jn(t,h);e(g,h)&&Le(l,zn(h,t),g)}return l}function Ic(t){return function(n){return jn(n,t)}}function Ri(t,n,e,s){var o=s?Xl:se,l=-1,h=n.length,g=t;for(t===n&&(n=$t(n)),e&&(g=gt(t,Jt(e)));++l<h;)for(var y=0,x=n[l],A=e?e(x):x;(y=o(g,A,y,s))>-1;)g!==t&&ir.call(g,y,1),ir.call(t,y,1);return t}function Ha(t,n){for(var e=t?n.length:0,s=e-1;e--;){var o=n[e];if(e==s||o!==l){var l=o;En(o)?ir.call(t,o,1):Di(t,o)}}return t}function ki(t,n){return t+or(xa()*(n-t+1))}function Pc(t,n,e,s){for(var o=-1,l=xt(ar((n-t)/(e||1)),0),h=b(l);l--;)h[s?l:++o]=t,t+=e;return h}function Li(t,n){var e="";if(!t||n<1||n>mn)return e;do n%2&&(e+=t),n=or(n/2),n&&(t+=t);while(n);return e}function Q(t,n){return Qi(Co(t,n,Gt),t+"")}function Tc(t){return Pa(ve(t))}function Fc(t,n){var e=ve(t);return Sr(e,Vn(n,0,e.length))}function Le(t,n,e,s){if(!dt(t))return t;n=zn(n,t);for(var o=-1,l=n.length,h=l-1,g=t;g!=null&&++o<l;){var y=bn(n[o]),x=e;if(y==="__proto__"||y==="constructor"||y==="prototype")return t;if(o!=h){var A=g[y];x=s?s(A,y,g):r,x===r&&(x=dt(A)?A:En(n[o+1])?[]:{})}Fe(g,y,x),g=g[y]}return t}var Ka=ur?function(t,n){return ur.set(t,n),t}:Gt,Ec=sr?function(t,n){return sr(t,"toString",{configurable:!0,enumerable:!1,value:os(n),writable:!0})}:Gt;function Rc(t){return Sr(ve(t))}function un(t,n,e){var s=-1,o=t.length;n<0&&(n=-n>o?0:o+n),e=e>o?o:e,e<0&&(e+=o),o=n>e?0:e-n>>>0,n>>>=0;for(var l=b(o);++s<o;)l[s]=t[s+n];return l}function kc(t,n){var e;return $n(t,function(s,o,l){return e=n(s,o,l),!e}),!!e}function dr(t,n,e){var s=0,o=t==null?s:t.length;if(typeof n=="number"&&n===n&&o<=G){for(;s<o;){var l=s+o>>>1,h=t[l];h!==null&&!Xt(h)&&(e?h<=n:h<n)?s=l+1:o=l}return o}return Oi(t,n,Gt,e)}function Oi(t,n,e,s){var o=0,l=t==null?0:t.length;if(l===0)return 0;n=e(n);for(var h=n!==n,g=n===null,y=Xt(n),x=n===r;o<l;){var A=or((o+l)/2),P=e(t[A]),k=P!==r,D=P===null,B=P===P,X=Xt(P);if(h)var U=s||B;else x?U=B&&(s||k):g?U=B&&k&&(s||!D):y?U=B&&k&&!D&&(s||!X):D||X?U=!1:U=s?P<=n:P<n;U?o=A+1:l=A}return Tt(l,$)}function Za(t,n){for(var e=-1,s=t.length,o=0,l=[];++e<s;){var h=t[e],g=n?n(h):h;if(!e||!gn(g,y)){var y=g;l[o++]=h===0?0:h}}return l}function Ja(t){return typeof t=="number"?t:Xt(t)?xn:+t}function Yt(t){if(typeof t=="string")return t;if(K(t))return gt(t,Yt)+"";if(Xt(t))return Aa?Aa.call(t):"";var n=t+"";return n=="0"&&1/t==-Sn?"-0":n}function qn(t,n,e){var s=-1,o=Je,l=t.length,h=!0,g=[],y=g;if(e)h=!1,o=fi;else if(l>=f){var x=n?null:Gc(t);if(x)return Xe(x);h=!1,o=Se,y=new Qn}else y=n?[]:g;t:for(;++s<l;){var A=t[s],P=n?n(A):A;if(A=e||A!==0?A:0,h&&P===P){for(var k=y.length;k--;)if(y[k]===P)continue t;n&&y.push(P),g.push(A)}else o(y,P,e)||(y!==g&&y.push(P),g.push(A))}return g}function Di(t,n){return n=zn(n,t),t=bo(t,n),t==null||delete t[bn(ln(n))]}function Ya(t,n,e,s){return Le(t,n,e(jn(t,n)),s)}function _r(t,n,e,s){for(var o=t.length,l=s?o:-1;(s?l--:++l<o)&&n(t[l],l,t););return e?un(t,s?0:l,s?l+1:o):un(t,s?l+1:0,s?o:l)}function Xa(t,n){var e=t;return e instanceof j&&(e=e.value()),ci(n,function(s,o){return o.func.apply(o.thisArg,Wn([s],o.args))},e)}function Ni(t,n,e){var s=t.length;if(s<2)return s?qn(t[0]):[];for(var o=-1,l=b(s);++o<s;)for(var h=t[o],g=-1;++g<s;)g!=o&&(l[o]=Ee(l[o]||h,t[g],n,e));return qn(Pt(l,1),n,e)}function Qa(t,n,e){for(var s=-1,o=t.length,l=n.length,h={};++s<o;){var g=s<l?n[s]:r;e(h,t[s],g)}return h}function Wi(t){return yt(t)?t:[]}function Bi(t){return typeof t=="function"?t:Gt}function zn(t,n){return K(t)?t:Ji(t,n)?[t]:Io(rt(t))}var Lc=Q;function Gn(t,n,e){var s=t.length;return e=e===r?s:e,!n&&e>=s?t:un(t,n,e)}var Va=Mf||function(t){return It.clearTimeout(t)};function ja(t,n){if(n)return t.slice();var e=t.length,s=wa?wa(e):new t.constructor(e);return t.copy(s),s}function Ui(t){var n=new t.constructor(t.byteLength);return new er(n).set(new er(t)),n}function Oc(t,n){var e=n?Ui(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}function Dc(t){var n=new t.constructor(t.source,Ds.exec(t));return n.lastIndex=t.lastIndex,n}function Nc(t){return Te?at(Te.call(t)):{}}function to(t,n){var e=n?Ui(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function no(t,n){if(t!==n){var e=t!==r,s=t===null,o=t===t,l=Xt(t),h=n!==r,g=n===null,y=n===n,x=Xt(n);if(!g&&!x&&!l&&t>n||l&&h&&y&&!g&&!x||s&&h&&y||!e&&y||!o)return 1;if(!s&&!l&&!x&&t<n||x&&e&&o&&!s&&!l||g&&e&&o||!h&&o||!y)return-1}return 0}function Wc(t,n,e){for(var s=-1,o=t.criteria,l=n.criteria,h=o.length,g=e.length;++s<h;){var y=no(o[s],l[s]);if(y){if(s>=g)return y;var x=e[s];return y*(x=="desc"?-1:1)}}return t.index-n.index}function eo(t,n,e,s){for(var o=-1,l=t.length,h=e.length,g=-1,y=n.length,x=xt(l-h,0),A=b(y+x),P=!s;++g<y;)A[g]=n[g];for(;++o<h;)(P||o<l)&&(A[e[o]]=t[o]);for(;x--;)A[g++]=t[o++];return A}function ro(t,n,e,s){for(var o=-1,l=t.length,h=-1,g=e.length,y=-1,x=n.length,A=xt(l-g,0),P=b(A+x),k=!s;++o<A;)P[o]=t[o];for(var D=o;++y<x;)P[D+y]=n[y];for(;++h<g;)(k||o<l)&&(P[D+e[h]]=t[o++]);return P}function $t(t,n){var e=-1,s=t.length;for(n||(n=b(s));++e<s;)n[e]=t[e];return n}function Cn(t,n,e,s){var o=!e;e||(e={});for(var l=-1,h=n.length;++l<h;){var g=n[l],y=s?s(e[g],t[g],g,e,t):r;y===r&&(y=t[g]),o?Pn(e,g,y):Fe(e,g,y)}return e}function Bc(t,n){return Cn(t,Zi(t),n)}function Uc(t,n){return Cn(t,vo(t),n)}function vr(t,n){return function(e,s){var o=K(e)?Gl:uc,l=n?n():{};return o(e,t,W(s,2),l)}}function pe(t){return Q(function(n,e){var s=-1,o=e.length,l=o>1?e[o-1]:r,h=o>2?e[2]:r;for(l=t.length>3&&typeof l=="function"?(o--,l):r,h&&Ot(e[0],e[1],h)&&(l=o<3?r:l,o=1),n=at(n);++s<o;){var g=e[s];g&&t(n,g,s,l)}return n})}function io(t,n){return function(e,s){if(e==null)return e;if(!qt(e))return t(e,s);for(var o=e.length,l=n?o:-1,h=at(e);(n?l--:++l<o)&&s(h[l],l,h)!==!1;);return e}}function so(t){return function(n,e,s){for(var o=-1,l=at(n),h=s(n),g=h.length;g--;){var y=h[t?g:++o];if(e(l[y],y,l)===!1)break}return n}}function $c(t,n,e){var s=n&N,o=Oe(t);function l(){var h=this&&this!==It&&this instanceof l?o:t;return h.apply(s?e:this,arguments)}return l}function ao(t){return function(n){n=rt(n);var e=ae(n)?hn(n):r,s=e?e[0]:n.charAt(0),o=e?Gn(e,1).join(""):n.slice(1);return s[t]()+o}}function ge(t){return function(n){return ci(su(iu(n).replace(Fl,"")),t,"")}}function Oe(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var e=he(t.prototype),s=t.apply(e,n);return dt(s)?s:e}}function qc(t,n,e){var s=Oe(t);function o(){for(var l=arguments.length,h=b(l),g=l,y=de(o);g--;)h[g]=arguments[g];var x=l<3&&h[0]!==y&&h[l-1]!==y?[]:Bn(h,y);if(l-=x.length,l<e)return co(t,n,mr,o.placeholder,r,h,x,r,r,e-l);var A=this&&this!==It&&this instanceof o?s:t;return Zt(A,this,h)}return o}function oo(t){return function(n,e,s){var o=at(n);if(!qt(n)){var l=W(e,3);n=At(n),e=function(g){return l(o[g],g,o)}}var h=t(n,e,s);return h>-1?o[l?n[h]:h]:r}}function uo(t){return Fn(function(n){var e=n.length,s=e,o=an.prototype.thru;for(t&&n.reverse();s--;){var l=n[s];if(typeof l!="function")throw new sn(d);if(o&&!h&&Cr(l)=="wrapper")var h=new an([],!0)}for(s=h?s:e;++s<e;){l=n[s];var g=Cr(l),y=g=="wrapper"?Hi(l):r;y&&Yi(y[0])&&y[1]==(bt|J|_t|tn)&&!y[4].length&&y[9]==1?h=h[Cr(y[0])].apply(h,y[3]):h=l.length==1&&Yi(l)?h[g]():h.thru(l)}return function(){var x=arguments,A=x[0];if(h&&x.length==1&&K(A))return h.plant(A).value();for(var P=0,k=e?n[P].apply(this,x):A;++P<e;)k=n[P].call(this,k);return k}})}function mr(t,n,e,s,o,l,h,g,y,x){var A=n&bt,P=n&N,k=n&q,D=n&(J|it),B=n&Ht,X=k?r:Oe(t);function U(){for(var V=arguments.length,tt=b(V),Qt=V;Qt--;)tt[Qt]=arguments[Qt];if(D)var Dt=de(U),Vt=jl(tt,Dt);if(s&&(tt=eo(tt,s,o,D)),l&&(tt=ro(tt,l,h,D)),V-=Vt,D&&V<x){var wt=Bn(tt,Dt);return co(t,n,mr,U.placeholder,e,tt,wt,g,y,x-V)}var dn=P?e:this,Ln=k?dn[t]:t;return V=tt.length,g?tt=uh(tt,g):B&&V>1&&tt.reverse(),A&&y<V&&(tt.length=y),this&&this!==It&&this instanceof U&&(Ln=X||Oe(Ln)),Ln.apply(dn,tt)}return U}function lo(t,n){return function(e,s){return _c(e,t,n(s),{})}}function yr(t,n){return function(e,s){var o;if(e===r&&s===r)return n;if(e!==r&&(o=e),s!==r){if(o===r)return s;typeof e=="string"||typeof s=="string"?(e=Yt(e),s=Yt(s)):(e=Ja(e),s=Ja(s)),o=t(e,s)}return o}}function $i(t){return Fn(function(n){return n=gt(n,Jt(W())),Q(function(e){var s=this;return t(n,function(o){return Zt(o,s,e)})})})}function wr(t,n){n=n===r?" ":Yt(n);var e=n.length;if(e<2)return e?Li(n,t):n;var s=Li(n,ar(t/oe(n)));return ae(n)?Gn(hn(s),0,t).join(""):s.slice(0,t)}function zc(t,n,e,s){var o=n&N,l=Oe(t);function h(){for(var g=-1,y=arguments.length,x=-1,A=s.length,P=b(A+y),k=this&&this!==It&&this instanceof h?l:t;++x<A;)P[x]=s[x];for(;y--;)P[x++]=arguments[++g];return Zt(k,o?e:this,P)}return h}function fo(t){return function(n,e,s){return s&&typeof s!="number"&&Ot(n,e,s)&&(e=s=r),n=kn(n),e===r?(e=n,n=0):e=kn(e),s=s===r?n<e?1:-1:kn(s),Pc(n,e,s,t)}}function Mr(t){return function(n,e){return typeof n=="string"&&typeof e=="string"||(n=fn(n),e=fn(e)),t(n,e)}}function co(t,n,e,s,o,l,h,g,y,x){var A=n&J,P=A?h:r,k=A?r:h,D=A?l:r,B=A?r:l;n|=A?_t:Wt,n&=~(A?Wt:_t),n&Z||(n&=~(N|q));var X=[t,n,o,D,P,B,k,g,y,x],U=e.apply(r,X);return Yi(t)&&So(U,X),U.placeholder=s,xo(U,t,n)}function qi(t){var n=St[t];return function(e,s){if(e=fn(e),s=s==null?0:Tt(Y(s),292),s&&Sa(e)){var o=(rt(e)+"e").split("e"),l=n(o[0]+"e"+(+o[1]+s));return o=(rt(l)+"e").split("e"),+(o[0]+"e"+(+o[1]-s))}return n(e)}}var Gc=fe&&1/Xe(new fe([,-0]))[1]==Sn?function(t){return new fe(t)}:fs;function ho(t){return function(n){var e=Ft(n);return e==vt?mi(n):e==pt?of(n):Vl(n,t(n))}}function Tn(t,n,e,s,o,l,h,g){var y=n&q;if(!y&&typeof t!="function")throw new sn(d);var x=s?s.length:0;if(x||(n&=~(_t|Wt),s=o=r),h=h===r?h:xt(Y(h),0),g=g===r?g:Y(g),x-=o?o.length:0,n&Wt){var A=s,P=o;s=o=r}var k=y?r:Hi(t),D=[t,n,e,s,o,A,P,l,h,g];if(k&&sh(D,k),t=D[0],n=D[1],e=D[2],s=D[3],o=D[4],g=D[9]=D[9]===r?y?0:t.length:xt(D[9]-x,0),!g&&n&(J|it)&&(n&=~(J|it)),!n||n==N)var B=$c(t,n,e);else n==J||n==it?B=qc(t,n,g):(n==_t||n==(N|_t))&&!o.length?B=zc(t,n,e,s):B=mr.apply(r,D);var X=k?Ka:So;return xo(X(B,D),t,n)}function po(t,n,e,s){return t===r||gn(t,le[e])&&!st.call(s,e)?n:t}function go(t,n,e,s,o,l){return dt(t)&&dt(n)&&(l.set(n,t),gr(t,n,r,go,l),l.delete(n)),t}function Hc(t){return We(t)?r:t}function _o(t,n,e,s,o,l){var h=e&E,g=t.length,y=n.length;if(g!=y&&!(h&&y>g))return!1;var x=l.get(t),A=l.get(n);if(x&&A)return x==n&&A==t;var P=-1,k=!0,D=e&T?new Qn:r;for(l.set(t,n),l.set(n,t);++P<g;){var B=t[P],X=n[P];if(s)var U=h?s(X,B,P,n,t,l):s(B,X,P,t,n,l);if(U!==r){if(U)continue;k=!1;break}if(D){if(!hi(n,function(V,tt){if(!Se(D,tt)&&(B===V||o(B,V,e,s,l)))return D.push(tt)})){k=!1;break}}else if(!(B===X||o(B,X,e,s,l))){k=!1;break}}return l.delete(t),l.delete(n),k}function Kc(t,n,e,s,o,l,h){switch(e){case re:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case be:return!(t.byteLength!=n.byteLength||!l(new er(t),new er(n)));case lt:case Mt:case kt:return gn(+t,+n);case Rt:return t.name==n.name&&t.message==n.message;case nn:case wn:return t==n+"";case vt:var g=mi;case pt:var y=s&E;if(g||(g=Xe),t.size!=n.size&&!y)return!1;var x=h.get(t);if(x)return x==n;s|=T,h.set(t,n);var A=_o(g(t),g(n),s,o,l,h);return h.delete(t),A;case Ge:if(Te)return Te.call(t)==Te.call(n)}return!1}function Zc(t,n,e,s,o,l){var h=e&E,g=zi(t),y=g.length,x=zi(n),A=x.length;if(y!=A&&!h)return!1;for(var P=y;P--;){var k=g[P];if(!(h?k in n:st.call(n,k)))return!1}var D=l.get(t),B=l.get(n);if(D&&B)return D==n&&B==t;var X=!0;l.set(t,n),l.set(n,t);for(var U=h;++P<y;){k=g[P];var V=t[k],tt=n[k];if(s)var Qt=h?s(tt,V,k,n,t,l):s(V,tt,k,t,n,l);if(!(Qt===r?V===tt||o(V,tt,e,s,l):Qt)){X=!1;break}U||(U=k=="constructor")}if(X&&!U){var Dt=t.constructor,Vt=n.constructor;Dt!=Vt&&"constructor"in t&&"constructor"in n&&!(typeof Dt=="function"&&Dt instanceof Dt&&typeof Vt=="function"&&Vt instanceof Vt)&&(X=!1)}return l.delete(t),l.delete(n),X}function Fn(t){return Qi(Co(t,r,Eo),t+"")}function zi(t){return Oa(t,At,Zi)}function Gi(t){return Oa(t,zt,vo)}var Hi=ur?function(t){return ur.get(t)}:fs;function Cr(t){for(var n=t.name+"",e=ce[n],s=st.call(ce,n)?e.length:0;s--;){var o=e[s],l=o.func;if(l==null||l==t)return o.name}return n}function de(t){var n=st.call(u,"placeholder")?u:t;return n.placeholder}function W(){var t=u.iteratee||us;return t=t===us?Wa:t,arguments.length?t(arguments[0],arguments[1]):t}function br(t,n){var e=t.__data__;return nh(n)?e[typeof n=="string"?"string":"hash"]:e.map}function Ki(t){for(var n=At(t),e=n.length;e--;){var s=n[e],o=t[s];n[e]=[s,o,wo(o)]}return n}function te(t,n){var e=rf(t,n);return Na(e)?e:r}function Jc(t){var n=st.call(t,Yn),e=t[Yn];try{t[Yn]=r;var s=!0}catch{}var o=tr.call(t);return s&&(n?t[Yn]=e:delete t[Yn]),o}var Zi=wi?function(t){return t==null?[]:(t=at(t),Nn(wi(t),function(n){return Ca.call(t,n)}))}:cs,vo=wi?function(t){for(var n=[];t;)Wn(n,Zi(t)),t=rr(t);return n}:cs,Ft=Lt;(Mi&&Ft(new Mi(new ArrayBuffer(1)))!=re||Ae&&Ft(new Ae)!=vt||Ci&&Ft(Ci.resolve())!=Ut||fe&&Ft(new fe)!=pt||Ie&&Ft(new Ie)!=Ce)&&(Ft=function(t){var n=Lt(t),e=n==Ct?t.constructor:r,s=e?ne(e):"";if(s)switch(s){case Ff:return re;case Ef:return vt;case Rf:return Ut;case kf:return pt;case Lf:return Ce}return n});function Yc(t,n,e){for(var s=-1,o=e.length;++s<o;){var l=e[s],h=l.size;switch(l.type){case"drop":t+=h;break;case"dropRight":n-=h;break;case"take":n=Tt(n,t+h);break;case"takeRight":t=xt(t,n-h);break}}return{start:t,end:n}}function Xc(t){var n=t.match(nl);return n?n[1].split(el):[]}function mo(t,n,e){n=zn(n,t);for(var s=-1,o=n.length,l=!1;++s<o;){var h=bn(n[s]);if(!(l=t!=null&&e(t,h)))break;t=t[h]}return l||++s!=o?l:(o=t==null?0:t.length,!!o&&Fr(o)&&En(h,o)&&(K(t)||ee(t)))}function Qc(t){var n=t.length,e=new t.constructor(n);return n&&typeof t[0]=="string"&&st.call(t,"index")&&(e.index=t.index,e.input=t.input),e}function yo(t){return typeof t.constructor=="function"&&!De(t)?he(rr(t)):{}}function Vc(t,n,e){var s=t.constructor;switch(n){case be:return Ui(t);case lt:case Mt:return new s(+t);case re:return Oc(t,e);case Kr:case Zr:case Jr:case Yr:case Xr:case Qr:case Vr:case jr:case ti:return to(t,e);case vt:return new s;case kt:case wn:return new s(t);case nn:return Dc(t);case pt:return new s;case Ge:return Nc(t)}}function jc(t,n){var e=n.length;if(!e)return t;var s=e-1;return n[s]=(e>1?"& ":"")+n[s],n=n.join(e>2?", ":" "),t.replace(tl,`{
/* [wrapped with `+n+`] */
`)}function th(t){return K(t)||ee(t)||!!(ba&&t&&t[ba])}function En(t,n){var e=typeof t;return n=n??mn,!!n&&(e=="number"||e!="symbol"&&cl.test(t))&&t>-1&&t%1==0&&t<n}function Ot(t,n,e){if(!dt(e))return!1;var s=typeof n;return(s=="number"?qt(e)&&En(n,e.length):s=="string"&&n in e)?gn(e[n],t):!1}function Ji(t,n){if(K(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||Xt(t)?!0:Xu.test(t)||!Yu.test(t)||n!=null&&t in at(n)}function nh(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Yi(t){var n=Cr(t),e=u[n];if(typeof e!="function"||!(n in j.prototype))return!1;if(t===e)return!0;var s=Hi(e);return!!s&&t===s[0]}function eh(t){return!!ya&&ya in t}var rh=Ve?Rn:hs;function De(t){var n=t&&t.constructor,e=typeof n=="function"&&n.prototype||le;return t===e}function wo(t){return t===t&&!dt(t)}function Mo(t,n){return function(e){return e==null?!1:e[t]===n&&(n!==r||t in at(e))}}function ih(t){var n=Pr(t,function(s){return e.size===C&&e.clear(),s}),e=n.cache;return n}function sh(t,n){var e=t[1],s=n[1],o=e|s,l=o<(N|q|bt),h=s==bt&&e==J||s==bt&&e==tn&&t[7].length<=n[8]||s==(bt|tn)&&n[7].length<=n[8]&&e==J;if(!(l||h))return t;s&N&&(t[2]=n[2],o|=e&N?0:Z);var g=n[3];if(g){var y=t[3];t[3]=y?eo(y,g,n[4]):g,t[4]=y?Bn(t[3],I):n[4]}return g=n[5],g&&(y=t[5],t[5]=y?ro(y,g,n[6]):g,t[6]=y?Bn(t[5],I):n[6]),g=n[7],g&&(t[7]=g),s&bt&&(t[8]=t[8]==null?n[8]:Tt(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=o,t}function ah(t){var n=[];if(t!=null)for(var e in at(t))n.push(e);return n}function oh(t){return tr.call(t)}function Co(t,n,e){return n=xt(n===r?t.length-1:n,0),function(){for(var s=arguments,o=-1,l=xt(s.length-n,0),h=b(l);++o<l;)h[o]=s[n+o];o=-1;for(var g=b(n+1);++o<n;)g[o]=s[o];return g[n]=e(h),Zt(t,this,g)}}function bo(t,n){return n.length<2?t:jn(t,un(n,0,-1))}function uh(t,n){for(var e=t.length,s=Tt(n.length,e),o=$t(t);s--;){var l=n[s];t[s]=En(l,e)?o[l]:r}return t}function Xi(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var So=Ao(Ka),Ne=bf||function(t,n){return It.setTimeout(t,n)},Qi=Ao(Ec);function xo(t,n,e){var s=n+"";return Qi(t,jc(s,lh(Xc(s),e)))}function Ao(t){var n=0,e=0;return function(){var s=If(),o=Gr-(s-e);if(e=s,o>0){if(++n>=$e)return arguments[0]}else n=0;return t.apply(r,arguments)}}function Sr(t,n){var e=-1,s=t.length,o=s-1;for(n=n===r?s:n;++e<n;){var l=ki(e,o),h=t[l];t[l]=t[e],t[e]=h}return t.length=n,t}var Io=ih(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(Qu,function(e,s,o,l){n.push(o?l.replace(sl,"$1"):s||e)}),n});function bn(t){if(typeof t=="string"||Xt(t))return t;var n=t+"";return n=="0"&&1/t==-Sn?"-0":n}function ne(t){if(t!=null){try{return je.call(t)}catch{}try{return t+""}catch{}}return""}function lh(t,n){return rn(ct,function(e){var s="_."+e[0];n&e[1]&&!Je(t,s)&&t.push(s)}),t.sort()}function Po(t){if(t instanceof j)return t.clone();var n=new an(t.__wrapped__,t.__chain__);return n.__actions__=$t(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function fh(t,n,e){(e?Ot(t,n,e):n===r)?n=1:n=xt(Y(n),0);var s=t==null?0:t.length;if(!s||n<1)return[];for(var o=0,l=0,h=b(ar(s/n));o<s;)h[l++]=un(t,o,o+=n);return h}function ch(t){for(var n=-1,e=t==null?0:t.length,s=0,o=[];++n<e;){var l=t[n];l&&(o[s++]=l)}return o}function hh(){var t=arguments.length;if(!t)return[];for(var n=b(t-1),e=arguments[0],s=t;s--;)n[s-1]=arguments[s];return Wn(K(e)?$t(e):[e],Pt(n,1))}var ph=Q(function(t,n){return yt(t)?Ee(t,Pt(n,1,yt,!0)):[]}),gh=Q(function(t,n){var e=ln(n);return yt(e)&&(e=r),yt(t)?Ee(t,Pt(n,1,yt,!0),W(e,2)):[]}),dh=Q(function(t,n){var e=ln(n);return yt(e)&&(e=r),yt(t)?Ee(t,Pt(n,1,yt,!0),r,e):[]});function _h(t,n,e){var s=t==null?0:t.length;return s?(n=e||n===r?1:Y(n),un(t,n<0?0:n,s)):[]}function vh(t,n,e){var s=t==null?0:t.length;return s?(n=e||n===r?1:Y(n),n=s-n,un(t,0,n<0?0:n)):[]}function mh(t,n){return t&&t.length?_r(t,W(n,3),!0,!0):[]}function yh(t,n){return t&&t.length?_r(t,W(n,3),!0):[]}function wh(t,n,e,s){var o=t==null?0:t.length;return o?(e&&typeof e!="number"&&Ot(t,n,e)&&(e=0,s=o),hc(t,n,e,s)):[]}function To(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var o=e==null?0:Y(e);return o<0&&(o=xt(s+o,0)),Ye(t,W(n,3),o)}function Fo(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var o=s-1;return e!==r&&(o=Y(e),o=e<0?xt(s+o,0):Tt(o,s-1)),Ye(t,W(n,3),o,!0)}function Eo(t){var n=t==null?0:t.length;return n?Pt(t,1):[]}function Mh(t){var n=t==null?0:t.length;return n?Pt(t,Sn):[]}function Ch(t,n){var e=t==null?0:t.length;return e?(n=n===r?1:Y(n),Pt(t,n)):[]}function bh(t){for(var n=-1,e=t==null?0:t.length,s={};++n<e;){var o=t[n];s[o[0]]=o[1]}return s}function Ro(t){return t&&t.length?t[0]:r}function Sh(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var o=e==null?0:Y(e);return o<0&&(o=xt(s+o,0)),se(t,n,o)}function xh(t){var n=t==null?0:t.length;return n?un(t,0,-1):[]}var Ah=Q(function(t){var n=gt(t,Wi);return n.length&&n[0]===t[0]?Pi(n):[]}),Ih=Q(function(t){var n=ln(t),e=gt(t,Wi);return n===ln(e)?n=r:e.pop(),e.length&&e[0]===t[0]?Pi(e,W(n,2)):[]}),Ph=Q(function(t){var n=ln(t),e=gt(t,Wi);return n=typeof n=="function"?n:r,n&&e.pop(),e.length&&e[0]===t[0]?Pi(e,r,n):[]});function Th(t,n){return t==null?"":xf.call(t,n)}function ln(t){var n=t==null?0:t.length;return n?t[n-1]:r}function Fh(t,n,e){var s=t==null?0:t.length;if(!s)return-1;var o=s;return e!==r&&(o=Y(e),o=o<0?xt(s+o,0):Tt(o,s-1)),n===n?lf(t,n,o):Ye(t,ca,o,!0)}function Eh(t,n){return t&&t.length?qa(t,Y(n)):r}var Rh=Q(ko);function ko(t,n){return t&&t.length&&n&&n.length?Ri(t,n):t}function kh(t,n,e){return t&&t.length&&n&&n.length?Ri(t,n,W(e,2)):t}function Lh(t,n,e){return t&&t.length&&n&&n.length?Ri(t,n,r,e):t}var Oh=Fn(function(t,n){var e=t==null?0:t.length,s=Si(t,n);return Ha(t,gt(n,function(o){return En(o,e)?+o:o}).sort(no)),s});function Dh(t,n){var e=[];if(!(t&&t.length))return e;var s=-1,o=[],l=t.length;for(n=W(n,3);++s<l;){var h=t[s];n(h,s,t)&&(e.push(h),o.push(s))}return Ha(t,o),e}function Vi(t){return t==null?t:Tf.call(t)}function Nh(t,n,e){var s=t==null?0:t.length;return s?(e&&typeof e!="number"&&Ot(t,n,e)?(n=0,e=s):(n=n==null?0:Y(n),e=e===r?s:Y(e)),un(t,n,e)):[]}function Wh(t,n){return dr(t,n)}function Bh(t,n,e){return Oi(t,n,W(e,2))}function Uh(t,n){var e=t==null?0:t.length;if(e){var s=dr(t,n);if(s<e&&gn(t[s],n))return s}return-1}function $h(t,n){return dr(t,n,!0)}function qh(t,n,e){return Oi(t,n,W(e,2),!0)}function zh(t,n){var e=t==null?0:t.length;if(e){var s=dr(t,n,!0)-1;if(gn(t[s],n))return s}return-1}function Gh(t){return t&&t.length?Za(t):[]}function Hh(t,n){return t&&t.length?Za(t,W(n,2)):[]}function Kh(t){var n=t==null?0:t.length;return n?un(t,1,n):[]}function Zh(t,n,e){return t&&t.length?(n=e||n===r?1:Y(n),un(t,0,n<0?0:n)):[]}function Jh(t,n,e){var s=t==null?0:t.length;return s?(n=e||n===r?1:Y(n),n=s-n,un(t,n<0?0:n,s)):[]}function Yh(t,n){return t&&t.length?_r(t,W(n,3),!1,!0):[]}function Xh(t,n){return t&&t.length?_r(t,W(n,3)):[]}var Qh=Q(function(t){return qn(Pt(t,1,yt,!0))}),Vh=Q(function(t){var n=ln(t);return yt(n)&&(n=r),qn(Pt(t,1,yt,!0),W(n,2))}),jh=Q(function(t){var n=ln(t);return n=typeof n=="function"?n:r,qn(Pt(t,1,yt,!0),r,n)});function tp(t){return t&&t.length?qn(t):[]}function np(t,n){return t&&t.length?qn(t,W(n,2)):[]}function ep(t,n){return n=typeof n=="function"?n:r,t&&t.length?qn(t,r,n):[]}function ji(t){if(!(t&&t.length))return[];var n=0;return t=Nn(t,function(e){if(yt(e))return n=xt(e.length,n),!0}),_i(n,function(e){return gt(t,pi(e))})}function Lo(t,n){if(!(t&&t.length))return[];var e=ji(t);return n==null?e:gt(e,function(s){return Zt(n,r,s)})}var rp=Q(function(t,n){return yt(t)?Ee(t,n):[]}),ip=Q(function(t){return Ni(Nn(t,yt))}),sp=Q(function(t){var n=ln(t);return yt(n)&&(n=r),Ni(Nn(t,yt),W(n,2))}),ap=Q(function(t){var n=ln(t);return n=typeof n=="function"?n:r,Ni(Nn(t,yt),r,n)}),op=Q(ji);function up(t,n){return Qa(t||[],n||[],Fe)}function lp(t,n){return Qa(t||[],n||[],Le)}var fp=Q(function(t){var n=t.length,e=n>1?t[n-1]:r;return e=typeof e=="function"?(t.pop(),e):r,Lo(t,e)});function Oo(t){var n=u(t);return n.__chain__=!0,n}function cp(t,n){return n(t),t}function xr(t,n){return n(t)}var hp=Fn(function(t){var n=t.length,e=n?t[0]:0,s=this.__wrapped__,o=function(l){return Si(l,t)};return n>1||this.__actions__.length||!(s instanceof j)||!En(e)?this.thru(o):(s=s.slice(e,+e+(n?1:0)),s.__actions__.push({func:xr,args:[o],thisArg:r}),new an(s,this.__chain__).thru(function(l){return n&&!l.length&&l.push(r),l}))});function pp(){return Oo(this)}function gp(){return new an(this.value(),this.__chain__)}function dp(){this.__values__===r&&(this.__values__=Yo(this.value()));var t=this.__index__>=this.__values__.length,n=t?r:this.__values__[this.__index__++];return{done:t,value:n}}function _p(){return this}function vp(t){for(var n,e=this;e instanceof fr;){var s=Po(e);s.__index__=0,s.__values__=r,n?o.__wrapped__=s:n=s;var o=s;e=e.__wrapped__}return o.__wrapped__=t,n}function mp(){var t=this.__wrapped__;if(t instanceof j){var n=t;return this.__actions__.length&&(n=new j(this)),n=n.reverse(),n.__actions__.push({func:xr,args:[Vi],thisArg:r}),new an(n,this.__chain__)}return this.thru(Vi)}function yp(){return Xa(this.__wrapped__,this.__actions__)}var wp=vr(function(t,n,e){st.call(t,e)?++t[e]:Pn(t,e,1)});function Mp(t,n,e){var s=K(t)?la:cc;return e&&Ot(t,n,e)&&(n=r),s(t,W(n,3))}function Cp(t,n){var e=K(t)?Nn:ka;return e(t,W(n,3))}var bp=oo(To),Sp=oo(Fo);function xp(t,n){return Pt(Ar(t,n),1)}function Ap(t,n){return Pt(Ar(t,n),Sn)}function Ip(t,n,e){return e=e===r?1:Y(e),Pt(Ar(t,n),e)}function Do(t,n){var e=K(t)?rn:$n;return e(t,W(n,3))}function No(t,n){var e=K(t)?Hl:Ra;return e(t,W(n,3))}var Pp=vr(function(t,n,e){st.call(t,e)?t[e].push(n):Pn(t,e,[n])});function Tp(t,n,e,s){t=qt(t)?t:ve(t),e=e&&!s?Y(e):0;var o=t.length;return e<0&&(e=xt(o+e,0)),Er(t)?e<=o&&t.indexOf(n,e)>-1:!!o&&se(t,n,e)>-1}var Fp=Q(function(t,n,e){var s=-1,o=typeof n=="function",l=qt(t)?b(t.length):[];return $n(t,function(h){l[++s]=o?Zt(n,h,e):Re(h,n,e)}),l}),Ep=vr(function(t,n,e){Pn(t,e,n)});function Ar(t,n){var e=K(t)?gt:Ba;return e(t,W(n,3))}function Rp(t,n,e,s){return t==null?[]:(K(n)||(n=n==null?[]:[n]),e=s?r:e,K(e)||(e=e==null?[]:[e]),za(t,n,e))}var kp=vr(function(t,n,e){t[e?0:1].push(n)},function(){return[[],[]]});function Lp(t,n,e){var s=K(t)?ci:pa,o=arguments.length<3;return s(t,W(n,4),e,o,$n)}function Op(t,n,e){var s=K(t)?Kl:pa,o=arguments.length<3;return s(t,W(n,4),e,o,Ra)}function Dp(t,n){var e=K(t)?Nn:ka;return e(t,Tr(W(n,3)))}function Np(t){var n=K(t)?Pa:Tc;return n(t)}function Wp(t,n,e){(e?Ot(t,n,e):n===r)?n=1:n=Y(n);var s=K(t)?ac:Fc;return s(t,n)}function Bp(t){var n=K(t)?oc:Rc;return n(t)}function Up(t){if(t==null)return 0;if(qt(t))return Er(t)?oe(t):t.length;var n=Ft(t);return n==vt||n==pt?t.size:Fi(t).length}function $p(t,n,e){var s=K(t)?hi:kc;return e&&Ot(t,n,e)&&(n=r),s(t,W(n,3))}var qp=Q(function(t,n){if(t==null)return[];var e=n.length;return e>1&&Ot(t,n[0],n[1])?n=[]:e>2&&Ot(n[0],n[1],n[2])&&(n=[n[0]]),za(t,Pt(n,1),[])}),Ir=Cf||function(){return It.Date.now()};function zp(t,n){if(typeof n!="function")throw new sn(d);return t=Y(t),function(){if(--t<1)return n.apply(this,arguments)}}function Wo(t,n,e){return n=e?r:n,n=t&&n==null?t.length:n,Tn(t,bt,r,r,r,r,n)}function Bo(t,n){var e;if(typeof n!="function")throw new sn(d);return t=Y(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=r),e}}var ts=Q(function(t,n,e){var s=N;if(e.length){var o=Bn(e,de(ts));s|=_t}return Tn(t,s,n,e,o)}),Uo=Q(function(t,n,e){var s=N|q;if(e.length){var o=Bn(e,de(Uo));s|=_t}return Tn(n,s,t,e,o)});function $o(t,n,e){n=e?r:n;var s=Tn(t,J,r,r,r,r,r,n);return s.placeholder=$o.placeholder,s}function qo(t,n,e){n=e?r:n;var s=Tn(t,it,r,r,r,r,r,n);return s.placeholder=qo.placeholder,s}function zo(t,n,e){var s,o,l,h,g,y,x=0,A=!1,P=!1,k=!0;if(typeof t!="function")throw new sn(d);n=fn(n)||0,dt(e)&&(A=!!e.leading,P="maxWait"in e,l=P?xt(fn(e.maxWait)||0,n):l,k="trailing"in e?!!e.trailing:k);function D(wt){var dn=s,Ln=o;return s=o=r,x=wt,h=t.apply(Ln,dn),h}function B(wt){return x=wt,g=Ne(V,n),A?D(wt):h}function X(wt){var dn=wt-y,Ln=wt-x,uu=n-dn;return P?Tt(uu,l-Ln):uu}function U(wt){var dn=wt-y,Ln=wt-x;return y===r||dn>=n||dn<0||P&&Ln>=l}function V(){var wt=Ir();if(U(wt))return tt(wt);g=Ne(V,X(wt))}function tt(wt){return g=r,k&&s?D(wt):(s=o=r,h)}function Qt(){g!==r&&Va(g),x=0,s=y=o=g=r}function Dt(){return g===r?h:tt(Ir())}function Vt(){var wt=Ir(),dn=U(wt);if(s=arguments,o=this,y=wt,dn){if(g===r)return B(y);if(P)return Va(g),g=Ne(V,n),D(y)}return g===r&&(g=Ne(V,n)),h}return Vt.cancel=Qt,Vt.flush=Dt,Vt}var Gp=Q(function(t,n){return Ea(t,1,n)}),Hp=Q(function(t,n,e){return Ea(t,fn(n)||0,e)});function Kp(t){return Tn(t,Ht)}function Pr(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new sn(d);var e=function(){var s=arguments,o=n?n.apply(this,s):s[0],l=e.cache;if(l.has(o))return l.get(o);var h=t.apply(this,s);return e.cache=l.set(o,h)||l,h};return e.cache=new(Pr.Cache||In),e}Pr.Cache=In;function Tr(t){if(typeof t!="function")throw new sn(d);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function Zp(t){return Bo(2,t)}var Jp=Lc(function(t,n){n=n.length==1&&K(n[0])?gt(n[0],Jt(W())):gt(Pt(n,1),Jt(W()));var e=n.length;return Q(function(s){for(var o=-1,l=Tt(s.length,e);++o<l;)s[o]=n[o].call(this,s[o]);return Zt(t,this,s)})}),ns=Q(function(t,n){var e=Bn(n,de(ns));return Tn(t,_t,r,n,e)}),Go=Q(function(t,n){var e=Bn(n,de(Go));return Tn(t,Wt,r,n,e)}),Yp=Fn(function(t,n){return Tn(t,tn,r,r,r,n)});function Xp(t,n){if(typeof t!="function")throw new sn(d);return n=n===r?n:Y(n),Q(t,n)}function Qp(t,n){if(typeof t!="function")throw new sn(d);return n=n==null?0:xt(Y(n),0),Q(function(e){var s=e[n],o=Gn(e,0,n);return s&&Wn(o,s),Zt(t,this,o)})}function Vp(t,n,e){var s=!0,o=!0;if(typeof t!="function")throw new sn(d);return dt(e)&&(s="leading"in e?!!e.leading:s,o="trailing"in e?!!e.trailing:o),zo(t,n,{leading:s,maxWait:n,trailing:o})}function jp(t){return Wo(t,1)}function tg(t,n){return ns(Bi(n),t)}function ng(){if(!arguments.length)return[];var t=arguments[0];return K(t)?t:[t]}function eg(t){return on(t,R)}function rg(t,n){return n=typeof n=="function"?n:r,on(t,R,n)}function ig(t){return on(t,v|R)}function sg(t,n){return n=typeof n=="function"?n:r,on(t,v|R,n)}function ag(t,n){return n==null||Fa(t,n,At(n))}function gn(t,n){return t===n||t!==t&&n!==n}var og=Mr(Ii),ug=Mr(function(t,n){return t>=n}),ee=Da(function(){return arguments}())?Da:function(t){return mt(t)&&st.call(t,"callee")&&!Ca.call(t,"callee")},K=b.isArray,lg=ra?Jt(ra):vc;function qt(t){return t!=null&&Fr(t.length)&&!Rn(t)}function yt(t){return mt(t)&&qt(t)}function fg(t){return t===!0||t===!1||mt(t)&&Lt(t)==lt}var Hn=Sf||hs,cg=ia?Jt(ia):mc;function hg(t){return mt(t)&&t.nodeType===1&&!We(t)}function pg(t){if(t==null)return!0;if(qt(t)&&(K(t)||typeof t=="string"||typeof t.splice=="function"||Hn(t)||_e(t)||ee(t)))return!t.length;var n=Ft(t);if(n==vt||n==pt)return!t.size;if(De(t))return!Fi(t).length;for(var e in t)if(st.call(t,e))return!1;return!0}function gg(t,n){return ke(t,n)}function dg(t,n,e){e=typeof e=="function"?e:r;var s=e?e(t,n):r;return s===r?ke(t,n,r,e):!!s}function es(t){if(!mt(t))return!1;var n=Lt(t);return n==Rt||n==Kt||typeof t.message=="string"&&typeof t.name=="string"&&!We(t)}function _g(t){return typeof t=="number"&&Sa(t)}function Rn(t){if(!dt(t))return!1;var n=Lt(t);return n==Bt||n==yn||n==ot||n==cn}function Ho(t){return typeof t=="number"&&t==Y(t)}function Fr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=mn}function dt(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function mt(t){return t!=null&&typeof t=="object"}var Ko=sa?Jt(sa):wc;function vg(t,n){return t===n||Ti(t,n,Ki(n))}function mg(t,n,e){return e=typeof e=="function"?e:r,Ti(t,n,Ki(n),e)}function yg(t){return Zo(t)&&t!=+t}function wg(t){if(rh(t))throw new H(p);return Na(t)}function Mg(t){return t===null}function Cg(t){return t==null}function Zo(t){return typeof t=="number"||mt(t)&&Lt(t)==kt}function We(t){if(!mt(t)||Lt(t)!=Ct)return!1;var n=rr(t);if(n===null)return!0;var e=st.call(n,"constructor")&&n.constructor;return typeof e=="function"&&e instanceof e&&je.call(e)==mf}var rs=aa?Jt(aa):Mc;function bg(t){return Ho(t)&&t>=-mn&&t<=mn}var Jo=oa?Jt(oa):Cc;function Er(t){return typeof t=="string"||!K(t)&&mt(t)&&Lt(t)==wn}function Xt(t){return typeof t=="symbol"||mt(t)&&Lt(t)==Ge}var _e=ua?Jt(ua):bc;function Sg(t){return t===r}function xg(t){return mt(t)&&Ft(t)==Ce}function Ag(t){return mt(t)&&Lt(t)==$u}var Ig=Mr(Ei),Pg=Mr(function(t,n){return t<=n});function Yo(t){if(!t)return[];if(qt(t))return Er(t)?hn(t):$t(t);if(xe&&t[xe])return af(t[xe]());var n=Ft(t),e=n==vt?mi:n==pt?Xe:ve;return e(t)}function kn(t){if(!t)return t===0?t:0;if(t=fn(t),t===Sn||t===-Sn){var n=t<0?-1:1;return n*ze}return t===t?t:0}function Y(t){var n=kn(t),e=n%1;return n===n?e?n-e:n:0}function Xo(t){return t?Vn(Y(t),0,L):0}function fn(t){if(typeof t=="number")return t;if(Xt(t))return xn;if(dt(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=dt(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=ga(t);var e=ul.test(t);return e||fl.test(t)?ql(t.slice(2),e?2:8):ol.test(t)?xn:+t}function Qo(t){return Cn(t,zt(t))}function Tg(t){return t?Vn(Y(t),-mn,mn):t===0?t:0}function rt(t){return t==null?"":Yt(t)}var Fg=pe(function(t,n){if(De(n)||qt(n)){Cn(n,At(n),t);return}for(var e in n)st.call(n,e)&&Fe(t,e,n[e])}),Vo=pe(function(t,n){Cn(n,zt(n),t)}),Rr=pe(function(t,n,e,s){Cn(n,zt(n),t,s)}),Eg=pe(function(t,n,e,s){Cn(n,At(n),t,s)}),Rg=Fn(Si);function kg(t,n){var e=he(t);return n==null?e:Ta(e,n)}var Lg=Q(function(t,n){t=at(t);var e=-1,s=n.length,o=s>2?n[2]:r;for(o&&Ot(n[0],n[1],o)&&(s=1);++e<s;)for(var l=n[e],h=zt(l),g=-1,y=h.length;++g<y;){var x=h[g],A=t[x];(A===r||gn(A,le[x])&&!st.call(t,x))&&(t[x]=l[x])}return t}),Og=Q(function(t){return t.push(r,go),Zt(jo,r,t)});function Dg(t,n){return fa(t,W(n,3),Mn)}function Ng(t,n){return fa(t,W(n,3),Ai)}function Wg(t,n){return t==null?t:xi(t,W(n,3),zt)}function Bg(t,n){return t==null?t:La(t,W(n,3),zt)}function Ug(t,n){return t&&Mn(t,W(n,3))}function $g(t,n){return t&&Ai(t,W(n,3))}function qg(t){return t==null?[]:pr(t,At(t))}function zg(t){return t==null?[]:pr(t,zt(t))}function is(t,n,e){var s=t==null?r:jn(t,n);return s===r?e:s}function Gg(t,n){return t!=null&&mo(t,n,pc)}function ss(t,n){return t!=null&&mo(t,n,gc)}var Hg=lo(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=tr.call(n)),t[n]=e},os(Gt)),Kg=lo(function(t,n,e){n!=null&&typeof n.toString!="function"&&(n=tr.call(n)),st.call(t,n)?t[n].push(e):t[n]=[e]},W),Zg=Q(Re);function At(t){return qt(t)?Ia(t):Fi(t)}function zt(t){return qt(t)?Ia(t,!0):Sc(t)}function Jg(t,n){var e={};return n=W(n,3),Mn(t,function(s,o,l){Pn(e,n(s,o,l),s)}),e}function Yg(t,n){var e={};return n=W(n,3),Mn(t,function(s,o,l){Pn(e,o,n(s,o,l))}),e}var Xg=pe(function(t,n,e){gr(t,n,e)}),jo=pe(function(t,n,e,s){gr(t,n,e,s)}),Qg=Fn(function(t,n){var e={};if(t==null)return e;var s=!1;n=gt(n,function(l){return l=zn(l,t),s||(s=l.length>1),l}),Cn(t,Gi(t),e),s&&(e=on(e,v|F|R,Hc));for(var o=n.length;o--;)Di(e,n[o]);return e});function Vg(t,n){return tu(t,Tr(W(n)))}var jg=Fn(function(t,n){return t==null?{}:Ac(t,n)});function tu(t,n){if(t==null)return{};var e=gt(Gi(t),function(s){return[s]});return n=W(n),Ga(t,e,function(s,o){return n(s,o[0])})}function td(t,n,e){n=zn(n,t);var s=-1,o=n.length;for(o||(o=1,t=r);++s<o;){var l=t==null?r:t[bn(n[s])];l===r&&(s=o,l=e),t=Rn(l)?l.call(t):l}return t}function nd(t,n,e){return t==null?t:Le(t,n,e)}function ed(t,n,e,s){return s=typeof s=="function"?s:r,t==null?t:Le(t,n,e,s)}var nu=ho(At),eu=ho(zt);function rd(t,n,e){var s=K(t),o=s||Hn(t)||_e(t);if(n=W(n,4),e==null){var l=t&&t.constructor;o?e=s?new l:[]:dt(t)?e=Rn(l)?he(rr(t)):{}:e={}}return(o?rn:Mn)(t,function(h,g,y){return n(e,h,g,y)}),e}function id(t,n){return t==null?!0:Di(t,n)}function sd(t,n,e){return t==null?t:Ya(t,n,Bi(e))}function ad(t,n,e,s){return s=typeof s=="function"?s:r,t==null?t:Ya(t,n,Bi(e),s)}function ve(t){return t==null?[]:vi(t,At(t))}function od(t){return t==null?[]:vi(t,zt(t))}function ud(t,n,e){return e===r&&(e=n,n=r),e!==r&&(e=fn(e),e=e===e?e:0),n!==r&&(n=fn(n),n=n===n?n:0),Vn(fn(t),n,e)}function ld(t,n,e){return n=kn(n),e===r?(e=n,n=0):e=kn(e),t=fn(t),dc(t,n,e)}function fd(t,n,e){if(e&&typeof e!="boolean"&&Ot(t,n,e)&&(n=e=r),e===r&&(typeof n=="boolean"?(e=n,n=r):typeof t=="boolean"&&(e=t,t=r)),t===r&&n===r?(t=0,n=1):(t=kn(t),n===r?(n=t,t=0):n=kn(n)),t>n){var s=t;t=n,n=s}if(e||t%1||n%1){var o=xa();return Tt(t+o*(n-t+$l("1e-"+((o+"").length-1))),n)}return ki(t,n)}var cd=ge(function(t,n,e){return n=n.toLowerCase(),t+(e?ru(n):n)});function ru(t){return as(rt(t).toLowerCase())}function iu(t){return t=rt(t),t&&t.replace(hl,tf).replace(El,"")}function hd(t,n,e){t=rt(t),n=Yt(n);var s=t.length;e=e===r?s:Vn(Y(e),0,s);var o=e;return e-=n.length,e>=0&&t.slice(e,o)==n}function pd(t){return t=rt(t),t&&Ku.test(t)?t.replace(Ls,nf):t}function gd(t){return t=rt(t),t&&Vu.test(t)?t.replace(ni,"\\$&"):t}var dd=ge(function(t,n,e){return t+(e?"-":"")+n.toLowerCase()}),_d=ge(function(t,n,e){return t+(e?" ":"")+n.toLowerCase()}),vd=ao("toLowerCase");function md(t,n,e){t=rt(t),n=Y(n);var s=n?oe(t):0;if(!n||s>=n)return t;var o=(n-s)/2;return wr(or(o),e)+t+wr(ar(o),e)}function yd(t,n,e){t=rt(t),n=Y(n);var s=n?oe(t):0;return n&&s<n?t+wr(n-s,e):t}function wd(t,n,e){t=rt(t),n=Y(n);var s=n?oe(t):0;return n&&s<n?wr(n-s,e)+t:t}function Md(t,n,e){return e||n==null?n=0:n&&(n=+n),Pf(rt(t).replace(ei,""),n||0)}function Cd(t,n,e){return(e?Ot(t,n,e):n===r)?n=1:n=Y(n),Li(rt(t),n)}function bd(){var t=arguments,n=rt(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var Sd=ge(function(t,n,e){return t+(e?"_":"")+n.toLowerCase()});function xd(t,n,e){return e&&typeof e!="number"&&Ot(t,n,e)&&(n=e=r),e=e===r?L:e>>>0,e?(t=rt(t),t&&(typeof n=="string"||n!=null&&!rs(n))&&(n=Yt(n),!n&&ae(t))?Gn(hn(t),0,e):t.split(n,e)):[]}var Ad=ge(function(t,n,e){return t+(e?" ":"")+as(n)});function Id(t,n,e){return t=rt(t),e=e==null?0:Vn(Y(e),0,t.length),n=Yt(n),t.slice(e,e+n.length)==n}function Pd(t,n,e){var s=u.templateSettings;e&&Ot(t,n,e)&&(n=r),t=rt(t),n=Rr({},n,s,po);var o=Rr({},n.imports,s.imports,po),l=At(o),h=vi(o,l),g,y,x=0,A=n.interpolate||He,P="__p += '",k=yi((n.escape||He).source+"|"+A.source+"|"+(A===Os?al:He).source+"|"+(n.evaluate||He).source+"|$","g"),D="//# sourceURL="+(st.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Dl+"]")+`
`;t.replace(k,function(U,V,tt,Qt,Dt,Vt){return tt||(tt=Qt),P+=t.slice(x,Vt).replace(pl,ef),V&&(g=!0,P+=`' +
__e(`+V+`) +
'`),Dt&&(y=!0,P+=`';
`+Dt+`;
__p += '`),tt&&(P+=`' +
((__t = (`+tt+`)) == null ? '' : __t) +
'`),x=Vt+U.length,U}),P+=`';
`;var B=st.call(n,"variable")&&n.variable;if(!B)P=`with (obj) {
`+P+`
}
`;else if(il.test(B))throw new H(m);P=(y?P.replace(qu,""):P).replace(zu,"$1").replace(Gu,"$1;"),P="function("+(B||"obj")+`) {
`+(B?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(g?", __e = _.escape":"")+(y?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+P+`return __p
}`;var X=au(function(){return et(l,D+"return "+P).apply(r,h)});if(X.source=P,es(X))throw X;return X}function Td(t){return rt(t).toLowerCase()}function Fd(t){return rt(t).toUpperCase()}function Ed(t,n,e){if(t=rt(t),t&&(e||n===r))return ga(t);if(!t||!(n=Yt(n)))return t;var s=hn(t),o=hn(n),l=da(s,o),h=_a(s,o)+1;return Gn(s,l,h).join("")}function Rd(t,n,e){if(t=rt(t),t&&(e||n===r))return t.slice(0,ma(t)+1);if(!t||!(n=Yt(n)))return t;var s=hn(t),o=_a(s,hn(n))+1;return Gn(s,0,o).join("")}function kd(t,n,e){if(t=rt(t),t&&(e||n===r))return t.replace(ei,"");if(!t||!(n=Yt(n)))return t;var s=hn(t),o=da(s,hn(n));return Gn(s,o).join("")}function Ld(t,n){var e=Et,s=we;if(dt(n)){var o="separator"in n?n.separator:o;e="length"in n?Y(n.length):e,s="omission"in n?Yt(n.omission):s}t=rt(t);var l=t.length;if(ae(t)){var h=hn(t);l=h.length}if(e>=l)return t;var g=e-oe(s);if(g<1)return s;var y=h?Gn(h,0,g).join(""):t.slice(0,g);if(o===r)return y+s;if(h&&(g+=y.length-g),rs(o)){if(t.slice(g).search(o)){var x,A=y;for(o.global||(o=yi(o.source,rt(Ds.exec(o))+"g")),o.lastIndex=0;x=o.exec(A);)var P=x.index;y=y.slice(0,P===r?g:P)}}else if(t.indexOf(Yt(o),g)!=g){var k=y.lastIndexOf(o);k>-1&&(y=y.slice(0,k))}return y+s}function Od(t){return t=rt(t),t&&Hu.test(t)?t.replace(ks,ff):t}var Dd=ge(function(t,n,e){return t+(e?" ":"")+n.toUpperCase()}),as=ao("toUpperCase");function su(t,n,e){return t=rt(t),n=e?r:n,n===r?sf(t)?pf(t):Yl(t):t.match(n)||[]}var au=Q(function(t,n){try{return Zt(t,r,n)}catch(e){return es(e)?e:new H(e)}}),Nd=Fn(function(t,n){return rn(n,function(e){e=bn(e),Pn(t,e,ts(t[e],t))}),t});function Wd(t){var n=t==null?0:t.length,e=W();return t=n?gt(t,function(s){if(typeof s[1]!="function")throw new sn(d);return[e(s[0]),s[1]]}):[],Q(function(s){for(var o=-1;++o<n;){var l=t[o];if(Zt(l[0],this,s))return Zt(l[1],this,s)}})}function Bd(t){return fc(on(t,v))}function os(t){return function(){return t}}function Ud(t,n){return t==null||t!==t?n:t}var $d=uo(),qd=uo(!0);function Gt(t){return t}function us(t){return Wa(typeof t=="function"?t:on(t,v))}function zd(t){return Ua(on(t,v))}function Gd(t,n){return $a(t,on(n,v))}var Hd=Q(function(t,n){return function(e){return Re(e,t,n)}}),Kd=Q(function(t,n){return function(e){return Re(t,e,n)}});function ls(t,n,e){var s=At(n),o=pr(n,s);e==null&&!(dt(n)&&(o.length||!s.length))&&(e=n,n=t,t=this,o=pr(n,At(n)));var l=!(dt(e)&&"chain"in e)||!!e.chain,h=Rn(t);return rn(o,function(g){var y=n[g];t[g]=y,h&&(t.prototype[g]=function(){var x=this.__chain__;if(l||x){var A=t(this.__wrapped__),P=A.__actions__=$t(this.__actions__);return P.push({func:y,args:arguments,thisArg:t}),A.__chain__=x,A}return y.apply(t,Wn([this.value()],arguments))})}),t}function Zd(){return It._===this&&(It._=yf),this}function fs(){}function Jd(t){return t=Y(t),Q(function(n){return qa(n,t)})}var Yd=$i(gt),Xd=$i(la),Qd=$i(hi);function ou(t){return Ji(t)?pi(bn(t)):Ic(t)}function Vd(t){return function(n){return t==null?r:jn(t,n)}}var jd=fo(),t0=fo(!0);function cs(){return[]}function hs(){return!1}function n0(){return{}}function e0(){return""}function r0(){return!0}function i0(t,n){if(t=Y(t),t<1||t>mn)return[];var e=L,s=Tt(t,L);n=W(n),t-=L;for(var o=_i(s,n);++e<t;)n(e);return o}function s0(t){return K(t)?gt(t,bn):Xt(t)?[t]:$t(Io(rt(t)))}function a0(t){var n=++vf;return rt(t)+n}var o0=yr(function(t,n){return t+n},0),u0=qi("ceil"),l0=yr(function(t,n){return t/n},1),f0=qi("floor");function c0(t){return t&&t.length?hr(t,Gt,Ii):r}function h0(t,n){return t&&t.length?hr(t,W(n,2),Ii):r}function p0(t){return ha(t,Gt)}function g0(t,n){return ha(t,W(n,2))}function d0(t){return t&&t.length?hr(t,Gt,Ei):r}function _0(t,n){return t&&t.length?hr(t,W(n,2),Ei):r}var v0=yr(function(t,n){return t*n},1),m0=qi("round"),y0=yr(function(t,n){return t-n},0);function w0(t){return t&&t.length?di(t,Gt):0}function M0(t,n){return t&&t.length?di(t,W(n,2)):0}return u.after=zp,u.ary=Wo,u.assign=Fg,u.assignIn=Vo,u.assignInWith=Rr,u.assignWith=Eg,u.at=Rg,u.before=Bo,u.bind=ts,u.bindAll=Nd,u.bindKey=Uo,u.castArray=ng,u.chain=Oo,u.chunk=fh,u.compact=ch,u.concat=hh,u.cond=Wd,u.conforms=Bd,u.constant=os,u.countBy=wp,u.create=kg,u.curry=$o,u.curryRight=qo,u.debounce=zo,u.defaults=Lg,u.defaultsDeep=Og,u.defer=Gp,u.delay=Hp,u.difference=ph,u.differenceBy=gh,u.differenceWith=dh,u.drop=_h,u.dropRight=vh,u.dropRightWhile=mh,u.dropWhile=yh,u.fill=wh,u.filter=Cp,u.flatMap=xp,u.flatMapDeep=Ap,u.flatMapDepth=Ip,u.flatten=Eo,u.flattenDeep=Mh,u.flattenDepth=Ch,u.flip=Kp,u.flow=$d,u.flowRight=qd,u.fromPairs=bh,u.functions=qg,u.functionsIn=zg,u.groupBy=Pp,u.initial=xh,u.intersection=Ah,u.intersectionBy=Ih,u.intersectionWith=Ph,u.invert=Hg,u.invertBy=Kg,u.invokeMap=Fp,u.iteratee=us,u.keyBy=Ep,u.keys=At,u.keysIn=zt,u.map=Ar,u.mapKeys=Jg,u.mapValues=Yg,u.matches=zd,u.matchesProperty=Gd,u.memoize=Pr,u.merge=Xg,u.mergeWith=jo,u.method=Hd,u.methodOf=Kd,u.mixin=ls,u.negate=Tr,u.nthArg=Jd,u.omit=Qg,u.omitBy=Vg,u.once=Zp,u.orderBy=Rp,u.over=Yd,u.overArgs=Jp,u.overEvery=Xd,u.overSome=Qd,u.partial=ns,u.partialRight=Go,u.partition=kp,u.pick=jg,u.pickBy=tu,u.property=ou,u.propertyOf=Vd,u.pull=Rh,u.pullAll=ko,u.pullAllBy=kh,u.pullAllWith=Lh,u.pullAt=Oh,u.range=jd,u.rangeRight=t0,u.rearg=Yp,u.reject=Dp,u.remove=Dh,u.rest=Xp,u.reverse=Vi,u.sampleSize=Wp,u.set=nd,u.setWith=ed,u.shuffle=Bp,u.slice=Nh,u.sortBy=qp,u.sortedUniq=Gh,u.sortedUniqBy=Hh,u.split=xd,u.spread=Qp,u.tail=Kh,u.take=Zh,u.takeRight=Jh,u.takeRightWhile=Yh,u.takeWhile=Xh,u.tap=cp,u.throttle=Vp,u.thru=xr,u.toArray=Yo,u.toPairs=nu,u.toPairsIn=eu,u.toPath=s0,u.toPlainObject=Qo,u.transform=rd,u.unary=jp,u.union=Qh,u.unionBy=Vh,u.unionWith=jh,u.uniq=tp,u.uniqBy=np,u.uniqWith=ep,u.unset=id,u.unzip=ji,u.unzipWith=Lo,u.update=sd,u.updateWith=ad,u.values=ve,u.valuesIn=od,u.without=rp,u.words=su,u.wrap=tg,u.xor=ip,u.xorBy=sp,u.xorWith=ap,u.zip=op,u.zipObject=up,u.zipObjectDeep=lp,u.zipWith=fp,u.entries=nu,u.entriesIn=eu,u.extend=Vo,u.extendWith=Rr,ls(u,u),u.add=o0,u.attempt=au,u.camelCase=cd,u.capitalize=ru,u.ceil=u0,u.clamp=ud,u.clone=eg,u.cloneDeep=ig,u.cloneDeepWith=sg,u.cloneWith=rg,u.conformsTo=ag,u.deburr=iu,u.defaultTo=Ud,u.divide=l0,u.endsWith=hd,u.eq=gn,u.escape=pd,u.escapeRegExp=gd,u.every=Mp,u.find=bp,u.findIndex=To,u.findKey=Dg,u.findLast=Sp,u.findLastIndex=Fo,u.findLastKey=Ng,u.floor=f0,u.forEach=Do,u.forEachRight=No,u.forIn=Wg,u.forInRight=Bg,u.forOwn=Ug,u.forOwnRight=$g,u.get=is,u.gt=og,u.gte=ug,u.has=Gg,u.hasIn=ss,u.head=Ro,u.identity=Gt,u.includes=Tp,u.indexOf=Sh,u.inRange=ld,u.invoke=Zg,u.isArguments=ee,u.isArray=K,u.isArrayBuffer=lg,u.isArrayLike=qt,u.isArrayLikeObject=yt,u.isBoolean=fg,u.isBuffer=Hn,u.isDate=cg,u.isElement=hg,u.isEmpty=pg,u.isEqual=gg,u.isEqualWith=dg,u.isError=es,u.isFinite=_g,u.isFunction=Rn,u.isInteger=Ho,u.isLength=Fr,u.isMap=Ko,u.isMatch=vg,u.isMatchWith=mg,u.isNaN=yg,u.isNative=wg,u.isNil=Cg,u.isNull=Mg,u.isNumber=Zo,u.isObject=dt,u.isObjectLike=mt,u.isPlainObject=We,u.isRegExp=rs,u.isSafeInteger=bg,u.isSet=Jo,u.isString=Er,u.isSymbol=Xt,u.isTypedArray=_e,u.isUndefined=Sg,u.isWeakMap=xg,u.isWeakSet=Ag,u.join=Th,u.kebabCase=dd,u.last=ln,u.lastIndexOf=Fh,u.lowerCase=_d,u.lowerFirst=vd,u.lt=Ig,u.lte=Pg,u.max=c0,u.maxBy=h0,u.mean=p0,u.meanBy=g0,u.min=d0,u.minBy=_0,u.stubArray=cs,u.stubFalse=hs,u.stubObject=n0,u.stubString=e0,u.stubTrue=r0,u.multiply=v0,u.nth=Eh,u.noConflict=Zd,u.noop=fs,u.now=Ir,u.pad=md,u.padEnd=yd,u.padStart=wd,u.parseInt=Md,u.random=fd,u.reduce=Lp,u.reduceRight=Op,u.repeat=Cd,u.replace=bd,u.result=td,u.round=m0,u.runInContext=_,u.sample=Np,u.size=Up,u.snakeCase=Sd,u.some=$p,u.sortedIndex=Wh,u.sortedIndexBy=Bh,u.sortedIndexOf=Uh,u.sortedLastIndex=$h,u.sortedLastIndexBy=qh,u.sortedLastIndexOf=zh,u.startCase=Ad,u.startsWith=Id,u.subtract=y0,u.sum=w0,u.sumBy=M0,u.template=Pd,u.times=i0,u.toFinite=kn,u.toInteger=Y,u.toLength=Xo,u.toLower=Td,u.toNumber=fn,u.toSafeInteger=Tg,u.toString=rt,u.toUpper=Fd,u.trim=Ed,u.trimEnd=Rd,u.trimStart=kd,u.truncate=Ld,u.unescape=Od,u.uniqueId=a0,u.upperCase=Dd,u.upperFirst=as,u.each=Do,u.eachRight=No,u.first=Ro,ls(u,function(){var t={};return Mn(u,function(n,e){st.call(u.prototype,e)||(t[e]=n)}),t}(),{chain:!1}),u.VERSION=a,rn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){u[t].placeholder=u}),rn(["drop","take"],function(t,n){j.prototype[t]=function(e){e=e===r?1:xt(Y(e),0);var s=this.__filtered__&&!n?new j(this):this.clone();return s.__filtered__?s.__takeCount__=Tt(e,s.__takeCount__):s.__views__.push({size:Tt(e,L),type:t+(s.__dir__<0?"Right":"")}),s},j.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),rn(["filter","map","takeWhile"],function(t,n){var e=n+1,s=e==Me||e==Hr;j.prototype[t]=function(o){var l=this.clone();return l.__iteratees__.push({iteratee:W(o,3),type:e}),l.__filtered__=l.__filtered__||s,l}}),rn(["head","last"],function(t,n){var e="take"+(n?"Right":"");j.prototype[t]=function(){return this[e](1).value()[0]}}),rn(["initial","tail"],function(t,n){var e="drop"+(n?"":"Right");j.prototype[t]=function(){return this.__filtered__?new j(this):this[e](1)}}),j.prototype.compact=function(){return this.filter(Gt)},j.prototype.find=function(t){return this.filter(t).head()},j.prototype.findLast=function(t){return this.reverse().find(t)},j.prototype.invokeMap=Q(function(t,n){return typeof t=="function"?new j(this):this.map(function(e){return Re(e,t,n)})}),j.prototype.reject=function(t){return this.filter(Tr(W(t)))},j.prototype.slice=function(t,n){t=Y(t);var e=this;return e.__filtered__&&(t>0||n<0)?new j(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==r&&(n=Y(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},j.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},j.prototype.toArray=function(){return this.take(L)},Mn(j.prototype,function(t,n){var e=/^(?:filter|find|map|reject)|While$/.test(n),s=/^(?:head|last)$/.test(n),o=u[s?"take"+(n=="last"?"Right":""):n],l=s||/^find/.test(n);o&&(u.prototype[n]=function(){var h=this.__wrapped__,g=s?[1]:arguments,y=h instanceof j,x=g[0],A=y||K(h),P=function(V){var tt=o.apply(u,Wn([V],g));return s&&k?tt[0]:tt};A&&e&&typeof x=="function"&&x.length!=1&&(y=A=!1);var k=this.__chain__,D=!!this.__actions__.length,B=l&&!k,X=y&&!D;if(!l&&A){h=X?h:new j(this);var U=t.apply(h,g);return U.__actions__.push({func:xr,args:[P],thisArg:r}),new an(U,k)}return B&&X?t.apply(this,g):(U=this.thru(P),B?s?U.value()[0]:U.value():U)})}),rn(["pop","push","shift","sort","splice","unshift"],function(t){var n=Qe[t],e=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",s=/^(?:pop|shift)$/.test(t);u.prototype[t]=function(){var o=arguments;if(s&&!this.__chain__){var l=this.value();return n.apply(K(l)?l:[],o)}return this[e](function(h){return n.apply(K(h)?h:[],o)})}}),Mn(j.prototype,function(t,n){var e=u[n];if(e){var s=e.name+"";st.call(ce,s)||(ce[s]=[]),ce[s].push({name:n,func:e})}}),ce[mr(r,q).name]=[{name:"wrapper",func:r}],j.prototype.clone=Of,j.prototype.reverse=Df,j.prototype.value=Nf,u.prototype.at=hp,u.prototype.chain=pp,u.prototype.commit=gp,u.prototype.next=dp,u.prototype.plant=vp,u.prototype.reverse=mp,u.prototype.toJSON=u.prototype.valueOf=u.prototype.value=yp,u.prototype.first=u.prototype.head,xe&&(u.prototype[xe]=_p),u},ue=gf();Jn?((Jn.exports=ue)._=ue,ui._=ue):It._=ue}).call(S0)}(Be,Be.exports)),Be.exports}var wu=x0();const z=yu(wu);var Lr={exports:{}},ps,fu;function A0(){if(fu)return ps;fu=1;var c=1e3,i=c*60,r=i*60,a=r*24,f=a*7,p=a*365.25;ps=function(I,v){v=v||{};var F=typeof I;if(F==="string"&&I.length>0)return d(I);if(F==="number"&&isFinite(I))return v.long?w(I):m(I);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(I))};function d(I){if(I=String(I),!(I.length>100)){var v=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(I);if(v){var F=parseFloat(v[1]),R=(v[2]||"ms").toLowerCase();switch(R){case"years":case"year":case"yrs":case"yr":case"y":return F*p;case"weeks":case"week":case"w":return F*f;case"days":case"day":case"d":return F*a;case"hours":case"hour":case"hrs":case"hr":case"h":return F*r;case"minutes":case"minute":case"mins":case"min":case"m":return F*i;case"seconds":case"second":case"secs":case"sec":case"s":return F*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return F;default:return}}}}function m(I){var v=Math.abs(I);return v>=a?Math.round(I/a)+"d":v>=r?Math.round(I/r)+"h":v>=i?Math.round(I/i)+"m":v>=c?Math.round(I/c)+"s":I+"ms"}function w(I){var v=Math.abs(I);return v>=a?C(I,v,a,"day"):v>=r?C(I,v,r,"hour"):v>=i?C(I,v,i,"minute"):v>=c?C(I,v,c,"second"):I+" ms"}function C(I,v,F,R){var E=v>=F*1.5;return Math.round(I/F)+" "+R+(E?"s":"")}return ps}var gs,cu;function I0(){if(cu)return gs;cu=1;function c(i){a.debug=a,a.default=a,a.coerce=C,a.disable=m,a.enable=p,a.enabled=w,a.humanize=A0(),a.destroy=I,Object.keys(i).forEach(v=>{a[v]=i[v]}),a.names=[],a.skips=[],a.formatters={};function r(v){let F=0;for(let R=0;R<v.length;R++)F=(F<<5)-F+v.charCodeAt(R),F|=0;return a.colors[Math.abs(F)%a.colors.length]}a.selectColor=r;function a(v){let F,R=null,E,T;function N(...q){if(!N.enabled)return;const Z=N,J=Number(new Date),it=J-(F||J);Z.diff=it,Z.prev=F,Z.curr=J,F=J,q[0]=a.coerce(q[0]),typeof q[0]!="string"&&q.unshift("%O");let _t=0;q[0]=q[0].replace(/%([a-zA-Z%])/g,(bt,tn)=>{if(bt==="%%")return"%";_t++;const Ht=a.formatters[tn];if(typeof Ht=="function"){const Et=q[_t];bt=Ht.call(Z,Et),q.splice(_t,1),_t--}return bt}),a.formatArgs.call(Z,q),(Z.log||a.log).apply(Z,q)}return N.namespace=v,N.useColors=a.useColors(),N.color=a.selectColor(v),N.extend=f,N.destroy=a.destroy,Object.defineProperty(N,"enabled",{enumerable:!0,configurable:!1,get:()=>R!==null?R:(E!==a.namespaces&&(E=a.namespaces,T=a.enabled(v)),T),set:q=>{R=q}}),typeof a.init=="function"&&a.init(N),N}function f(v,F){const R=a(this.namespace+(typeof F>"u"?":":F)+v);return R.log=this.log,R}function p(v){a.save(v),a.namespaces=v,a.names=[],a.skips=[];const F=(typeof v=="string"?v:"").trim().replace(" ",",").split(",").filter(Boolean);for(const R of F)R[0]==="-"?a.skips.push(R.slice(1)):a.names.push(R)}function d(v,F){let R=0,E=0,T=-1,N=0;for(;R<v.length;)if(E<F.length&&(F[E]===v[R]||F[E]==="*"))F[E]==="*"?(T=E,N=R,E++):(R++,E++);else if(T!==-1)E=T+1,N++,R=N;else return!1;for(;E<F.length&&F[E]==="*";)E++;return E===F.length}function m(){const v=[...a.names,...a.skips.map(F=>"-"+F)].join(",");return a.enable(""),v}function w(v){for(const F of a.skips)if(d(v,F))return!1;for(const F of a.names)if(d(v,F))return!0;return!1}function C(v){return v instanceof Error?v.stack||v.message:v}function I(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return a.enable(a.load()),a}return gs=c,gs}var hu;function P0(){return hu||(hu=1,function(c,i){i.formatArgs=a,i.save=f,i.load=p,i.useColors=r,i.storage=d(),i.destroy=(()=>{let w=!1;return()=>{w||(w=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let w;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(w=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(w[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(w){if(w[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+w[0]+(this.useColors?"%c ":" ")+"+"+c.exports.humanize(this.diff),!this.useColors)return;const C="color: "+this.color;w.splice(1,0,C,"color: inherit");let I=0,v=0;w[0].replace(/%[a-zA-Z%]/g,F=>{F!=="%%"&&(I++,F==="%c"&&(v=I))}),w.splice(v,0,C)}i.log=console.debug||console.log||(()=>{});function f(w){try{w?i.storage.setItem("debug",w):i.storage.removeItem("debug")}catch{}}function p(){let w;try{w=i.storage.getItem("debug")}catch{}return!w&&typeof process<"u"&&"env"in process&&(w=process.env.DEBUG),w}function d(){try{return localStorage}catch{}}c.exports=I0()(i);const{formatters:m}=c.exports;m.j=function(w){try{return JSON.stringify(w)}catch(C){return"[UnexpectedJSONParseError]: "+C.message}}}(Lr,Lr.exports)),Lr.exports}var T0=P0();const F0=yu(T0),ds={};function Zn(c){if(!ds[c]){const i=F0("ultraPacer:core");i(`loading debug for namespace "${c}"`),ds[c]=i.extend(c)}return ds[c]}function Nt(c,i=0){return Math.round(c*10**i)/10**i}function me(c,i,r,a,f){return r+(f-c)/(i-c)*(a-r)}function Mu(c,i,r){let a=0,f=0;const p=[];for(a=0;a<r.length;a++)if(r[a]<c[f])p.push(i[f]);else{for(;f<c.length-1&&c[f+1]<=r[a];)f++;f===c.length-1||r[a]===c[f]?p.push(i[f]):p.push(me(c[f],c[f+1],i[f],i[f+1],r[a]))}return p}function Cu(c){let i,r,a,f,p=0,d=0,m=0,w=0,C=0;for(i=0;i<c.length;i++)r=c[i][0],a=c[i][1],f=c[i][2],C+=f,p+=f*r,m+=f*(r*r),d+=f*a,w+=f*(r*a);const I=(d*m-p*w)/(C*m-p*p);return[(C*w-p*d)/(C*m-p*p),I]}function bu(c,i,r,a){let f=0,p=0;const d=[];return r.forEach(m=>{for(;c[f]<m-a;)f++;for(f>0&&c[f]>=m&&f--;p<c.length-1&&c[p+1]<=m+a;)p++;p<c.length-1&&c[p]<=m&&p++;const w=Math.max(a,Math.abs(m-c[f])+.001,Math.abs(m-c[p])+.001),C=[];let I=0;for(let v=f;v<=p;v++)I=(1-(Math.abs(m-c[v])/w)**3)**3,C.push([c[v],i[v],I]);d.push(Cu(C))}),d}function Is(c,i,r){return Nt(c,r)<Nt(i,r)}function E0(c,i,r){return Nt(c,r)>Nt(i,r)}function ye(c,i,r){return Nt(c,r)<=Nt(i,r)}function qr(c,i,r){return Nt(c,r)>=Nt(i,r)}function Ue(c,i,r){return Nt(c,r)===Nt(i,r)}const R0=Object.freeze(Object.defineProperty({__proto__:null,interp:me,interpArray:Mu,linearRegression:Cu,req:Ue,rgt:E0,rgte:qr,rlt:Is,rlte:ye,round:Nt,wlslr:bu},Symbol.toStringTag,{value:"Module"}));class vn{constructor(i){M(this,"_altitude",1);M(this,"_grade",1);M(this,"_terrain",1);M(this,"_heat",1);M(this,"_dark",1);M(this,"_fatigue",1);M(this,"_strategy",1);M(this,"_combined");Object.assign(this,i)}init(i){return this._altitude=i,this._grade=i,this._terrain=i,this._heat=i,this._dark=i,this._fatigue=i,this._strategy=i,this}get altitude(){return this._altitude}set altitude(i){this._altitude=i,delete this._combined}get grade(){return this._grade}set grade(i){this._grade=i,delete this._combined}get terrain(){return this._terrain}set terrain(i){this._terrain=i,delete this._combined}get heat(){return this._heat}set heat(i){this._heat=i,delete this._combined}get dark(){return this._dark}set dark(i){this._dark=i,delete this._combined}get fatigue(){return this._fatigue}set fatigue(i){this._fatigue=i,delete this._combined}get strategy(){return this._strategy}set strategy(i){this._strategy=i,delete this._combined}get combined(){return this._combined===void 0&&(this._combined=this._altitude*this._grade*this._terrain*this._heat*this._dark*this._fatigue*this._strategy),this._combined}get(i){switch(i){case"altitude":return this.altitude;case"grade":return this.grade;case"terrain":return this.terrain;case"heat":return this.heat;case"dark":return this.dark;case"fatigue":return this.fatigue;case"strategy":return this.strategy;default:throw new Error(`${i} is not a valid factor`)}}applyEach(i,r){this._altitude=i(this._altitude,r.altitude),this._grade=i(this._grade,r.grade),this._terrain=i(this._terrain,r.terrain),this._heat=i(this._heat,r.heat),this._dark=i(this._dark,r.dark),this._fatigue=i(this._fatigue,r.fatigue),this._strategy=i(this._strategy,r.strategy)}scaleEach(i){return this._altitude*=i,this._grade*=i,this._terrain*=i,this._heat*=i,this._dark*=i,this._fatigue*=i,this._strategy*=i,delete this._combined,this}}class Ms{constructor(i,r,a){M(this,"factors",new vn);M(this,"point");M(this,"course");M(this,"loop");Object.defineProperty(this,"course",{writable:!0}),this.point=r,this.course=i,this.loop=a}get lat(){return this.point.lat}get lon(){return this.point.lon}get alt(){return this.point.alt}get latlon(){return this.point.latlon}get grade(){return this.point.grade*(this.point.grade>0?this.course.gainScale:this.course.lossScale)}get loc(){let i=this.point.loc*this.course.distScale;return this.loop&&(i+=this.course.loopDist*this.loop),i}}const k0={rate:6,span:1e3,th:750};function Su(c,i){(i===null||typeof i>"u")&&(i=k0);let r=0;return Array.isArray(c)?r=(c[0]+c[1])/2:r=c,r<=i.th?1:(1+i.rate/i.span/100)**(r-i.th)}const pu={baseline:0,terrainScale:1};function xu(c,i){function r(a){return a<c.noon?a+86400:a}return i>=c.sunrise&&i<=c.sunset?0:!isNaN(c.dawn)&&!isNaN(c.dusk)&&(i<=c.dawn||i>=c.dusk)?1:r(i)>=r(c.nadir)?me(r(isNaN(c.dawn)?c.nadir:c.dawn),r(c.sunrise),1,0,r(i)):me(r(c.sunset),r(isNaN(c.dusk)?c.nadir:c.dusk),0,1,r(i))}function Au(c,i,r,a=pu){if(i===1||c>=r.sunrise&&c<=r.sunset)return 1;(a===null||typeof a>"u")&&(a=pu);const f=r.nadirAltitude<-6?1:-(r.nadirAltitude/6),p=(a.terrainScale*(i-1)+a.baseline)*f,d=xu(r,c);return 1+p*d}const L0={a:.0021,b:.034,lower:{lim:-22,m:-.0584,b:-.0164},upper:{lim:16,m:.1012,b:.4624}};function Iu(c,i){return(i===null||typeof i>"u")&&(i=L0),c<i.lower.lim?i.lower.m*c+i.lower.b:c>i.upper.lim?i.upper.m*c+i.upper.b:i.a*c**2+i.b*c+1}function Pu(c,i){if(!i)return 1;const r=c.tod;let a=1;if(r>i.start&&r<i.stop){const f=(r-i.start)/(i.stop-i.start)*Math.PI;a+=(i.max-i.baseline)*Math.sin(f)/100}return a+=i.baseline/100,a}function Tu(c,i){const r=z.findLast(i.terrainFactors,a=>ye(a.start,c.loc,4));return r?r.value/100+1:1}const Fu=["altitude","grade","terrain","heat","dark","fatigue","strategy"];function Ps(c){const i=new vn().init(0);return c.forEach(({factors:r,dist:a})=>{i.applyEach((f,p)=>f+a*p,r)}),i.scaleEach(1/wu.sumBy(c,"dist")),i}function Eu(c,i){let r=0,a=0;return c.forEach((f,p)=>{const d=p===c.length-1?i:c[p+1].onset,m=f.type==="linear"?f.value/2:f.value;a+=(r+m)*(d-f.onset),r+=f.value}),a/i}function O0(c){return c<30?2:c<60?5:c<90?10:c<120?15:20}function D0(c,i,r){let a=-Eu(i,r);return i.forEach((f,p)=>{if(c>=f.onset){if(f.type==="step")a+=f.value;else if(f.type==="linear"){const d=p===i.length-1?r:i[p+1].onset;c>d?a+=f.value:a+=f.value*(c-f.onset)/(d-f.onset)}}}),a}class Br{constructor(i,r){M(this,"plan");M(this,"values");this.plan=i,this.values=r?z.cloneDeep(r):[{onset:0,value:O0(this.plan.course.dist),type:"linear"}]}at(i){return 1+D0(i,this.values,this.plan.course.dist)/100}addValue(i){const r=this.values.findIndex(a=>a.onset>=i.onset);r>=0?this.values.splice(r,0,i):this.values.push(i)}}function Cs(c,i){return i===void 0?c:(c-1)*i+1}function Ts(c,i){c.factors||(c.factors=new vn),Object.assign(c.factors,{grade:Iu(c.grade),altitude:Su(c.alt),terrain:Tu(c,i)})}function Ur(c,i){var r,a;if(c.factors||(c.factors=new vn),Ts(c,i.course),i){if(c.factors===void 0)throw new Error("no factors");c.factors.strategy=i.strategy.at(c.loc),Object.assign(c.factors,{heat:i.heatModel?Pu(c,i.heatModel):1,dark:i.event.sun?Au(c.tod,c.factors.terrain,i.event.sun):1})}c.factors.altitude=Cs(c.factors.altitude,(r=i.scales)==null?void 0:r.altitude),c.factors.dark=Cs(c.factors.dark,(a=i.scales)==null?void 0:a.dark)}const N0=Object.freeze(Object.defineProperty({__proto__:null,Factors:vn,Strategy:Br,applyScale:Cs,generateCourseFactors:Ts,generatePlanFactors:Ur,getAltitudeFactor:Su,getDarkFactor:Au,getGradeFactor:Iu,getHeatFactor:Pu,getTerrainFactor:Tu,list:Fu,rollup:Ps},Symbol.toStringTag,{value:"Module"}));function Ru(c){switch(c){case"kilometers":return 1;case"miles":return .621371;default:throw new Error("Invalid distance unit")}}function Or(c){return typeof c=="number"&&!isNaN(c)}function W0(c,i,r){const a=c.filter((p,d)=>d>=c.findIndex(m=>m===i)&&d<=c.findIndex(m=>m===r)),f=a.map((p,d)=>({factors:p.factors,dist:d===a.length-1?0:a[d+1].loc-a[d].loc}));return f.pop(),Ps(f)}class ku{constructor(i){M(this,"point1");M(this,"point2");M(this,"gain");M(this,"loss");M(this,"grade");M(this,"waypoint");M(this,"_name");this.point1=i.point1,this.point2=i.point2,this.gain=i.gain,this.loss=i.loss,this.grade=i.grade,i.name&&(this._name=i.name)}get name(){var i;return this._name||((i=this.waypoint)==null?void 0:i.name)||void 0}get start(){return this.point1.loc}get dist(){return this.point2.loc-this.point1.loc}get end(){return this.point2.loc}get alt(){return this.point2.alt}}class Lu extends ku{constructor(r,a){super(a);M(this,"_course");M(this,"point1");M(this,"point2");this._course=r,this.point1=a.point1,this.point2=a.point2}}class Ou extends ku{constructor(r,a){super(a);M(this,"_plan");M(this,"point1");M(this,"point2");M(this,"_factors");this._plan=r,this.point1=a.point1,this.point2=a.point2}get pace(){return this.time?this.time/this.dist:0}get delay(){if(!(!Or(this.point1.elapsed)||!Or(this.point2.elapsed)||!Or(this.point1.time)||!Or(this.point2.time)))return this.point2.elapsed-this.point1.elapsed-(this.point2.time-this.point1.time)}get elapsed(){return this.point2.elapsed}get time(){if(!(!z.isNumber(this.point1.time)||!z.isNumber(this.point2.time)))return this.point2.time-this.point1.time}get tod(){return this.point2.tod}set delay(r){}set pace(r){}set elapsed(r){}set time(r){}set tod(r){}get factors(){return this._factors||(this._factors=W0(this._plan.points,this.point1,this.point2))}}const _s=Zn("CourseSplits");class B0{constructor(i){M(this,"_segments");M(this,"_miles");M(this,"_kilometers");M(this,"course");this.course=i}get segments(){return this._segments||(this._segments=this.createSegments()),this._segments}set segments(i){this._segments=i}get miles(){var i;return(i=this._miles)!=null&&i.length||(this._miles=this.createSplits("miles")),this._miles}set miles(i){this._miles=i}get kilometers(){var i;return(i=this._kilometers)!=null&&i.length||(this._kilometers=this.createSplits("kilometers")),this._kilometers}set kilometers(i){this._kilometers=i}createSegments(){_s("createSegments");const i=this.course.waypoints.filter(a=>a.tier<3).sort((a,f)=>a.loc-f.loc),r=this.calcSegments(this.course.locationsToBreaks(i.map(a=>a.loc)));if(!r.length)throw new Error("createSegments result is empty");return r.forEach((a,f)=>{a.waypoint=i[f+1]}),r}createSplits(i){_s(`createSplits:${i}`);const r=Ru(i),a=z.range(this.course.dist*r).map(p=>p/r);this.course.dist-a[a.length-1]>1e-4&&a.push(this.course.dist);const f=this.calcSegments(this.course.locationsToBreaks(a));if(!f.length)throw new Error("createSplits result is empty");return f}calcSegments(i){var F;_s.extend("calcSegments")("exec");const a=this.course,f=a.points,p=[],d=[];let m,w,C=a.points[0],I;for(m=0,w=i.length;m<w;m++){const R=i[m];I&&Ue((F=i[m-1])==null?void 0:F.end,R.start,4)?C=I:C=a.getPoint(R.start),I=a.getPoint(R.end);const E=R.end-R.start,T=new Lu(this.course,{gain:0,loss:0,grade:E>0?(I.alt-C.alt)/E/10*(I.alt-C.alt>0?a.gainScale:a.lossScale):0,point1:C,point2:I}),N=new vn().init(0);p.push(T),d.push(N)}const v=(R,E,T,N)=>{const q=T.alt-E.alt;R[q>0?"gain":"loss"]+=q*(q>0?a.gainScale:a.lossScale),Ts(E,a);const Z=T.loc-E.loc;N.applyEach((J,it)=>J+it*Z,E.factors)};m=1;for(let R=0;R<p.length;R++){const E=p[R],T=d[R];for(;ye(f[m].loc,E.point1.loc,4);)m++;let N=E.point1;for(;m<f.length&&ye(f[m].loc,E.point2.loc,4);){const q=f[m];v(E,N,q,T),N=q,m++}v(E,N,E.point2,T)}return p}}var vs={},gu;function U0(){return gu||(gu=1,function(c){c.parseDMS=function(r){if(typeof f=="object")throw new TypeError("geo.parseDMS - dmsStr is [DOM?] object");if(typeof r=="number"&&isFinite(r))return Number(r);var a=String(r).trim().replace(/^-/,"").replace(/[NSEW]$/i,"").split(/[^0-9.,]+/);if(a[a.length-1]==""&&a.splice(a.length-1),a=="")return NaN;switch(a.length){case 3:var f=a[0]/1+a[1]/60+a[2]/3600;break;case 2:var f=a[0]/1+a[1]/60;break;case 1:var f=a[0];break;default:return NaN}return/^-|[WS]$/i.test(r.trim())&&(f=-f),Number(f)},c.toDMS=function(r,a,f){if(typeof r=="object")throw new TypeError("geo.toDMS - deg is [DOM?] object");if(isNaN(r))return null;if(typeof a>"u"&&(a="dms"),typeof f>"u")switch(a){case"d":f=4;break;case"dm":f=2;break;case"dms":f=0;break;default:a="dms",f=0}switch(r=Math.abs(r),a){case"d":m=r.toFixed(f),m<100&&(m="0"+m),m<10&&(m="0"+m),dms=m+"°";break;case"dm":var p=(r*60).toFixed(f),m=Math.floor(p/60),w=(p%60).toFixed(f);m<100&&(m="0"+m),m<10&&(m="0"+m),w<10&&(w="0"+w),dms=m+"°"+w+"′";break;case"dms":var d=(r*3600).toFixed(f),m=Math.floor(d/3600),w=Math.floor(d/60)%60,C=(d%60).toFixed(f);m<100&&(m="0"+m),m<10&&(m="0"+m),w<10&&(w="0"+w),C<10&&(C="0"+C),dms=m+"°"+w+"′"+C+"″";break}return dms},c.toLat=function(r,a,f){var p=c.toDMS(r,a,f);return p==null?".":p.slice(1)+(r<0?"S":"N")},c.toLon=function(r,a,f){var p=c.toDMS(r,a,f);return p==null?".":p+(r<0?"W":"E")},c.toBrng=function(r,a,f){r=(Number(r)+360)%360;var p=c.toDMS(r,a,f);return p==null?".":p.replace("360","0")};var i=6371;c.latlon=function(r,a){this.lat=typeof r=="number"?r:typeof r=="string"&&r.trim()!=""?+r:NaN,this.lng=typeof a=="number"?a:typeof a=="string"&&a.trim()!=""?+a:NaN},c.latlon.prototype.distanceTo=function(r,a){typeof a>"u"&&(a=4);var f=this.distanceRadTo(r),p=i*f;return p.toPrecisionFixed(a)},c.latlon.prototype.distanceRadTo=function(r){var a=this.lat.toRad(),f=this.lng.toRad(),p=r.lat.toRad(),d=r.lng.toRad(),m=p-a,w=d-f,C=Math.sin(m/2)*Math.sin(m/2)+Math.cos(a)*Math.cos(p)*Math.sin(w/2)*Math.sin(w/2),I=2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C));return I},c.latlon.prototype.bearingTo=function(r){var a=this.bearingRadTo(r);return(a.toDeg()+360)%360},c.latlon.prototype.bearingRadTo=function(r){var a=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),d=Math.cos(a)*Math.sin(f)-Math.sin(a)*Math.cos(f)*Math.cos(p),m=Math.cos(f)*Math.sin(p),w=Math.atan2(m,d);return w},c.latlon.prototype.finalBearingTo=function(r){var a=r.lat.toRad(),f=this.lat.toRad(),p=(this.lng-r.lng).toRad(),d=Math.sin(p)*Math.cos(f),m=Math.cos(a)*Math.sin(f)-Math.sin(a)*Math.cos(f)*Math.cos(p),w=Math.atan2(d,m);return(w.toDeg()+180)%360},c.latlon.prototype.midpointTo=function(r){var a=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),d=Math.cos(f)*Math.cos(p),m=Math.cos(f)*Math.sin(p),w=this.lng.toRad(),C=Math.atan2(Math.sin(a)+Math.sin(f),Math.sqrt((Math.cos(a)+d)*(Math.cos(a)+d)+m*m)),I=w+Math.atan2(m,Math.cos(a)+d);return I=(I+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(C.toDeg(),I.toDeg())},c.midpoint=function(r){var a=0,f=0,p=0;for(var d in r){var m=r[d],w=m.lat*Math.PI/180,C=m.lng*Math.PI/180,I=Math.cos(w)*Math.cos(C),v=Math.cos(w)*Math.sin(C),F=Math.sin(w);a+=I,f+=v,p+=F}a=a/r.length,f=f/r.length,p=p/r.length;var R=Math.atan2(f,a),E=Math.sqrt(a*a+f*f),T=Math.atan2(p,E);return new c.latlon(T*180/Math.PI,R*180/Math.PI)},c.latlon.prototype.interpolate=function(r,a){var f=this.distanceRadTo(r),p=this.bearingRadTo(r),d=this.lat.toRad(),m=this.lng.toRad();r.lat.toRad(),r.lng.toRad();for(var w=Math.sin(d),C=Math.cos(d),I=[],v=0;v<a;v++){var F=1/(a-1)*v,R=f*F,E=Math.sin(R),T=Math.cos(R),N=Math.asin(w*T+C*E*Math.cos(p)),q=m+Math.atan2(Math.sin(p)*E*C,T-w*Math.sin(N)),Z=N.toDeg(),J=q.toDeg();for(Z>90&&(Z=90),Z<-90&&(Z=-90);J>180;)J-=360;for(;J<=-180;)J+=360;I.push(new c.latlon(Z,J))}return I},c.latlon.prototype.destinationPoint=function(r,a){a=typeof a=="number"?a:typeof a=="string"&&a.trim()!=""?+a:NaN,a=a/i,r=r.toRad();var f=this.lat.toRad(),p=this.lng.toRad(),d=Math.asin(Math.sin(f)*Math.cos(a)+Math.cos(f)*Math.sin(a)*Math.cos(r)),m=p+Math.atan2(Math.sin(r)*Math.sin(a)*Math.cos(f),Math.cos(a)-Math.sin(f)*Math.sin(d));return m=(m+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(d.toDeg(),m.toDeg())},c.latlon.intersection=function(r,a,f,p){a=typeof a=="number"?a:typeof a=="string"&&trim(a)!=""?+a:NaN,p=typeof p=="number"?p:typeof p=="string"&&trim(p)!=""?+p:NaN;var d=r.lat.toRad(),m=r.lng.toRad(),w=f.lat.toRad(),C=f.lng.toRad(),I=a.toRad(),v=p.toRad(),F=w-d,R=C-m,E=2*Math.asin(Math.sqrt(Math.sin(F/2)*Math.sin(F/2)+Math.cos(d)*Math.cos(w)*Math.sin(R/2)*Math.sin(R/2)));if(E==0)return null;var T=Math.acos((Math.sin(w)-Math.sin(d)*Math.cos(E))/(Math.sin(E)*Math.cos(d)));isNaN(T)&&(T=0);var N=Math.acos((Math.sin(d)-Math.sin(w)*Math.cos(E))/(Math.sin(E)*Math.cos(w)));if(Math.sin(C-m)>0)var q=T,Z=2*Math.PI-N;else q=2*Math.PI-T,Z=N;var J=(I-q+Math.PI)%(2*Math.PI)-Math.PI,it=(Z-v+Math.PI)%(2*Math.PI)-Math.PI;if(Math.sin(J)==0&&Math.sin(it)==0||Math.sin(J)*Math.sin(it)<0)return null;var _t=Math.acos(-Math.cos(J)*Math.cos(it)+Math.sin(J)*Math.sin(it)*Math.cos(E)),Wt=Math.atan2(Math.sin(E)*Math.sin(J)*Math.sin(it),Math.cos(it)+Math.cos(J)*Math.cos(_t)),bt=Math.asin(Math.sin(d)*Math.cos(Wt)+Math.cos(d)*Math.sin(Wt)*Math.cos(I)),tn=Math.atan2(Math.sin(I)*Math.sin(Wt)*Math.cos(d),Math.cos(Wt)-Math.sin(d)*Math.sin(bt)),Ht=m+tn;return Ht=(Ht+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(bt.toDeg(),Ht.toDeg())},c.latlon.prototype.rhumbDistanceTo=function(r){var a=i,f=this.lat.toRad(),p=r.lat.toRad(),d=(r.lat-this.lat).toRad(),m=Math.abs(r.lng-this.lng).toRad(),w=Math.log(Math.tan(p/2+Math.PI/4)/Math.tan(f/2+Math.PI/4)),C=isFinite(d/w)?d/w:Math.cos(f);Math.abs(m)>Math.PI&&(m=m>0?-(2*Math.PI-m):2*Math.PI+m);var I=Math.sqrt(d*d+C*C*m*m)*a;return I.toPrecisionFixed(4)},c.latlon.prototype.rhumbBearingTo=function(r){var a=this.lat.toRad(),f=r.lat.toRad(),p=(r.lng-this.lng).toRad(),d=Math.log(Math.tan(f/2+Math.PI/4)/Math.tan(a/2+Math.PI/4));Math.abs(p)>Math.PI&&(p=p>0?-(2*Math.PI-p):2*Math.PI+p);var m=Math.atan2(p,d);return(m.toDeg()+360)%360},c.latlon.prototype.rhumbDestinationPoint=function(r,a){var f=i,p=parseFloat(a)/f,d=this.lat.toRad(),m=this.lng.toRad();r=r.toRad();var w=p*Math.cos(r);Math.abs(w)<1e-10&&(w=0);var C=d+w,I=Math.log(Math.tan(C/2+Math.PI/4)/Math.tan(d/2+Math.PI/4)),v=isFinite(w/I)?w/I:Math.cos(d),F=p*Math.sin(r)/v;Math.abs(C)>Math.PI/2&&(C=C>0?Math.PI-C:-Math.PI-C);var R=(m+F+3*Math.PI)%(2*Math.PI)-Math.PI;return new c.latlon(C.toDeg(),R.toDeg())},c.latlon.prototype.rhumbMidpointTo=function(r){var a=this.lat.toRad(),f=this.lng.toRad(),p=r.lat.toRad(),d=r.lng.toRad();Math.abs(d-f)>Math.PI&&(f+=2*Math.PI);var m=(a+p)/2,w=Math.tan(Math.PI/4+a/2),C=Math.tan(Math.PI/4+p/2),I=Math.tan(Math.PI/4+m/2),v=((d-f)*Math.log(I)+f*Math.log(C)-d*Math.log(w))/Math.log(C/w);return isFinite(v)||(v=(f+d)/2),v=(v+3*Math.PI)%(2*Math.PI)-Math.PI,new c.latlon(m.toDeg(),v.toDeg())},c.latlon.prototype.lat=function(r,a){return typeof r>"u"?this.lat:c.toLat(this.lat,r,a)},c.latlon.prototype.lon=function(r,a){return typeof r>"u"?this.lng:c.toLon(this.lng,r,a)},c.latlon.prototype.toString=function(r,a){return typeof r>"u"&&(r="dms"),c.toLat(this.lat,r,a)+", "+c.toLon(this.lng,r,a)},typeof Number.prototype.toRad>"u"&&(Number.prototype.toRad=function(){return this*Math.PI/180}),typeof Number.prototype.toDeg>"u"&&(Number.prototype.toDeg=function(){return this*180/Math.PI}),typeof Number.prototype.toPrecisionFixed>"u"&&(Number.prototype.toPrecisionFixed=function(r){var a=this.toPrecision(r);return a=a.replace(/(.+)e\+(.+)/,function(f,p,d){p=p.replace(/\./,"");for(var m=p.length-1;d-- >m;)p=p+"0";return p}),a=a.replace(/(.+)e-(.+)/,function(f,p,d){for(p=p.replace(/\./,"");d-- >1;)p="0"+p;return"0."+p}),a}),typeof String.prototype.trim>"u"&&(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")})}(vs)),vs}var $0=U0();class Fs{constructor(i,r,a){M(this,"alt");M(this,"lat");M(this,"lon");this.lat=i,this.lon=r,this.alt=a}get latlon(){return new $0.latlon(this.lat,this.lon)}}class Es extends Fs{constructor(r,a,f,p,d){super(r,a,f);M(this,"loc");M(this,"grade");this.loc=p,this.grade=d}}function Rs(c,i,r){if(c.loc>i.loc&&r>c.loc||i.loc>c.loc&&r>i.loc)throw new Error("Input location must be between points");const a=Math.abs(c.loc-r),f=c.latlon.bearingTo(i.latlon),{lat:p,lng:d}=c.latlon.destinationPoint(f,a),m=c.grade,w=me(c.loc,i.loc,c.alt,i.alt,r);return new Es(p,d,w,r,m)}function q0(c,i){return(typeof c=="object"?String(c.id):c)===(typeof i=="object"?String(i.id):i)}function bs(c,i){return!!(c&&i&&q0(c.site,i.site)&&c.loop===i.loop)}class Ss{constructor(i,r=1){M(this,"_data");M(this,"loop");M(this,"site");this._data={},this.site=i,this.loop=r}get course(){return this.site.course}get name(){return this.loop>=2&&this.type!=="finish"?`${this.site.name} ${this.loop}`:this.site.name}get description(){return this.site.description}get loc(){return(this.site.percent+this.loop-1)*this.course.loopDist}set loc(i){if(!z.isNumber(i))throw new Error("Wrong format for Waypoint.loc");this.type==="start"?this.site.percent=0:this.type==="finish"?this.site.percent=1:this.site.percent=i/this.course.loopDist%1}get lat(){return this.site.lat}get lon(){return this.site.lon}get alt(){return this.site.alt}get tier(){return this.site.tier||1}get type(){return this.site.type}get terrainFactor(){return this.site.terrainFactor}get terrainType(){return this.site.terrainType}get hasTypicalDelay(){return this.type==="aid"||this.type==="water"||this.loop>=2&&this.type==="start"}get cutoff(){var i;if(this.tier===1){const r=(i=this.site.cutoffs)==null?void 0:i.find(a=>a.loop===this.loop);if(r)return r.time}return null}set cutoff(i){var a;const r=(a=this.site.cutoffs)==null?void 0:a.findIndex(f=>f.loop===this.loop);r>=0?i?this.site.cutoffs[r].time=i:this.site.cutoffs.splice(r,1):i&&(this.site.cutoffs||(this.site.cutoffs=[]),this.site.cutoffs.push({time:i,loop:this.loop}))}matchingSegment(i){return i.find(r=>r.waypoint&&bs(this,r.waypoint))}}const Dr=Zn("models:Waypoint");class Wr{constructor(i,r){M(this,"_waypoints");M(this,"_lat",NaN);M(this,"_lon",NaN);M(this,"_alt",NaN);M(this,"_data");M(this,"course");M(this,"cutoffs",[]);M(this,"id");M(this,"name");M(this,"tier",1);M(this,"type");M(this,"terrainFactor");M(this,"terrainType");M(this,"description");M(this,"pointsIndex");this._data={percent:r.percent},this.course=i,this.id=r.id,this.type=r.type,this.name=r.name,r.cutoffs&&(this.cutoffs=r.cutoffs),r.tier!==void 0&&(this.tier=r.tier),r.terrainFactor!==void 0&&(this.terrainFactor=r.terrainFactor),r.terrainType!==void 0&&(this.terrainType=r.terrainType),r.description&&(this.description=r.description),Dr(`constructor: ${this.name}`)}clearCache(){Dr(`clearCache: ${this.name}`),delete this._waypoints,this._lat=NaN,this._lon=NaN,this._alt=NaN}get percent(){switch(this.type){case"start":return 0;case"finish":return 1;default:return this._data.percent}}set percent(i){this._data.percent=i}get waypoints(){return this._waypoints?this._waypoints:(Dr(`generating waypoints array: ${this.name}`),this.type==="finish"?this._waypoints=[new Ss(this,this.course.loops)]:this._waypoints=z.range(this.course.loops).map(i=>new Ss(this,i+1)),this._waypoints)}get lat(){return z.isNaN(this._lat)&&this.refreshLLA(),this._lat}get lon(){return z.isNaN(this._lon)&&this.refreshLLA(),this._lon}get alt(){return z.isNaN(this._alt)&&this.refreshLLA(),this._alt}refreshLLA(){Dr("refreshLLA");let i,r,a;this.type==="start"?{lat:i,lon:r,alt:a}=this.course.track.points[0]:this.type==="finish"?{lat:i,lon:r,alt:a}=this.course.track.points[this.course.track.points.length-1]:{lat:i,lon:r,alt:a}=this.course.track.getLLA(this.percent*this.course.track.dist),this._lat=i,this._lon=r,this._alt=a,this.course.clearCache(1)}}var ms={exports:{}},du;function z0(){return du||(du=1,function(c,i){(function(){var r=Math.PI,a=Math.sin,f=Math.cos,p=Math.tan,d=Math.asin,m=Math.atan2,w=Math.acos,C=r/180,I=1e3*60*60*24,v=2440588,F=2451545;function R(L){return L.valueOf()/I-.5+v}function E(L){return new Date((L+.5-v)*I)}function T(L){return R(L)-F}var N=C*23.4397;function q(L,$){return m(a(L)*f(N)-p($)*a(N),f(L))}function Z(L,$){return d(a($)*f(N)+f($)*a(N)*a(L))}function J(L,$,G){return m(a(L),f(L)*a($)-p(G)*f($))}function it(L,$,G){return d(a($)*a(G)+f($)*f(G)*f(L))}function _t(L,$){return C*(280.16+360.9856235*L)-$}function Wt(L){return L<0&&(L=0),2967e-7/Math.tan(L+.00312536/(L+.08901179))}function bt(L){return C*(357.5291+.98560028*L)}function tn(L){var $=C*(1.9148*a(L)+.02*a(2*L)+3e-4*a(3*L)),G=C*102.9372;return L+$+G+r}function Ht(L){var $=bt(L),G=tn($);return{dec:Z(G,0),ra:q(G,0)}}var Et={};Et.getPosition=function(L,$,G){var ct=C*-G,nt=C*$,ht=T(L),ot=Ht(ht),lt=_t(ht,ct)-ot.ra;return{azimuth:J(lt,nt,ot.dec),altitude:it(lt,nt,ot.dec)}};var we=Et.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];Et.addTime=function(L,$,G){we.push([L,$,G])};var $e=9e-4;function Gr(L,$){return Math.round(L-$e-$/(2*r))}function Me(L,$,G){return $e+(L+$)/(2*r)+G}function qe(L,$,G){return F+L+.0053*a($)-.0069*a(2*G)}function Hr(L,$,G){return w((a(L)-a($)*a(G))/(f($)*f(G)))}function Sn(L){return-2.076*Math.sqrt(L)/60}function mn(L,$,G,ct,nt,ht,ot){var lt=Hr(L,G,ct),Mt=Me(lt,$,nt);return qe(Mt,ht,ot)}Et.getTimes=function(L,$,G,ct){ct=ct||0;var nt=C*-G,ht=C*$,ot=Sn(ct),lt=T(L),Mt=Gr(lt,nt),Kt=Me(0,nt,Mt),Rt=bt(Kt),Bt=tn(Rt),yn=Z(Bt,0),vt=qe(Kt,Rt,Bt),kt,Dn,Ct,Ut,cn,nn,pt={solarNoon:E(vt),nadir:E(vt-.5)};for(kt=0,Dn=we.length;kt<Dn;kt+=1)Ct=we[kt],Ut=(Ct[0]+ot)*C,cn=mn(Ut,nt,ht,yn,Mt,Rt,Bt),nn=vt-(cn-vt),pt[Ct[1]]=E(nn),pt[Ct[2]]=E(cn);return pt};function ze(L){var $=C*(218.316+13.176396*L),G=C*(134.963+13.064993*L),ct=C*(93.272+13.22935*L),nt=$+C*6.289*a(G),ht=C*5.128*a(ct),ot=385001-20905*f(G);return{ra:q(nt,ht),dec:Z(nt,ht),dist:ot}}Et.getMoonPosition=function(L,$,G){var ct=C*-G,nt=C*$,ht=T(L),ot=ze(ht),lt=_t(ht,ct)-ot.ra,Mt=it(lt,nt,ot.dec),Kt=m(a(lt),p(nt)*f(ot.dec)-a(ot.dec)*f(lt));return Mt=Mt+Wt(Mt),{azimuth:J(lt,nt,ot.dec),altitude:Mt,distance:ot.dist,parallacticAngle:Kt}},Et.getMoonIllumination=function(L){var $=T(L||new Date),G=Ht($),ct=ze($),nt=149598e3,ht=w(a(G.dec)*a(ct.dec)+f(G.dec)*f(ct.dec)*f(G.ra-ct.ra)),ot=m(nt*a(ht),ct.dist-nt*f(ht)),lt=m(f(G.dec)*a(G.ra-ct.ra),a(G.dec)*f(ct.dec)-f(G.dec)*a(ct.dec)*f(G.ra-ct.ra));return{fraction:(1+f(ot))/2,phase:.5+.5*ot*(lt<0?-1:1)/Math.PI,angle:lt}};function xn(L,$){return new Date(L.valueOf()+$*I/24)}Et.getMoonTimes=function(L,$,G,ct){var nt=new Date(L);ct?nt.setUTCHours(0,0,0,0):nt.setHours(0,0,0,0);for(var ht=.133*C,ot=Et.getMoonPosition(nt,$,G).altitude-ht,lt,Mt,Kt,Rt,Bt,yn,vt,kt,Dn,Ct,Ut,cn,nn,pt=1;pt<=24&&(lt=Et.getMoonPosition(xn(nt,pt),$,G).altitude-ht,Mt=Et.getMoonPosition(xn(nt,pt+1),$,G).altitude-ht,Bt=(ot+Mt)/2-lt,yn=(Mt-ot)/2,vt=-yn/(2*Bt),kt=(Bt*vt+yn)*vt+lt,Dn=yn*yn-4*Bt*lt,Ct=0,Dn>=0&&(nn=Math.sqrt(Dn)/(Math.abs(Bt)*2),Ut=vt-nn,cn=vt+nn,Math.abs(Ut)<=1&&Ct++,Math.abs(cn)<=1&&Ct++,Ut<-1&&(Ut=cn)),Ct===1?ot<0?Kt=pt+Ut:Rt=pt+Ut:Ct===2&&(Kt=pt+(kt<0?cn:Ut),Rt=pt+(kt<0?Ut:cn)),!(Kt&&Rt));pt+=2)ot=Mt;var wn={};return Kt&&(wn.rise=xn(nt,Kt)),Rt&&(wn.set=xn(nt,Rt)),!Kt&&!Rt&&(wn[kt>0?"alwaysUp":"alwaysDown"]=!0),wn},c.exports=Et})()}(ms)),ms.exports}var _u=z0();function Kn(c,i){const r=c.toLocaleString([],{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:i}).split(":").map(a=>Number(a));return r[0]*60*60+r[1]*60+r[2]}class G0{constructor(i){M(this,"nadir",0);M(this,"dawn",0);M(this,"sunrise",0);M(this,"dusk",0);M(this,"sunset",0);M(this,"noon",0);M(this,"nadirAltitude",0);Object.assign(this,i)}}class $r{constructor(i,r,a,f){M(this,"start");M(this,"lat");M(this,"lon");M(this,"timezone");M(this,"sun");M(this,"startTime");this.start=i,this.lat=a,this.lon=f,this.timezone=r;const p=_u.getTimes(this.start,this.lat,this.lon),d=_u.getPosition(p.nadir,this.lat,this.lon);this.sun=new G0({nadir:Kn(p.nadir,this.timezone),dawn:Kn(p.dawn,this.timezone),sunrise:Kn(p.sunrise,this.timezone),dusk:Kn(p.dusk,this.timezone),sunset:Kn(p.sunset,this.timezone),noon:Kn(p.solarNoon,this.timezone),nadirAltitude:d.altitude*180/Math.PI}),this.startTime=Kn(this.start,this.timezone)}dateAtElapsed(i){const r=new Date(this.start);return r.setTime(r.getTime()+i*1e3),r}elapsedToTimeOfDay(i){return(this.startTime+i)%86400}}const On=Zn("models:Course"),H0=["track","dist","gain","loss","cache","distance","start"];class K0{constructor(i,r){M(this,"event");M(this,"name");M(this,"_cache",{});M(this,"_loops",1);M(this,"_distOverride");M(this,"_gainOverride");M(this,"_lossOverride");M(this,"_dist");M(this,"_gain");M(this,"_loss");M(this,"_sites",[new Wr(this,{id:String(z.random(1e4,2e4)),name:"Start",type:"start",percent:0}),new Wr(this,{id:String(z.random(3e4,4e4)),name:"Finish",type:"finish",percent:1})]);M(this,"_waypoints");M(this,"_track");M(this,"_points");M(this,"_terrainFactors");M(this,"_terrainTypes");M(this,"_cutoffs");M(this,"_splits");M(this,"_stats");this._track=i,r.loops&&(this.loops=r.loops),r.dist&&(this._distOverride=r.dist),r.gain&&(this._gainOverride=r.gain),r.loss&&(this._lossOverride=r.loss),r.start&&(this.event=new $r(r.start.date,r.start.timezone,i.points[0].lat,i.points[0].lon));const a=Object.keys(r).filter(f=>!H0.includes(f));Object.assign(this,z.pick(r,a))}get loops(){return this._loops}set loops(i){this._loops=i,this.clearCache(2)}set dist(i){On(`overriding dist to ${i}`),this._distOverride=i,this.clearCache(2)}set gain(i){On(`overriding gain to ${i}`),this._gainOverride=i,this.clearCache(2)}set loss(i){On(`overriding loss to ${i}`),this._lossOverride=i,this.clearCache(2)}get dist(){return this._dist||(this._dist=this._distOverride||this.track.dist*this.loops)}get gain(){return this.gain||(this._gain=this._gainOverride||this.track.gain*this.loops)}get loss(){return this._loss||(this._loss=this._lossOverride||this.track.loss*this.loops)}get distScale(){return this._distOverride?this._distOverride/(this.track.dist*this.loops):1}get gainScale(){return this._gainOverride?this._gainOverride/(this.track.gain*this.loops):1}get lossScale(){return this._lossOverride?this._lossOverride/(this.track.loss*this.loops):1}get loopDist(){return this.dist/this.loops}get loopGain(){return this.gain/this.loops}get loopLoss(){return this.loss/this.loops}get sites(){return this._sites}set sites(i){this._sites=i.map(r=>new Wr(this,r)),this.clearCache(1)}clearCache(i=1){On(`clearCache-${i}`),delete this._cutoffs,delete this._splits,delete this._stats,delete this._terrainFactors,delete this._terrainTypes,delete this._waypoints,i===2&&(delete this._dist,delete this._gain,delete this._loss,delete this._points,this.sites.forEach(r=>{r.clearCache()}))}get waypoints(){var r;if(this._waypoints)return this._waypoints;if(!((r=this.track)!=null&&r.dist))return[];let i=[];return this.sites.forEach(a=>{i.push(...a.waypoints)}),i=i.sort((a,f)=>a.loc-f.loc),this._waypoints=i,this._waypoints}set track(i){this._track=i,this.clearCache(2)}get track(){return this._track}get points(){if(this._points)return this._points;On("generating points array"),this._points=new Array(this.track.points.length*this.loops);for(let i=0;i<this.loops;i++)for(let r=0;r<this.track.points.length;r++)this.points[r+i*this.track.points.length]=new Ms(this,this.track.points[r],i);return this._points}set points(i){throw new Error("cannot set points directly")}getPoint(i,r=!1){const a=this.points.findIndex(C=>qr(C.loc,i,4)),f=this.points[a];if(Ue(f.loc,i,4))return f;On(`getPoint: ${r?"inserting":"creating"} new CoursePoint at ${i}`);const p=a-1,d=this.points[p],m=Rs(d.point,f.point,i%this.loopDist/this.distScale),w=new Ms(this,m,Math.floor(i/this.loopDist));return r&&this.points.splice(a,0,w),w}get terrainFactors(){if(this._terrainFactors)return this._terrainFactors;On("regenerating terrainFactors");const i=this.waypoints.filter((r,a)=>{var f;return a===0||!z.isNil(r.terrainFactor)&&r.terrainFactor!==((f=this.waypoints[a-1])==null?void 0:f.terrainFactor)});return this._terrainFactors=i.map((r,a)=>new Z0(r,i[a+1]||z.last(this.waypoints),r.terrainFactor)),this._terrainFactors}get terrainTypes(){if(this._terrainTypes)return this._terrainTypes;On("regenerating terrainTypes");const i=this.waypoints.filter((r,a)=>{var f;return!z.isNil(r.terrainType)&&r.terrainType!==((f=this.waypoints[a-1])==null?void 0:f.terrainType)});return this._terrainTypes=i.map((r,a)=>new J0(r,i[a+1]||z.last(this.waypoints),r.terrainType||"")),this._terrainTypes}get cutoffs(){return this._cutoffs?this._cutoffs:(this._cutoffs=this.waypoints.filter(i=>i.cutoff).map(i=>new Du(i)),this._cutoffs)}get splits(){return this._splits?this._splits:(this._splits=new B0(this),this._splits)}get stats(){if(this._stats)return this._stats;On("stats:calculate");const i=this.track.points.map(d=>d.alt),r=this.track.points.map(d=>d.grade),a=this.terrainFactors.map(d=>d.value/100+1),f={altitude:{avg:z.sum(this.track.points.map((d,m)=>{var w;return d.alt*(d.loc-(((w=this.track.points[m-1])==null?void 0:w.loc)||0))}))/this.track.dist,max:z.max(i)||0,min:z.min(i)||0},grade:{avg:(this.track.points[this.track.points.length-1].alt-this.track.points[0].alt)/this.track.dist/10,max:z.max(r)||0,min:z.min(r)||0},terrain:{avg:(z.sumBy(this.terrainFactors,d=>(d.end-d.start)*d.value)/this.dist+100)/100,max:z.max(a)||0,min:z.min(a)||0,maxDist:0,minDist:0}},p=d=>this.terrainFactors.reduce((m,w)=>w.value/100+1===d?m+w.end-w.start:m,0);return Object.assign(f.terrain,{maxDist:p(f.terrain.max),minDist:p(f.terrain.min)}),this._stats=f,f}locationsToBreaks(i){const r=i.filter(f=>f>0&&Is(f,this.dist,4));return r.unshift(0),r.map((f,p)=>({start:f,end:r[p+1]||this.dist}))}}class Du{constructor(i){M(this,"waypoint");this.waypoint=i}get loc(){return this.waypoint.loc}get time(){if(!this.waypoint.cutoff)throw new Error("Invalid cutoff");return this.waypoint.cutoff}}class Z0{constructor(i,r,a=0){M(this,"value");M(this,"startWaypoint");M(this,"endWaypoint");this.startWaypoint=i,this.endWaypoint=r,this.value=a}get start(){return this.startWaypoint.loc}get end(){return this.endWaypoint.loc}}class J0{constructor(i,r,a){M(this,"type");M(this,"startWaypoint");M(this,"endWaypoint");this.startWaypoint=i,this.endWaypoint=r,this.type=a}get start(){return this.startWaypoint.loc}get end(){return this.endWaypoint.loc}}var ys={},vu;function Y0(){return vu||(vu=1,function(c){(function(){var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(m){return f(d(m),arguments)}function a(m,w){return r.apply(null,[m].concat(w||[]))}function f(m,w){var C=1,I=m.length,v,F="",R,E,T,N,q,Z,J,it;for(R=0;R<I;R++)if(typeof m[R]=="string")F+=m[R];else if(typeof m[R]=="object"){if(T=m[R],T.keys)for(v=w[C],E=0;E<T.keys.length;E++){if(v==null)throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',T.keys[E],T.keys[E-1]));v=v[T.keys[E]]}else T.param_no?v=w[T.param_no]:v=w[C++];if(i.not_type.test(T.type)&&i.not_primitive.test(T.type)&&v instanceof Function&&(v=v()),i.numeric_arg.test(T.type)&&typeof v!="number"&&isNaN(v))throw new TypeError(r("[sprintf] expecting number but found %T",v));switch(i.number.test(T.type)&&(J=v>=0),T.type){case"b":v=parseInt(v,10).toString(2);break;case"c":v=String.fromCharCode(parseInt(v,10));break;case"d":case"i":v=parseInt(v,10);break;case"j":v=JSON.stringify(v,null,T.width?parseInt(T.width):0);break;case"e":v=T.precision?parseFloat(v).toExponential(T.precision):parseFloat(v).toExponential();break;case"f":v=T.precision?parseFloat(v).toFixed(T.precision):parseFloat(v);break;case"g":v=T.precision?String(Number(v.toPrecision(T.precision))):parseFloat(v);break;case"o":v=(parseInt(v,10)>>>0).toString(8);break;case"s":v=String(v),v=T.precision?v.substring(0,T.precision):v;break;case"t":v=String(!!v),v=T.precision?v.substring(0,T.precision):v;break;case"T":v=Object.prototype.toString.call(v).slice(8,-1).toLowerCase(),v=T.precision?v.substring(0,T.precision):v;break;case"u":v=parseInt(v,10)>>>0;break;case"v":v=v.valueOf(),v=T.precision?v.substring(0,T.precision):v;break;case"x":v=(parseInt(v,10)>>>0).toString(16);break;case"X":v=(parseInt(v,10)>>>0).toString(16).toUpperCase();break}i.json.test(T.type)?F+=v:(i.number.test(T.type)&&(!J||T.sign)?(it=J?"+":"-",v=v.toString().replace(i.sign,"")):it="",q=T.pad_char?T.pad_char==="0"?"0":T.pad_char.charAt(1):" ",Z=T.width-(it+v).length,N=T.width&&Z>0?q.repeat(Z):"",F+=T.align?it+v+N:q==="0"?it+N+v:N+it+v)}return F}var p=Object.create(null);function d(m){if(p[m])return p[m];for(var w=m,C,I=[],v=0;w;){if((C=i.text.exec(w))!==null)I.push(C[0]);else if((C=i.modulo.exec(w))!==null)I.push("%");else if((C=i.placeholder.exec(w))!==null){if(C[2]){v|=1;var F=[],R=C[2],E=[];if((E=i.key.exec(R))!==null)for(F.push(E[1]);(R=R.substring(E[0].length))!=="";)if((E=i.key_access.exec(R))!==null)F.push(E[1]);else if((E=i.index_access.exec(R))!==null)F.push(E[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");C[2]=F}else v|=2;if(v===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");I.push({placeholder:C[0],param_no:C[1],keys:C[2],sign:C[3],pad_char:C[4],align:C[5],width:C[6],precision:C[7],type:C[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");w=w.substring(C[0].length)}return p[m]=I}c.sprintf=r,c.vsprintf=a,typeof window<"u"&&(window.sprintf=r,window.vsprintf=a)})()}(ys)),ys}var xs=Y0();class Nu{constructor(i,r){M(this,"_callbacks",{});M(this,"_target");this._target=i,this._callbacks=z.fromPairs(r.map(a=>[a,[]]))}add(i,r){if(!this._callbacks[i])throw new Error(`${i} is not a valid callback for object`);this._callbacks[i].find(a=>a===r)?console.warn("callback already exists."):this._callbacks[i].push(r)}remove(i,r){if(!this._callbacks[i])throw new Error(`${i} is not a valid callback for object`);z.pull(this._callbacks[i],r)}clear(i){(i?[i]:Object.keys(this._callbacks)).forEach(a=>this._callbacks[a]=[])}execute(i){this._callbacks[i].forEach(r=>r(this._target))}}const X0=Zn("PaceChunk");class Q0{constructor(){M(this,"iterations",!1);M(this,"factor",!1);M(this,"target",!1)}get passing(){return this.iterations&&this.factor&&this.target}get statusString(){return[`iterations=${this.iterations?"P":"F"}`,`factor=${this.factor?"P":"F"}`,`target=${this.target?"P":"F"}`].join("|")}}class mu{constructor(i,r,a,f){M(this,"constraints");M(this,"points");M(this,"plan");M(this,"delay");M(this,"factor");M(this,"factors",new vn);M(this,"status");this.constraints=a,this.points=r,this.plan=i,this.delay=f,this.factor=1}get elapsed(){const i=z.isFunction(this.constraints[0])?this.constraints[0]():this.constraints[0];return(z.isFunction(this.constraints[1])?this.constraints[1]():this.constraints[1])-i}get dist(){return this.points[this.points.length-1].loc-this.points[0].loc}get pace(){return(this.elapsed-this.delay)/this.dist}get np(){return this.pace/this.factor}get moving(){return this.elapsed-this.delay}applyPacing(){this.plan.pacing.clearFactor();const i=this.points;i[0].elapsed=z.isFunction(this.constraints[0])?this.constraints[0]():this.constraints[0],i[0].time=i[0].elapsed-z.sum(this.plan.pacing.chunks.filter(C=>C.points[0].loc<i[0].loc).map(C=>C.delay)),this.plan.event.start&&(i[0].tod=this.plan.event.elapsedToTimeOfDay(i[0].elapsed));let r=i[0].elapsed,a=i[0].delay||0,f=0,p=0,d=0;const m=this.factor?this.np:this.plan.pacing.pace,w=new vn().init(0);for(let C=1,I=i.length;C<I;C++){f=i[C].loc-i[C-1].loc,Ur(i[C-1],this.plan),w.applyEach((F,R)=>F+R*f,i[C-1].factors);const v=i[C-1].factors.combined;d+=v*f,p=m*v*f,i[C].time=i[C-1].time+p,a=i[C-1].delay||0,r+=p+a,i[C].elapsed=r,this.plan.event.start&&(i[C].tod=this.plan.event.elapsedToTimeOfDay(r))}Ur(i[i.length-1],this.plan),this.factors=w.scaleEach(1/this.dist),this.factor=d/this.dist}calculate(){const a=X0.extend(xs.vsprintf("calculate:%.2f-%.2f",[this.points[0].loc,this.points[this.points.length-1].loc]));let f=this.factor||0,p;const d=new Q0;for(p=0;p<20&&(this.applyPacing(),d.iterations=p>=2,d.factor=!z.round(f-this.factor,10),f=this.factor,d.target=Math.abs((z.isFunction(this.constraints[1])?this.constraints[1]():this.constraints[1])-this.points[this.points.length-1].elapsed)<.1,a(xs.vsprintf("%i|%s",[p,d.statusString])),!d.passing);p++);a("iteration complete"),this.status={tests:d,success:d.passing,iterations:p+1}}}const jt=Zn("Pacing");class Wu{constructor(i){M(this,"callbacks",new Nu(this,["onUpdated","onFail","onInvalidated"]));M(this,"chunks",[]);M(this,"plan");M(this,"_elapsed");M(this,"_factor");M(this,"_factors");this.plan=i}clearCache(){jt("clearCache"),delete this._elapsed,delete this._factor,delete this._factors}invalidate(){jt("invalidate"),this.chunks=[],this.clearCache(),this.callbacks.execute("onInvalidated")}get elapsed(){return jt("elapsed:get"),this._elapsed||this.plan.points[this.plan.points.length-1].elapsed}get pace(){return jt("pace:get"),(this.elapsed-this.plan.delay)/this.plan.course.dist}get factor(){return this._factor?this._factor:(jt("factor:update"),this.chunks&&(this._factor=z.sum(this.chunks.map(i=>i.factor*i.dist))/this.plan.course.dist),this._factor||1)}clearFactor(){delete this._factor}get factors(){return jt("factors:get"),this._factors||(jt("factors:update"),this._factors=Ps(this.chunks)),this._factors}get np(){return jt("np:get"),this.pace/this.factor}get moving(){return this.elapsed-this.plan.delay}get status(){var i,r,a;return{complete:((i=this.chunks)==null?void 0:i.length)>0,success:((r=this.chunks)==null?void 0:r.filter(f=>{var p;return!((p=f.status)!=null&&p.success)}).length)===0,chunks:((a=this.chunks)==null?void 0:a.length)||0}}calculate(){var a,f;const i=jt.extend("calculate");i("exec"),i("clearing cache"),this.clearCache(),i("adding points at each terrain factor break"),(a=this.plan.course.terrainFactors)==null||a.forEach(p=>this.plan.getPoint(p.start,!0)),i("adding points at each cutoff"),this.plan.cutoffMargin&&this.plan.cutoffs.forEach(p=>{p.point=this.plan.getPoint(p.loc,!0)}),this.plan.points.filter(p=>p.delay).forEach(p=>{p.delay=0}),(f=this.plan.delays)==null||f.forEach(p=>{const d=this.plan.getPoint(p.loc,!0);d.delay=p.delay}),i("creating pace chunks"),this.initChunks(),[null,...z.reverse([...this.plan.cutoffs]),null].forEach(p=>{for(;this.chunks.find(d=>!d.status);)this.calcChunks(),this.validateChunks();if(!p)return!0;if(p.point.elapsed-p.time>.5){i(`cutoff at ${p.loc} missed`);const d=this.chunks[0];z.last(d.points)===p.point?(i(`setting cutoff at ${p.loc}`),d.constraints=[0,p.time],delete d.status):this.splitChunk(d,p.point,p.time)}}),z.isFunction(this.chunks[this.chunks.length-1].constraints[1])&&this.chunks.length>2&&(i("rerunning last chunk"),this.chunks[this.chunks.length-1].calculate()),jt(`pacing status=${this.status.success?"PASS":"FAIL"}.`),this.status.success?this.callbacks.execute("onUpdated"):this.callbacks.execute("onFail")}initChunks(){let i;switch(this.plan.method){case"time":i=this.plan.target;break;case"pace":i=this.plan.target*this.plan.course.dist+this.plan.delay;break;case"np":i=()=>this.plan.target*(this.factor||1)*this.plan.course.dist+this.plan.delay;break;default:throw new Error(`Incorrect pacing method ${this.plan.method}`)}this.chunks=[new mu(this.plan,this.plan.points,[0,i],this.plan.delay)],this.plan.points.forEach(r=>{r._chunk=this.chunks[0]})}calcChunks(){jt("calcChunks"),this.clearCache(),this.chunks.filter(i=>!i.status).forEach(i=>i.calculate())}validateChunks(){let i=1;for(;i<=this.chunks.length-1;)this.chunks[i].np<this.chunks[i-1].np?this.mergeChunks(this.chunks[i-1],this.chunks[i]):i++}splitChunk(i,r,a){jt.extend("split")(`breaking chunks at ${r.loc} km`);const p=i.points.findIndex(w=>w===r),d=z.round(r.elapsed-r.time),m=new mu(this.plan,i.points.slice(0,p+1),[0,a],d);m.points.filter((w,C)=>C<m.points.length-1).forEach(w=>{w._chunk=m}),this.chunks.unshift(m),i.constraints[0]=a,i.delay-=d,i.points=i.points.slice(p),delete i.status}mergeChunks(i,r){const a=this.chunks.findIndex(p=>p===i),f=this.chunks.findIndex(p=>p===r);if(f-a!==1)throw new Error("chunks must be sequential");jt(xs.sprintf("calcChunks: merging %i&%i (%.2f&%.2f)",a,f,i.np,r.np)),i.points.pop(),i.points.push(...r.points),i.delay+=r.delay,delete i.status,i.points.forEach(p=>{p._chunk=i}),i.constraints=[i.constraints[0],r.constraints[1]],this.chunks.splice(f,1)}}class As{constructor(i,r){M(this,"factors",new vn);M(this,"_chunk");M(this,"_plan");M(this,"_point");M(this,"elapsed");M(this,"time");M(this,"tod");M(this,"delay");this._plan=i,this._point=r,this.time=0,this.elapsed=0,this.tod=0,this.delay=0}get lat(){return this._point.lat}get lon(){return this._point.lon}get alt(){return this._point.alt}get latlon(){return this._point.latlon}get grade(){return this._point.grade}get loc(){return this._point.loc}get np(){var i;if(!this._chunk)throw new Error("PlanPoint._chunk not defined");return(i=this._chunk)==null?void 0:i.np}get factor(){var i;return(i=this.factors)==null?void 0:i.combined}get pace(){return this.np*this.factor}}const ws=Zn("PlanSplits");class V0{constructor(i){M(this,"_segments");M(this,"_miles");M(this,"_kilometers");M(this,"plan");this.plan=i}get segments(){var i;return(i=this._segments)!=null&&i.length||(this.plan.checkPacing(),this._segments=this.createSegments()),this._segments}set segments(i){this._segments=i}get miles(){var i;return(i=this._miles)!=null&&i.length||(this.plan.checkPacing(),this._miles=this.createSplits("miles")),this._miles}set miles(i){this._miles=i}get kilometers(){var i;return(i=this._kilometers)!=null&&i.length||(this.plan.checkPacing(),this._kilometers=this.createSplits("kilometers")),this._kilometers}set kilometers(i){this._kilometers=i}createSegments(){ws("createSegments");const i=this.plan.course.waypoints.filter(a=>a.tier<3).sort((a,f)=>a.loc-f.loc),r=this.calcSegments(this.plan.course.locationsToBreaks(i.map(a=>a.loc)));if(!r.length)throw new Error("createSegments result is empty");return r.forEach((a,f)=>{a.waypoint=i[f+1]}),r}createSplits(i){ws(`createSplits:${i}`);const r=Ru(i),a=z.range(this.plan.course.dist*r).map(p=>p/r);this.plan.course.dist-a[a.length-1]>1e-4&&a.push(this.plan.course.dist);const f=this.calcSegments(this.plan.course.locationsToBreaks(a));if(!f.length)throw new Error("createSplits result is empty");return f}calcSegments(i){var R;ws.extend("calcSegments")("exec");const a=this.plan,f=a.course,p=a.points,d=[],m=[];let w,C,I=a.points[0],v;for(w=0,C=i.length;w<C;w++){const E=i[w];v&&Ue((R=i[w-1])==null?void 0:R.end,E.start,4)?I=v:I=a.getPoint(E.start),v=a.getPoint(E.end);const T=E.end-E.start,N=new Ou(this.plan,{gain:0,loss:0,grade:T>0?(v.alt-I.alt)/T/10*(v.alt-I.alt>0?f.gainScale:f.lossScale):0,point1:I,point2:v}),q=new vn().init(0);d.push(N),m.push(q)}const F=(E,T,N,q)=>{const Z=N.alt-T.alt;E[Z>0?"gain":"loss"]+=Z*(Z>0?f.gainScale:f.lossScale),Ur(T,a);const J=N.loc-T.loc;q.applyEach((it,_t)=>it+_t*J,T.factors)};w=1;for(let E=0;E<d.length;E++){const T=d[E],N=m[E];for(;ye(p[w].loc,T.point1.loc,4);)w++;let q=T.point1;for(;w<p.length&&ye(p[w].loc,T.point2.loc,4);){const Z=p[w];F(T,q,Z,N),q=Z,w++}F(T,q,T.point2,N),a&&(T.delay=a.delays.filter(Z=>qr(T.point1.loc,Z.loc,4)&&Is(T.point2.loc,Z.loc,4)).reduce((Z,J)=>Z+J.delay,0))}return d}}const _n=Zn("models:Plan");class j0{constructor(i,r){M(this,"callbacks");M(this,"course");M(this,"_cutoffMargin",0);M(this,"_cutoffs");M(this,"_specifiedDelays",[]);M(this,"_delays");M(this,"event");M(this,"_events");M(this,"_heatModel");M(this,"id");M(this,"_method");M(this,"name");M(this,"pacing");M(this,"points");M(this,"_scales",new e_(this));M(this,"_splits");M(this,"_stats");M(this,"_strategy");M(this,"_target");M(this,"_typicalDelay",0);this.course=i;const a=r.start?new $r(r.start.date,r.start.timezone,i.points[0].lat,i.points[0].lon):i.event;if(!a)throw new Error("Start date/timezone is required for either the plan or the course");this.event=a,this.id=r.id,this.pacing=new Wu(this),this.points=this.course.points.map(f=>new As(this,f)),this._method=r.method,this._target=r.target,this.typicalDelay=r.typicalDelay||0,r.delays&&(this.delays=r.delays),this.cutoffMargin=r.cutoffMargin,this.scales=r.scales,this._strategy=new Br(this,r.strategy),r.heatModel&&(this.heatModel=r.heatModel),this.name=r.name,this.callbacks=new Nu(this,["onUpdated"])}get cutoffMargin(){return this._cutoffMargin}set cutoffMargin(i){this._cutoffMargin=i,this.clearCache()}get cutoffs(){if(this._cutoffs)return this._cutoffs;this._cutoffs=this.cutoffMargin?this.course.cutoffs.map(r=>new n_(this,r,this.getPoint(r.loc,!0))):[];let i=0;for(;this._cutoffs.length-1>=i;){const r=this._cutoffs[i];this._cutoffs.find((a,f)=>f>i&&a.time<=r.time)?(_n(`get cutoffs: deleting extraneous cutoff at ${r.loc} km`),this._cutoffs.splice(i,1)):i++}return this._cutoffs}get delay(){return z.sumBy(this.delays,"delay")}get delays(){if(this._delays)return this._delays;const i=this.course.waypoints.map(a=>{var d;const f=(d=this._specifiedDelays)==null?void 0:d.find(m=>bs(m.waypoint,a)),p=f?f.delay:a.hasTypicalDelay?this.typicalDelay:0;return new t_(a,p)}).filter(a=>a.delay>0).sort((a,f)=>a.loc-f.loc);let r=0;for(;i.length-1>=r;)r>0&&i[r].loc===i[r-1].loc?(_n(`get delays: merging delay at ${i[r].loc} km`),i[r-1].delay+=i[r].delay,i.splice(r,1)):r++;return this._delays=i,this._delays}set delays(i){this._specifiedDelays=i,delete this._delays}get events(){if(this._events)return this._events;_n("calculating events.sun");const i=[],r=this.event.elapsedToTimeOfDay(0),a=Math.ceil((r+this.points[this.points.length-1].elapsed)/86400);for(let d=0;d<a;d++)[{event:"dawn",time:this.event.sun.dawn},{event:"sunrise",time:this.event.sun.sunrise},{event:"sunset",time:this.event.sun.sunset},{event:"dusk",time:this.event.sun.dusk}].forEach(w=>{const C=w.time-r+86400*d;C>=0&&C<=this.points[this.points.length-1].elapsed&&i.push({event:w.event,elapsed:C})});i.sort((d,m)=>d.elapsed-m.elapsed);const f=Mu(this.points.map(d=>d.elapsed),this.points.map(d=>d.loc),i.map(d=>d.elapsed)),p=i.map((d,m)=>({...d,loc:f[m]}));return this._events={sun:p},this._events}get heatModel(){return this._heatModel}set heatModel(i){i?this._heatModel={start:this.event.sun.sunrise+1800,stop:this.event.sun.sunset+7200,baseline:i.baseline,max:i.max}:delete this._heatModel}get method(){return this._method}set method(i){this._method=i,this.invalidatePacing()}get scales(){return this._scales}set scales(i){this._scales.altitude=(i==null?void 0:i.altitude)||1,this._scales.dark=(i==null?void 0:i.dark)||1,this.invalidatePacing()}get splits(){return this._splits?this._splits:(_n("creating splits"),this._splits=new V0(this),this._splits)}set start(i){this.event=new $r(i.date,i.timezone,this.points[0].lat,this.points[0].lon)}get stats(){if(this._stats)return this._stats;_n("calculating stats.factors");const i=z.fromPairs(Fu.map(p=>{const d=this.points.map(m=>m.factors.get(p));return[p,{min:Number(z.min(d)),max:Number(z.max(d))}]}));_n("calculating stats.sun");const r={day:{time:0,dist:0},twilight:{time:0,dist:0},dark:{time:0,dist:0}};let a=0,f=0;return this.points.forEach((p,d)=>{var m,w;a=p.loc-(((m=this.points[d-1])==null?void 0:m.loc)||0),f=p.elapsed-(((w=this.points[d-1])==null?void 0:w.elapsed)||0),!isNaN(this.event.sun.dawn)&&!isNaN(this.event.sun.dusk)&&(p.tod<=this.event.sun.dawn||p.tod>=this.event.sun.dusk)?(r.dark.time+=f,r.dark.dist+=a):p.tod<this.event.sun.sunrise||p.tod>this.event.sun.sunset?(r.twilight.time+=f,r.twilight.dist+=a):(r.day.time+=f,r.day.dist+=a)}),this._stats={factors:i,sun:r},this._stats}get strategy(){return this._strategy}set strategy(i){this._strategy=new Br(this,i),this.clearCache()}get target(){return this._target}set target(i){z.isEqual(this._target,i)||(this._target=i,this.invalidatePacing())}get typicalDelay(){return this._typicalDelay}set typicalDelay(i){this._typicalDelay=i,this.clearCache(),this.invalidatePacing()}checkPacing(){var i,r;if(_n("checkPacing"),(i=this.pacing.status)!=null&&i.complete||(_n("checkPacing: calculate"),this.pacing.calculate()),!((r=this.points)!=null&&r.length))throw new Error("No plan points");return!0}clearCache(){_n("clearCache"),delete this._cutoffs,delete this._splits,delete this._stats}getDelayAtWaypoint(i){var r;return((r=this.delays.find(a=>bs(a.waypoint,i)))==null?void 0:r.delay)||0}getTypicalDelayAtWaypoint(i){return i.hasTypicalDelay?this.typicalDelay:0}getPoint(i,r=!1){const a=this.points.findIndex(w=>qr(w.loc,i,4)),f=this.points[a];if(Ue(f.loc,i,4))return f;_n(`getPoint: ${r?"inserting":"creating"} new PlanPoint at ${i}`);const p=a-1,d=this.points[p],m=new As(this,this.course.getPoint(i,r));if(!isNaN(d.time)&&!isNaN(f.time)){const w=f.elapsed-f.time-(d.elapsed-d.time);m.time=me(d.loc,f.loc,d.time+w,f.time,f.loc),m.elapsed=f.elapsed-(f.time-m.time),this.event.start&&(m.tod=this.event.elapsedToTimeOfDay(m.elapsed))}return r&&this.points.splice(a,0,m),m}invalidatePacing(){_n("invalidatePacing"),this.pacing.invalidate(),delete this._splits}}class t_{constructor(i,r){M(this,"delay");M(this,"waypoint");this.waypoint=i,this.delay=r}get loc(){return this.waypoint.loc}}class n_{constructor(i,r,a){M(this,"plan");M(this,"courseCutoff");M(this,"point");this.plan=i,this.courseCutoff=r,this.point=a}get waypoint(){return this.courseCutoff.waypoint}get loc(){return this.courseCutoff.loc}get time(){return this.courseCutoff.time-Math.max(this.plan.cutoffMargin||0,this.plan.getDelayAtWaypoint(this.waypoint))}}class e_{constructor(i){M(this,"plan");M(this,"_altitude",1);M(this,"_dark",1);this.plan=i}get altitude(){return this._altitude}set altitude(i){this._altitude=i,this.plan.clearCache()}get dark(){return this._dark}set dark(i){this._dark=i,this.plan.clearCache()}}const Bu=(c,i,r,a)=>{const f=bu(c,i,r,a),p=[];return r.forEach((d,m)=>{let w=f[m][0]/10;w>50?w=50:w<-50&&(w=-50);const C=d*f[m][0]+f[m][1];p.push({grade:w,alt:C})}),p};function r_(c,i){return Bu(i,c.map(a=>a.alt),i,.05).map(a=>a.grade)}const i_=c=>{let i=0,r=0;const a=[0];for(let f=1,p=c.length;f<p;f++)i=Number(c[f-1].latlon.distanceTo(c[f].latlon)),r+=i,a.push(r);return a},Nr=Zn("models:Track");class zr{constructor(i){M(this,"dist");M(this,"gain");M(this,"loss");M(this,"points");Nr("Creating new Track object");const r=i.map(C=>new Fs(C.lat,C.lon,C.alt)),a=i_(r),f=r_(r,a);this.points=r.map((C,I)=>new Es(C.lat,C.lon,C.alt,a[I],f[I])),Nr(`set-points - ${r.length} points`),Nr("Calculating"),this.dist=this.points[this.points.length-1].loc;let p=0,d=0,m=0,w=this.points[0].alt;this.points.forEach(C=>{m=C.alt-w,m<0?d+=m:p+=m,w=C.alt}),this.gain=p,this.loss=d}get start(){return z.pick(this.points[0],["lat","lon"])}get finish(){return z.pick(this.points[this.points.length-1],["lat","lon"])}getLLA(i){i>this.dist&&(i=i%this.dist);let r;if(i===0)r=this.points[0];else{const a=this.points.findIndex(f=>f.loc>=i);r=Rs(this.points[a-1],this.points[a],i)}return z.pick(r,["lat","lon","alt"])}getNearestPoint(i,r,a){let p=this.points.findIndex(w=>w===r),d=this.points[p],m=0;for(;a>.025;){const w=a/5,C=[d];for(let F=1;F<=5;F++){const R=d.loc+w*F;if(R<=this.dist){for(;this.points[p+1].loc<R&&p<this.points.length-1;)p++;C.push(this.points[p])}}const I=C.map(F=>Number(i.distanceTo(F.latlon)));m=Math.min(...I);const v=I.findIndex(F=>F===m);d=C[v],a=a/5}return{point:d,delta:m}}reduceDensity(i=.025,r=this.points.length/2){const a=Nr.extend("reduceDensity");if(this.dist/i>r/2)return a("Does not meet criteria"),this;const f=this.dist,p=Math.floor(f/i)+1,d=Array(p).fill(0).map((I,v)=>Nt(v++*i,3));d[d.length-1]<f&&d.push(f);const m=Bu(this.points.map(I=>I.loc),this.points.map(I=>I.alt),d,2*i),w=d.map(I=>this.getLLA(I)).map((I,v)=>({lat:Nt(I.lat,6),lon:Nt(I.lon,6),alt:Nt(m[v].alt,2)})),C=new zr(w);return a(`Reduced from ${this.points.length} to ${C.points.length} points.`),C}}function s_(c,i,r){const a=c.map((f,p)=>({lat:c[p],lon:i[p],alt:r[p]}));return new zr(a)}const a_=Object.freeze(Object.defineProperty({__proto__:null,dateToTODSeconds:Kn},Symbol.toStringTag,{value:"Module"}));exports.Course=K0;exports.CourseCutoff=Du;exports.CoursePoint=Ms;exports.CourseSegment=Lu;exports.Event=$r;exports.Factors=vn;exports.Pacing=Wu;exports.Plan=j0;exports.PlanPoint=As;exports.PlanSegment=Ou;exports.Point=Fs;exports.Site=Wr;exports.Strategy=Br;exports.Track=zr;exports.TrackPoint=Es;exports.Waypoint=Ss;exports.adjustStrategy=Eu;exports.createTrackFromArrays=s_;exports.factors=N0;exports.interpolatePoint=Rs;exports.math=R0;exports.scaleDark=xu;exports.util=a_;
